{"version":3,"file":"canvas2d.js","sources":["../src/Keys.ts","../src/Tween.ts","../src/Texture.ts","../src/action/BaseAction.ts","../src/action/Delay.ts","../src/action/Callback.ts","../src/action/Animation.ts","../src/Util.ts","../src/action/ActionListener.ts","../src/action/Transition.ts","../src/action/Action.ts","../src/EventEmitter.ts","../src/ReleasePool.ts","../src/sprite/Sprite.ts","../src/UIEvent.ts","../src/Stage.ts","../src/measureText.ts","../src/sprite/TextLabel.ts","../src/sprite/BMFontLabel.ts","../src/createSprite.ts","../src/sound/HTMLAudio.ts","../src/sound/WebAudio.ts","../src/sound/Sound.ts"],"sourcesContent":["﻿export const Keys = {\n    MOUSE_LEFT: 1,\n    MOUSE_MID: 2,\n    MOUSE_RIGHT: 3,\n\n    BACKSPACE: 8,\n    TAB: 9,\n    NUM_CENTER: 12,\n    ENTER: 13,\n    RETURN: 13,\n    SHIFT: 16,\n    CTRL: 17,\n    ALT: 18,\n    PAUSE: 19,\n    CAPS_LOCK: 20,\n    ESC: 27,\n    ESCAPE: 27,\n    SPACE: 32,\n    PAGE_UP: 33,\n    PAGE_DOWN: 34,\n    END: 35,\n    HOME: 36,\n    LEFT: 37,\n    UP: 38,\n    RIGHT: 39,\n    DOWN: 40,\n    PRINT_SCREEN: 44,\n    INSERT: 45,\n    DELETE: 46,\n\n    ZERO: 48,\n    ONE: 49,\n    TWO: 50,\n    THREE: 51,\n    FOUR: 52,\n    FIVE: 53,\n    SIX: 54,\n    SEVEN: 55,\n    EIGHT: 56,\n    NINE: 57,\n\n    A: 65,\n    B: 66,\n    C: 67,\n    D: 68,\n    E: 69,\n    F: 70,\n    G: 71,\n    H: 72,\n    I: 73,\n    J: 74,\n    K: 75,\n    L: 76,\n    M: 77,\n    N: 78,\n    O: 79,\n    P: 80,\n    Q: 81,\n    R: 82,\n    S: 83,\n    T: 84,\n    U: 85,\n    V: 86,\n    W: 87,\n    X: 88,\n    Y: 89,\n    Z: 90,\n\n    CONTEXT_MENU: 93,\n    NUM0: 96,\n    NUM1: 97,\n    NUM2: 98,\n    NUM3: 99,\n    NUM4: 100,\n    NUM5: 101,\n    NUM6: 102,\n    NUM7: 103,\n    NUM8: 104,\n    NUM9: 105,\n    NUM_MULTIPLY: 106,\n    NUM_PLUS: 107,\n    NUM_MINUS: 109,\n    NUM_PERIOD: 110,\n    NUM_DIVISION: 111,\n    F1: 112,\n    F2: 113,\n    F3: 114,\n    F4: 115,\n    F5: 116,\n    F6: 117,\n    F7: 118,\n    F8: 119,\n    F9: 120,\n    F10: 121,\n    F11: 122,\n    F12: 123\n};","﻿export type EasingFunc = (percent: number, ...args: any[]) => number;\r\n\r\nexport const Tween = {\r\n    easeInQuad(pos) {\r\n        return Math.pow(pos, 2);\r\n    },\r\n\r\n    easeOutQuad(pos) {\r\n        return -(Math.pow((pos - 1), 2) - 1);\r\n    },\r\n\r\n    easeInOutQuad(pos) {\r\n        if ((pos /= 0.5) < 1) {\r\n            return 0.5 * Math.pow(pos, 2);\r\n        }\r\n        return -0.5 * ((pos -= 2) * pos - 2);\r\n    },\r\n\r\n    easeInCubic(pos) {\r\n        return Math.pow(pos, 3);\r\n    },\r\n\r\n    easeOutCubic(pos) {\r\n        return (Math.pow((pos - 1), 3) + 1);\r\n    },\r\n\r\n    easeInOutCubic(pos) {\r\n        if ((pos /= 0.5) < 1) {\r\n            return 0.5 * Math.pow(pos, 3);\r\n        }\r\n        return 0.5 * (Math.pow((pos - 2), 3) + 2);\r\n    },\r\n\r\n    easeInQuart(pos) {\r\n        return Math.pow(pos, 4);\r\n    },\r\n\r\n    easeOutQuart(pos) {\r\n        return -(Math.pow((pos - 1), 4) - 1)\r\n    },\r\n\r\n    easeInOutQuart(pos) {\r\n        if ((pos /= 0.5) < 1)\r\n            return 0.5 * Math.pow(pos, 4);\r\n        return -0.5 * ((pos -= 2) * Math.pow(pos, 3) - 2);\r\n    },\r\n\r\n    easeInQuint(pos) {\r\n        return Math.pow(pos, 5);\r\n    },\r\n\r\n    easeOutQuint(pos) {\r\n        return (Math.pow((pos - 1), 5) + 1);\r\n    },\r\n\r\n    easeInOutQuint(pos) {\r\n        if ((pos /= 0.5) < 1) {\r\n            return 0.5 * Math.pow(pos, 5);\r\n        }\r\n        return 0.5 * (Math.pow((pos - 2), 5) + 2);\r\n    },\r\n\r\n    easeInSine(pos) {\r\n        return -Math.cos(pos * (Math.PI / 2)) + 1;\r\n    },\r\n\r\n    easeOutSine(pos) {\r\n        return Math.sin(pos * (Math.PI / 2));\r\n    },\r\n\r\n    easeInOutSine(pos) {\r\n        return (-.5 * (Math.cos(Math.PI * pos) - 1));\r\n    },\r\n\r\n    easeInExpo(pos) {\r\n        return (pos == 0) ? 0 : Math.pow(2, 10 * (pos - 1));\r\n    },\r\n\r\n    easeOutExpo(pos) {\r\n        return (pos == 1) ? 1 : -Math.pow(2, -10 * pos) + 1;\r\n    },\r\n\r\n    easeInOutExpo(pos) {\r\n        if (pos == 0)\r\n            return 0;\r\n        if (pos == 1)\r\n            return 1;\r\n        if ((pos /= 0.5) < 1)\r\n            return 0.5 * Math.pow(2, 10 * (pos - 1));\r\n        return 0.5 * (-Math.pow(2, -10 * --pos) + 2);\r\n    },\r\n\r\n    easeInCirc(pos) {\r\n        return -(Math.sqrt(1 - (pos * pos)) - 1);\r\n    },\r\n\r\n    easeOutCirc(pos) {\r\n        return Math.sqrt(1 - Math.pow((pos - 1), 2))\r\n    },\r\n\r\n    easeInOutCirc(pos) {\r\n        if ((pos /= 0.5) < 1)\r\n            return -0.5 * (Math.sqrt(1 - pos * pos) - 1);\r\n        return 0.5 * (Math.sqrt(1 - (pos -= 2) * pos) + 1);\r\n    },\r\n\r\n    easeOutBounce(pos) {\r\n        if ((pos) < (1 / 2.75)) {\r\n            return (7.5625 * pos * pos);\r\n        }\r\n        else if (pos < (2 / 2.75)) {\r\n            return (7.5625 * (pos -= (1.5 / 2.75)) * pos + .75);\r\n        }\r\n        else if (pos < (2.5 / 2.75)) {\r\n            return (7.5625 * (pos -= (2.25 / 2.75)) * pos + .9375);\r\n        }\r\n        else {\r\n            return (7.5625 * (pos -= (2.625 / 2.75)) * pos + .984375);\r\n        }\r\n    },\r\n\r\n    easeInBack(pos) {\r\n        var s = 1.70158;\r\n        return (pos) * pos * ((s + 1) * pos - s);\r\n    },\r\n\r\n    easeOutBack(pos) {\r\n        var s = 1.70158;\r\n        return (pos = pos - 1) * pos * ((s + 1) * pos + s) + 1;\r\n    },\r\n\r\n    easeInOutBack(pos) {\r\n        var s = 1.70158;\r\n        if ((pos /= 0.5) < 1)\r\n            return 0.5 * (pos * pos * (((s *= (1.525)) + 1) * pos - s));\r\n        return 0.5 * ((pos -= 2) * pos * (((s *= (1.525)) + 1) * pos + s) + 2);\r\n    },\r\n\r\n    elastic(pos) {\r\n        return -1 * Math.pow(4, -8 * pos) * Math.sin((pos * 6 - 1) * (2 * Math.PI) / 2) + 1;\r\n    },\r\n\r\n    swingFromTo(pos) {\r\n        var s = 1.70158;\r\n        return ((pos /= 0.5) < 1) ? 0.5 * (pos * pos * (((s *= (1.525)) + 1) * pos - s)) :\r\n            0.5 * ((pos -= 2) * pos * (((s *= (1.525)) + 1) * pos + s) + 2);\r\n    },\r\n\r\n    swingFrom(pos) {\r\n        var s = 1.70158;\r\n        return pos * pos * ((s + 1) * pos - s);\r\n    },\r\n\r\n    swingTo(pos) {\r\n        var s = 1.70158;\r\n        return (pos -= 1) * pos * ((s + 1) * pos + s) + 1;\r\n    },\r\n\r\n    bounce(pos) {\r\n        if (pos < (1 / 2.75)) {\r\n            return (7.5625 * pos * pos);\r\n        }\r\n        else if (pos < (2 / 2.75)) {\r\n            return (7.5625 * (pos -= (1.5 / 2.75)) * pos + .75);\r\n        }\r\n        else if (pos < (2.5 / 2.75)) {\r\n            return (7.5625 * (pos -= (2.25 / 2.75)) * pos + .9375);\r\n        }\r\n        else {\r\n            return (7.5625 * (pos -= (2.625 / 2.75)) * pos + .984375);\r\n        }\r\n    },\r\n\r\n    bouncePast(pos) {\r\n        if (pos < (1 / 2.75)) {\r\n            return (7.5625 * pos * pos);\r\n        }\r\n        else if (pos < (2 / 2.75)) {\r\n            return 2 - (7.5625 * (pos -= (1.5 / 2.75)) * pos + .75);\r\n        }\r\n        else if (pos < (2.5 / 2.75)) {\r\n            return 2 - (7.5625 * (pos -= (2.25 / 2.75)) * pos + .9375);\r\n        }\r\n        else {\r\n            return 2 - (7.5625 * (pos -= (2.625 / 2.75)) * pos + .984375);\r\n        }\r\n    },\r\n\r\n    easeFromTo(pos) {\r\n        if ((pos /= 0.5) < 1)\r\n            return 0.5 * Math.pow(pos, 4);\r\n        return -0.5 * ((pos -= 2) * Math.pow(pos, 3) - 2);\r\n    },\r\n\r\n    easeFrom(pos) {\r\n        return Math.pow(pos, 4);\r\n    },\r\n\r\n    easeTo(pos) {\r\n        return Math.pow(pos, 0.25);\r\n    },\r\n\r\n    linear(pos) {\r\n        return pos\r\n    },\r\n\r\n    sinusoidal(pos) {\r\n        return (-Math.cos(pos * Math.PI) / 2) + 0.5;\r\n    },\r\n\r\n    reverse(pos) {\r\n        return 1 - pos;\r\n    },\r\n\r\n    mirror(pos, transition) {\r\n        transition = transition || this.sinusoidal;\r\n        if (pos < 0.5)\r\n            return transition(pos * 2);\r\n        else\r\n            return transition(1 - (pos - 0.5) * 2);\r\n    },\r\n\r\n    flicker(pos) {\r\n        var pos = pos + (Math.random() - 0.5) / 5;\r\n        return this.sinusoidal(pos < 0 ? 0 : pos > 1 ? 1 : pos);\r\n    },\r\n\r\n    wobble(pos) {\r\n        return (-Math.cos(pos * Math.PI * (9 * pos)) / 2) + 0.5;\r\n    },\r\n\r\n    pulse(pos, pulses) {\r\n        return (-Math.cos((pos * ((pulses || 5) - .5) * 2) * Math.PI) / 2) + .5;\r\n    },\r\n\r\n    blink(pos, blinks) {\r\n        return Math.round(pos * (blinks || 5)) % 2;\r\n    },\r\n\r\n    spring(pos) {\r\n        return 1 - (Math.cos(pos * 4.5 * Math.PI) * Math.exp(-pos * 6));\r\n    },\r\n\r\n    none(pos) {\r\n        return 0\r\n    },\r\n\r\n    full(pos) {\r\n        return 1\r\n    }\r\n}","﻿var cache: { [index: string]: Texture } = {};\r\nvar loaded: { [index: string]: boolean } = {};\r\nvar loading: { [index: string]: boolean } = {};\r\n\r\nexport type Rect = {\r\n    x: number;\r\n    y: number;\r\n    width: number;\r\n    height: number;\r\n}\r\n\r\n/**\r\n * Sprite texture\r\n */\r\nexport class Texture {\r\n\r\n    private _readyCallbacks: any[] = [];\r\n    private _gridSourceCache: { [key: string]: HTMLCanvasElement } = {};\r\n    private _gridSourceCount = 0;\r\n\r\n    /**\r\n     * Texture resource loading state\r\n     */\r\n    ready: boolean = false;\r\n\r\n    width: number = 0;\r\n    height: number = 0;\r\n\r\n    /**\r\n     * Texture drawable source\r\n     */\r\n    source: HTMLCanvasElement;\r\n\r\n    /**\r\n     * Create a texture by source and clipping rectangle\r\n     * @param  source  Drawable source\r\n     * @param  rect    Clipping rect\r\n     */\r\n    public static create(source: string | HTMLCanvasElement | HTMLImageElement, sourceRect?: Rect, textureRect?: Rect): Texture {\r\n        var name = getCacheKey(source, sourceRect, textureRect);\r\n\r\n        if (name && cache[name]) {\r\n            return cache[name];\r\n        }\r\n\r\n        return new Texture(source, sourceRect, textureRect);\r\n    }\r\n\r\n    public static getByName(name: string) {\r\n        return cache[name];\r\n    }\r\n\r\n    /**\r\n     * 缓存Texture实例\r\n     */\r\n    public static cacheAs(name: string, texture: Texture) {\r\n        cache[name] = texture;\r\n    }\r\n\r\n    /**\r\n     * 清除缓存\r\n     */\r\n    public static clearCache(name?: string) {\r\n        if (name != null) {\r\n            let texture = cache[name];\r\n            if (texture) {\r\n                texture.clearCacheGridSources();\r\n            }\r\n            delete cache[name];\r\n        }\r\n        else {\r\n            cache = {};\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param  source  Drawable source\r\n     * @param  rect    Clipping rect\r\n     */\r\n    constructor(source: string | HTMLCanvasElement | HTMLImageElement, sourceRect?: Rect, textureRect?: Rect) {\r\n        var name: any = getCacheKey(source, sourceRect, textureRect);\r\n\r\n        if (cache[name]) {\r\n            return cache[name];\r\n        }\r\n\r\n        if (typeof source === 'string') {\r\n            this._createByPath(source, sourceRect, textureRect);\r\n        }\r\n        else if ((source instanceof HTMLImageElement) || (source instanceof HTMLCanvasElement)) {\r\n            this._createByImage(<HTMLImageElement>source, sourceRect, textureRect);\r\n        }\r\n        else {\r\n            throw new Error(\"Invalid texture source\");\r\n        }\r\n\r\n        if (name) {\r\n            cache[name] = this;\r\n        }\r\n    }\r\n\r\n    public onReady(callback: (size: { width: number, height: number }) => any) {\r\n        if (this.ready) {\r\n            callback({ width: this.width, height: this.height });\r\n        }\r\n        else {\r\n            this._readyCallbacks.push(callback);\r\n        }\r\n    }\r\n\r\n    public createGridSource(w: number, h: number, sx: number, sy: number, sw: number, sh: number, grid: number[]) {\r\n        let cacheKey = getGridCacheKey(w, h, sx, sy, sw, sh, grid);\r\n\r\n        if (this._gridSourceCache[cacheKey]) {\r\n            return this._gridSourceCache[cacheKey];\r\n        }\r\n\r\n        const [top, right, bottom, left] = grid;\r\n        let grids = [\r\n            { x: 0, y: 0, w: left, h: top, sx: sx, sy: sy, sw: left, sh: top }, // left top\r\n            { x: w - right, y: 0, w: right, h: top, sx: sx + sw - right, sy: sy, sw: right, sh: top }, // right top\r\n            { x: 0, y: h - bottom, w: left, h: bottom, sx: sx, sy: sy + sh - bottom, sw: left, sh: bottom }, // left bottom\r\n            { x: w - right, y: h - bottom, w: right, h: bottom, sx: sx + sw - right, sy: sh - bottom + sy, sw: right, sh: bottom }, // right bottom\r\n            { x: left, y: 0, w: w - left - right, h: top, sx: sx + left, sy: sy, sw: sw - left - right, sh: top }, // top\r\n            { x: left, y: h - bottom, w: w - left - right, h: bottom, sx: sx + left, sy: sh - bottom + sy, sw: sw - left - right, sh: bottom }, // bottom\r\n            { x: 0, y: top, w: left, h: h - top - bottom, sx: sx, sy: top, sw: left, sh: sh - top - bottom }, // left\r\n            { x: w - right, y: top, w: right, h: h - top - bottom, sx: sx + sw - right, sy: top, sw: right, sh: sh - top - bottom }, // right\r\n            { x: left, y: top, w: w - left - right, h: h - top - bottom, sx: sx + left, sy: top, sw: sw - left - right, sh: sh - top - bottom }, // center\r\n        ];\r\n        let canvas = document.createElement(\"canvas\");\r\n        let context = canvas.getContext(\"2d\");\r\n\r\n        canvas.width = w;\r\n        canvas.height = h;\r\n        grids.forEach(g => {\r\n            if (g.w && g.h) {\r\n                context.drawImage(this.source, g.sx, g.sy, g.sw, g.sh,\r\n                    Math.ceil(g.x),\r\n                    Math.ceil(g.y),\r\n                    Math.ceil(g.w),\r\n                    Math.ceil(g.h));\r\n            }\r\n        });\r\n        this._gridSourceCache[cacheKey] = canvas;\r\n        this._gridSourceCount += 1;\r\n        return canvas;\r\n    }\r\n\r\n    public clearCacheGridSources() {\r\n        this._gridSourceCache = {};\r\n        this._gridSourceCount = 0;\r\n    }\r\n\r\n    private _createByPath(path: string, sourceRect?: Rect, textureRect?: Rect): void {\r\n        var img: HTMLImageElement = new Image();\r\n\r\n        img.onload = () => {\r\n            this._createByImage(img, sourceRect, textureRect);\r\n\r\n            // if (!loaded[path]) {\r\n            //     console.log(`canvas2d: \"${path}\" loaded.`);\r\n            // }\r\n            loaded[path] = true;\r\n\r\n            if (this._readyCallbacks.length) {\r\n                let size = { width: this.width, height: this.height };\r\n                this._readyCallbacks.forEach((callback) => {\r\n                    callback(size);\r\n                });\r\n                this._readyCallbacks.length = 0;\r\n            }\r\n            img = null;\r\n        };\r\n\r\n        img.onerror = () => {\r\n            img = null;\r\n            console.warn(`canvas2d: Texture creating fail, error loading source \"${path}\".`);\r\n        };\r\n\r\n        // if (!loading[path]) {\r\n        //     console.log(`canvas2d: Start to load: \"${path}\".`);\r\n        // }\r\n\r\n        img.src = path;\r\n        loading[path] = true;\r\n    }\r\n\r\n    private _createByImage(image: HTMLImageElement, sourceRect?: Rect, textureRect?: Rect): void {\r\n        if (!sourceRect) {\r\n            sourceRect = {\r\n                x: 0,\r\n                y: 0,\r\n                width: image.width,\r\n                height: image.height\r\n            };\r\n        }\r\n        if (!textureRect) {\r\n            textureRect = {\r\n                x: 0,\r\n                y: 0,\r\n                width: sourceRect.width,\r\n                height: sourceRect.height,\r\n            };\r\n        }\r\n\r\n        var source: HTMLCanvasElement = createCanvas(image, sourceRect, textureRect);\r\n\r\n        this.width = source.width;\r\n        this.height = source.height;\r\n        this.source = source;\r\n        this.ready = true;\r\n    }\r\n}\r\n\r\nfunction getGridCacheKey(...args: any[]) {\r\n    return args.join(':');\r\n}\r\n\r\nfunction getCacheKey(source: any, sourceRect?: Rect, textureRect?: Rect): any {\r\n    var isStr = typeof source === 'string';\r\n\r\n    if (!isStr && !source.src) {\r\n        return null;\r\n    }\r\n\r\n    var src = isStr ? source : source.src;\r\n    var sourceRectStr = sourceRect ? [sourceRect.x, sourceRect.y, sourceRect.width, sourceRect.height].join(',') : '';\r\n    var textureRectStr = textureRect ? [textureRect.x, textureRect.y, textureRect.width, textureRect.height].join(',') : '';\r\n\r\n    return src + sourceRectStr + textureRectStr;\r\n}\r\n\r\nfunction createCanvas(image: HTMLImageElement, sourceRect: Rect, textureRect: Rect): HTMLCanvasElement {\r\n    var canvas: HTMLCanvasElement = document.createElement(\"canvas\");\r\n    var context: CanvasRenderingContext2D = canvas.getContext('2d');\r\n\r\n    canvas.width = textureRect.width;\r\n    canvas.height = textureRect.height;\r\n\r\n    context.drawImage(\r\n        image, sourceRect.x, sourceRect.y, sourceRect.width, sourceRect.height,\r\n        textureRect.x, textureRect.y, sourceRect.width, sourceRect.height);\r\n\r\n    return canvas;\r\n}\r\n","export abstract class BaseAction {\n\n    immediate: boolean = false;\n    done: boolean = false;\n\n    abstract step(deltaTime: number, target: any);\n    abstract reset();\n    abstract reverse();\n    abstract end(target: any);\n    abstract destroy();\n}","import { BaseAction } from './BaseAction';\n\nexport class Delay extends BaseAction {\n\n    protected duration: number;\n    protected elapsed: number = 0;\n\n    constructor(duration: number) {\n        super();\n        this.duration = duration;\n    }\n\n    step(deltaTime: number): void {\n        this.elapsed += deltaTime;\n        if (this.elapsed >= this.duration) {\n            this.done = true;\n        }\n    }\n\n    end(): void {\n    }\n\n    reset() {\n        this.elapsed = 0;\n        this.done = false;\n    }\n\n    reverse() {\n        this.done = false;\n        this.elapsed = 0;\n    }\n\n    destroy() {\n    }\n}","import { BaseAction } from './BaseAction';\n\nexport class Callback extends BaseAction {\n\n    protected func: Function;\n    immediate: boolean = true;\n\n    constructor(func: Function) {\n        super();\n        this.func = func;\n    }\n\n    step(): void {\n        this.func.call(null);\n        this.end();\n    }\n\n    end(): void {\n        this.func = null;\n        this.done = true;\n    }\n\n    reset() {\n        this.done = false;\n    }\n\n    reverse() {\n        this.done = false;\n    }\n\n    destroy() {\n        this.func = null;\n    }\n}","import { Texture } from '../Texture';\nimport { BaseAction } from './BaseAction';\n\nexport class Animation extends BaseAction {\n\n    interval: number;\n    \n    protected elapsed: number = 0;\n    protected count: number = 0;\n    protected frameIndex: number = 0;\n    protected frameList: Array<Texture | string>;\n    protected repetitions: number;\n\n    constructor(frameList: Array<Texture | string>, frameRate: number, repetitions?: number) {\n        super();\n\n        this.frameList = frameList;\n        this.repetitions = repetitions;\n        this.interval = 1 / frameRate;\n    }\n\n    step(deltaTime: number, target: any) {\n        this.elapsed += deltaTime;\n\n        if (this.elapsed >= this.interval) {\n            target.texture = this.frameList[this.frameIndex++];\n\n            if (this.frameIndex === this.frameList.length) {\n                if (this.repetitions == null || ++this.count < this.repetitions) {\n                    this.frameIndex = 0;\n                }\n                else {\n                    this.end();\n                }\n            }\n\n            this.elapsed = 0;\n        }\n    }\n\n    end() {\n        this.done = true;\n    }\n\n    reset() {\n        this.done = false;\n        this.frameIndex = 0;\n        this.elapsed = 0;\n        this.count = 0;\n    }\n\n    reverse() {\n        this.done = false;\n        this.frameIndex = 0;\n        this.elapsed = 0;\n        this.count = 0;\n        this.frameList = this.frameList.slice().reverse();\n    }\n\n    destroy() {\n        this.frameList = null;\n    }\n}","const Key = 'canvas2d.uid';\n\nvar counter = 0;\nvar cachedColor: { [key: string]: string } = {};\n\nexport type Color = string | number;\n\nexport function uid(target: any) {\n    if (typeof target[Key] === 'undefined') {\n        Object.defineProperty(target, Key, { value: counter++ });\n    }\n    return target[Key];\n}\n\nexport function addArrayItem(array: any[], item: any) {\n    if (array.indexOf(item) === -1) {\n        array.push(item);\n    }\n}\n\nexport function removeArrayItem(array: any[], item: any) {\n    let index = array.indexOf(item);\n    if (index > -1) {\n        array.splice(index, 1);\n    }\n}\n\nexport function convertColor(color: string | number): string {\n    if (typeof color === 'string') {\n        return color;\n    }\n    if (cachedColor[color]) {\n        return cachedColor[color];\n    }\n    if (typeof color === 'number') {\n        let result = color.toString(16);\n        if (result.length < 3) {\n            while (result.length < 3) {\n                result = '0' + result;\n            }\n        }\n        else if (result.length > 3 && result.length < 6) {\n            while (result.length < 6) {\n                result = '0' + result;\n            }\n        }\n        if (result.length !== 3 && result.length !== 6) {\n            throw new Error(`canvas2d: Invalid hex color \"0x${result}\".`);\n        }\n        result = cachedColor[color] = '#' + result;\n        return result;\n    }\n}\n\n","import { Action } from './Action';\nimport { addArrayItem, removeArrayItem } from '../Util';\n\nexport interface IActionListener {\n    all(callback: Function): IActionListener;\n    any(callback: Function): IActionListener;\n}\n\nexport class ActionListener implements IActionListener {\n\n    private _resolved: boolean = false;\n    private _callbacks: { any?: Array<Function>; all?: Array<Function> } = {};\n    private _actions: Array<Action>\n\n    constructor(actions: Array<Action>) {\n        this._actions = actions;\n    }\n\n    all(callback: Function): ActionListener {\n        if (this._resolved) {\n            callback();\n        }\n        else {\n            if (!this._callbacks.all) {\n                this._callbacks.all = [];\n            }\n            addArrayItem(this._callbacks.all, callback);\n        }\n\n        return this;\n    }\n\n    any(callback: Function): ActionListener {\n        if (this._resolved) {\n            callback();\n        }\n        else {\n            if (!this._callbacks.any) {\n                this._callbacks.any = [];\n            }\n            addArrayItem(this._callbacks.any, callback);\n        }\n\n        return this;\n    }\n\n    _step(): void {\n        var allDone: boolean = true;\n        var anyDone: boolean = false;\n\n        this._actions.forEach((action) => {\n            if (action.isDone()) {\n                anyDone = true;\n            }\n            else {\n                allDone = false;\n            }\n        });\n\n        if (anyDone && this._callbacks.any) {\n            this._callbacks.any.forEach(callback => callback());\n            this._callbacks.any = null;\n        }\n\n        if (allDone && this._callbacks.all) {\n            this._callbacks.all.forEach(callback => callback());\n            Action.removeListener(this);\n            this._resolved = true;\n        }\n    }\n}","import { Tween, EasingFunc } from '../Tween';\nimport { BaseAction } from './BaseAction';\n\nexport type TransToProps = {\n    [name: string]: number | { dest: number; easing: EasingFunc; }\n}\n\nexport type TransByProps = {\n    [name: string]: number | { value: number; easing: EasingFunc; }\n}\n\nexport class Transition extends BaseAction {\n\n    public static defaultEasingFunc = Tween.easeInOutQuad;\n\n    public static setDefaultEasingFunc(func: EasingFunc) {\n        this.defaultEasingFunc = func;\n    }\n\n    protected elapsed: number = 0;\n    protected duration: number;\n\n    protected isTransitionBy: boolean;\n\n    protected options: Array<{ name: string; dest: number; easing: EasingFunc; }>;\n    protected beginValue: { [name: string]: number };\n    protected deltaValue: { [name: string]: number };\n\n    constructor(options: any, duration: number, isTransitionBy?: boolean) {\n        super();\n\n        this.options = [];\n        this.deltaValue = {};\n        this.duration = duration;\n        this.isTransitionBy = isTransitionBy;\n\n        if (isTransitionBy) {\n            this._initAsTransitionBy(options);\n        }\n        else {\n            this._initAsTransitionTo(options);\n        }\n    }\n\n    private _initAsTransitionTo(options: TransToProps) {\n        Object.keys(options).forEach(name => {\n            let info = options[name];\n            let easing: EasingFunc;\n            let dest: number;\n\n            if (typeof info === 'number') {\n                dest = info;\n            }\n            else {\n                easing = info.easing;\n                dest = info.dest;\n            }\n\n            this.options.push({ name, dest, easing });\n        });\n    }\n\n    private _initAsTransitionBy(options: TransByProps) {\n        let deltaValue = this.deltaValue;\n\n        Object.keys(options).forEach(name => {\n            let info = options[name];\n            let easing: EasingFunc;\n            let dest: number;\n\n            if (typeof info === 'number') {\n                deltaValue[name] = info;\n            }\n            else {\n                easing = info.easing;\n                deltaValue[name] = info.value;\n            }\n\n            this.options.push({ name, dest, easing });\n        });\n    }\n\n    private _initBeginValue(target: any) {\n        let beginValue = this.beginValue = {};\n        let deltaValue = this.deltaValue;\n\n        if (this.isTransitionBy) {\n            this.options.forEach(option => {\n                beginValue[option.name] = target[option.name];\n                option.dest = target[option.name] + deltaValue[option.name];\n            });\n        }\n        else {\n            this.options.forEach(option => {\n                beginValue[option.name] = target[option.name];\n                deltaValue[option.name] = option.dest - target[option.name];\n            });\n        }\n    }\n\n    step(deltaTime: number, target: any): void {\n        this.elapsed += deltaTime;\n\n        if (this.beginValue == null) {\n            this._initBeginValue(target);\n        }\n\n        if (this.elapsed >= this.duration) {\n            return this.end(target);\n        }\n\n        var percent = this.elapsed / this.duration;\n        var beginValue = this.beginValue;\n        var deltaValue = this.deltaValue;\n\n        this.options.forEach(({ name, dest, easing }) => {\n            easing = easing || Transition.defaultEasingFunc;\n            target[name] = beginValue[name] + (easing(percent) * deltaValue[name]);\n        });\n    }\n\n    end(target: any): void {\n        this.options.forEach((attr) => {\n            target[attr.name] = attr.dest;\n        });\n        this.done = true;\n    }\n\n    destroy() {\n        this.beginValue = null;\n        this.deltaValue = null;\n        this.options = null;\n    }\n\n    reset() {\n        this.done = false;\n        this.elapsed = 0;\n    }\n\n    reverse() {\n        this.done = false;\n        this.elapsed = 0;\n\n        const { options, beginValue, deltaValue } = this;\n\n        options.forEach(e => {\n            let dest = beginValue[e.name];\n            beginValue[e.name] = e.dest;\n            deltaValue[e.name] = -deltaValue[e.name];\n            e.dest = dest;\n        });\n    }\n}","﻿import { Texture } from '../Texture';\nimport { Delay } from './Delay';\nimport { Callback } from './Callback';\nimport { Animation } from './Animation';\nimport { Tween, EasingFunc } from '../Tween';\nimport { IActionListener, ActionListener } from './ActionListener';\nimport { TransByProps, TransToProps, Transition } from './Transition';\nimport { addArrayItem, removeArrayItem } from '../Util';\nimport { BaseAction } from './BaseAction';\n\nexport enum ActionType {\n    TO,\n    BY,\n    ANIM,\n    WAIT,\n    CALLBACK,\n}\n\nexport type TransToAction = {\n    type: ActionType.TO;\n    options: TransToProps;\n    duration: number;\n};\n\nexport type TransByAction = {\n    type: ActionType.BY;\n    options: TransByProps;\n    duration: number;\n};\n\nexport type AnimationAction = {\n    type: ActionType.ANIM;\n    frameList: Array<Texture | string>;\n    frameRate: number;\n    repetitions?: number;\n}\n\nexport type WaitAction = {\n    type: ActionType.WAIT;\n    duration: number;\n}\n\nexport type CallbackAction = {\n    type: ActionType.CALLBACK;\n    callback: Function;\n}\n\nexport type ActionQueue = Array<TransToAction | TransByAction | AnimationAction | WaitAction | CallbackAction>;\n\nexport enum ActionRepeatMode {\n    NONE,\n    REPEAT,\n    REVERSE_REPEAT,\n}\n\nexport class Action {\n\n    private static _actionList: Array<Action> = [];\n    private static _listenerList: Array<IActionListener> = [];\n\n    /**\n     * Stop action by target\n     */\n    public static stop(target: any) {\n        Action._actionList.slice().forEach((action) => {\n            if (action.target === target) {\n                action.stop();\n            }\n        });\n    }\n\n    /**\n     * Listen a action list, when all actions are done then publish to listener\n     */\n    public static listen(actions: Array<Action>): IActionListener {\n        var listener = new ActionListener(actions);\n        Action._listenerList.push(listener);\n        return listener;\n    }\n\n    public static removeListener(listener: IActionListener) {\n        removeArrayItem(this._listenerList, this);\n    }\n\n    public static schedule(deltaTime: number): void {\n        Action._actionList.slice().forEach(action => {\n            action._step(deltaTime);\n\n            if (action._done) {\n                removeArrayItem(Action._actionList, action);\n            }\n        });\n\n        Action._listenerList.slice().forEach((listener: ActionListener) => {\n            listener._step();\n        });\n    }\n\n    protected _queue: Array<BaseAction> = [];\n    protected _currentIndex: number = 0;\n    protected _done: boolean = false;\n    protected _repeatMode: ActionRepeatMode = ActionRepeatMode.NONE;\n\n    /**\n     * Action running state\n     */\n    public isRunning: boolean = false;\n    public target: any;\n\n    constructor(target: any) {\n        this.target = target;\n    }\n\n    isDone() {\n        return this._done;\n    }\n\n    setRepeatMode(mode: ActionRepeatMode) {\n        this._repeatMode = mode;\n        return this;\n    }\n\n    set repeatMode(mode: ActionRepeatMode) {\n        this._repeatMode = mode;\n    }\n\n    get repeatMode() {\n        return this._repeatMode;\n    }\n\n    queue(actions: ActionQueue) {\n        actions.forEach(action => {\n            switch (action.type) {\n                case ActionType.ANIM:\n                    this.animate(action.frameList, action.frameRate, action.repetitions);\n                    break;\n                case ActionType.BY:\n                    this.by(action.options, action.duration);\n                    break;\n                case ActionType.TO:\n                    this.to(action.options, action.duration);\n                    break;\n                case ActionType.WAIT:\n                    this.wait(action.duration);\n                    break;\n                case ActionType.CALLBACK:\n                    this.then(action.callback);\n                    break;\n            }\n        });\n        return this;\n    }\n\n    /**\n     * Add a callback, it will exec after previous action is done.\n     */\n    then(callback: Function): Action {\n        this._queue.push(new Callback(callback));\n        return this;\n    }\n\n    /**\n     * Add a delay action.\n     */\n    wait(time: number): Action {\n        this._queue.push(new Delay(time));\n        return this;\n    }\n\n    /**\n     * Add a animation action\n     */\n    animate(frameList: Array<Texture | string>, frameRate: number, repetitions?: number): Action {\n        var anim = new Animation(frameList, frameRate, repetitions);\n        this._queue.push(anim);\n        anim.step(anim.interval, this.target);\n        return this;\n    }\n\n    /**\n     * TransitionTo action\n     */\n    to(attrs: TransToProps, duration: number): Action {\n        this._queue.push(new Transition(attrs, duration));\n        return this;\n    }\n\n    /**\n     * TransitionBy action\n     */\n    by(attrs: TransByProps, duration: number): Action {\n        this._queue.push(new Transition(attrs, duration, true));\n        return this;\n    }\n\n    /**\n     * Start the action\n     */\n    start(): Action {\n        if (!this.isRunning) {\n            addArrayItem(Action._actionList, this);\n            this.isRunning = true;\n        }\n        return this;\n    }\n\n    /**\n     * Stop the action\n     */\n    stop() {\n        this._queue.forEach(action => action.destroy());\n\n        this._done = true;\n        this.isRunning = false;\n        this._queue.length = 0;\n\n        removeArrayItem(Action._actionList, this);\n    }\n\n    clear() {\n        this._queue.forEach(action => action.destroy());\n\n        this._done = false;\n        this.isRunning = false;\n        this._queue.length = 0;\n        this._currentIndex = 0;\n        this._repeatMode = ActionRepeatMode.NONE;\n\n        removeArrayItem(Action._actionList, this);\n    }\n\n    protected _step(deltaTime: number): void {\n        if (!this._queue.length || this._currentIndex >= this._queue.length) {\n            return;\n        }\n\n        var action = this._queue[this._currentIndex];\n\n        action.step(deltaTime, this.target);\n\n        if (action.done) {\n            this._currentIndex += 1;\n\n            if (this._currentIndex >= this._queue.length) {\n                this._onAllActionDone();\n            }\n            else if (action.immediate) {\n                this._step(deltaTime);\n            }\n        }\n    }\n\n    protected _onAllActionDone() {\n        switch (this._repeatMode) {\n            case ActionRepeatMode.REPEAT:\n                this._queue.forEach(a => a.reset());\n                this._currentIndex = 0;\n                break;\n            case ActionRepeatMode.REVERSE_REPEAT:\n                this._queue.forEach(a => a.reverse());\n                this._currentIndex = 0;\n                break;\n            default:\n                this._done = true;\n                this.isRunning = false;\n                this.target = null;\n                this._queue.forEach(a => a.destroy());\n                this._queue.length = 0;\n                break;\n        }\n    }\n}","import { uid, addArrayItem, removeArrayItem } from './Util';\n\nvar counter = 0;\n\nexport type EventListener = (...args: any[]) => any;\n\nexport class EventEmitter {\n\n    private static _eventCache: {\n        [id: number]: {\n            [type: string]: {\n                listener: EventListener;\n                once?: boolean;\n            }[]\n        }\n    } = {};\n\n    addListener(type: string, listener: EventListener) {\n        let id = uid(this);\n        if (!EventEmitter._eventCache[id]) {\n            EventEmitter._eventCache[id] = {};\n        }\n        if (!EventEmitter._eventCache[id][type]) {\n            EventEmitter._eventCache[id][type] = [];\n        }\n        let events = EventEmitter._eventCache[id][type];\n        if (events.some(ev => ev.listener === listener && !ev.once)) {\n            return this;\n        }\n        events.push({ listener });\n        return this;\n    }\n\n    on(type: string, listener: EventListener) {\n        return this.addListener(type, listener);\n    }\n\n    once(type: string, listener: EventListener) {\n        let id = uid(this);\n        if (!EventEmitter._eventCache[id]) {\n            EventEmitter._eventCache[id] = {};\n        }\n        if (!EventEmitter._eventCache[id][type]) {\n            EventEmitter._eventCache[id][type] = [];\n        }\n        let events = EventEmitter._eventCache[id][type];\n        if (events.some(ev => ev.listener === listener && ev.once)) {\n            return this;\n        }\n        events.push({ listener, once: true });\n        return this;\n    }\n\n    removeListener(type: string, listener: EventListener) {\n        let cache = EventEmitter._eventCache[uid(this)];\n\n        if (cache && cache[type]) {\n            let events = cache[type];\n            events.slice().forEach((ev, index) => {\n                if (ev.listener === listener) { \n                    removeArrayItem(events, ev);\n                }\n            });\n            if (!events.length) {\n                delete cache[type];\n            }\n        }\n        return this;\n    }\n\n    removeAllListeners(type?: string) {\n        let id = uid(this);\n        let cache = EventEmitter._eventCache[id];\n\n        if (cache) {\n            if (type == null) {\n                EventEmitter[id] = null;\n            }\n            else {\n                delete cache[type];\n            }\n        }\n        return this;\n    }\n\n    emit(type: string, ...args: any[]) {\n        let id = uid(this);\n        let cache = EventEmitter._eventCache[id];\n\n        if (cache && cache[type]) {\n            let events = cache[type];\n            events.slice().forEach(ev => {\n                ev.listener.apply(this, args);\n                if (ev.once) {\n                    removeArrayItem(events, ev);\n                }\n            });\n        }\n        return this;\n    }\n}","var instance: ReleasePool;\n\nexport class ReleasePool {\n\n    private _objs: Object[] = [];\n    private _timerId: number;\n\n    add(obj: Object) {\n        this._objs.push(obj);\n        if (this._timerId != null) {\n            return;\n        }\n        this._timerId = setTimeout(() => this._release(), 0);\n    }\n\n    private _release() {\n        this._objs.forEach(obj => {\n            Object.keys(obj).forEach(key => delete obj[key]);\n        });\n        this._timerId = null;\n        this._objs.length = 0;\n    }\n\n    static get instance() {\n        if (!instance) {\n            instance = new ReleasePool();\n        }\n        return instance;\n    }\n}","import { EventHelper, UIEvent } from '../UIEvent';\nimport { Color, convertColor, uid } from '../Util';\nimport { Action } from '../action/Action';\nimport { Texture } from '../Texture';\nimport { EventEmitter } from '../EventEmitter';\nimport { ReleasePool } from '../ReleasePool';\nimport { Stage } from '../Stage';\nimport { SpriteProps } from '../createSprite';\n\nexport const RAD_PER_DEG: number = Math.PI / 180;\n\nexport enum AlignType {\n    TOP,\n    RIGHT,\n    BOTTOM,\n    LEFT,\n    CENTER\n}\n\nexport class Sprite<T extends ISprite> extends EventEmitter {\n\n    protected _props: T & SpriteProps; // Define for tsx\n\n    protected _width: number = 0;\n    protected _height: number = 0;\n    protected _originX: number = 0.5;\n    protected _originY: number = 0.5;\n    protected _rotation: number = 0;\n    protected _rotationRad: number = 0;\n    protected _texture: Texture;\n    protected _alignX: AlignType;\n    protected _alignY: AlignType;\n    protected _parent: Sprite<T>;\n    protected _stage: Stage;\n\n    protected _top: number;\n    protected _right: number;\n    protected _bottom: number;\n    protected _left: number;\n\n    protected _percentWidth: number;\n    protected _percentHeight: number;\n\n    protected _originPixelX: number = 0;\n    protected _originPixelY: number = 0;\n\n    protected _grid: number[];\n\n    id: number;\n\n    x: number = 0;\n    y: number = 0;\n    scaleX: number = 1;\n    scaleY: number = 1;\n    radius: number = 0;\n    opacity: number = 1;\n    sourceX: number = 0;\n    sourceY: number = 0;\n    sourceWidth: number;\n    sourceHeight: number;\n    lighterMode: boolean = false;\n    autoResize: boolean = true;\n    flippedX: boolean = false;\n    flippedY: boolean = false;\n    visible: boolean = true;\n    clipOverflow: boolean = false;\n    bgColor: Color;\n    borderColor: Color;\n    borderWidth: number;\n    children: Sprite<any>[];\n\n    touchEnabled: boolean = true;\n    mouseEnabled: boolean = true;\n\n    onClick: ISprite[\"onClick\"];\n    onMouseBegin: ISprite[\"onMouseBegin\"];\n    onMouseMoved: ISprite[\"onMouseMoved\"];\n    onMouseEnded: ISprite[\"onMouseEnded\"];\n    onTouchBegin: ISprite[\"onTouchBegin\"];\n    onTouchMoved: ISprite[\"onTouchMoved\"];\n    onTouchEnded: ISprite[\"onTouchEnded\"];\n\n    constructor(props?: T & SpriteProps) {\n        super();\n        this.id = uid(this);\n        this._init(props);\n    }\n\n    protected _init(props?: T & SpriteProps) {\n        if (props) {\n            this.setProps(props);\n        }\n    }\n\n    setProps(props: T & SpriteProps) {\n        Object.keys(props).forEach(key => {\n            this[key] = props[key];\n        });\n    }\n\n    set width(value: number) {\n        if (this._width === value) {\n            return;\n        }\n\n        this._width = value;\n        this._originPixelX = this._width * this._originX;\n\n        if (this.left != null || this.right != null) {\n            this._reCalcX();\n        }\n        else {\n            this._adjustAlignX();\n        }\n\n        this._reLayoutChildrenOnWidthChanged();\n    }\n\n    get width(): number {\n        return this._width;\n    }\n\n    set height(value: number) {\n        if (this._height === value) {\n            return;\n        }\n\n        this._height = value;\n        this._originPixelY = this._height * this._originY;\n\n        if (this.top != null || this.bottom != null) {\n            this._reCalcY();\n        }\n        else {\n            this._adjustAlignY();\n        }\n\n        this._reLayoutChildrenOnHeightChanged();\n    }\n\n    get height(): number {\n        return this._height;\n    }\n\n    set originX(value: number) {\n        if (this._originX === value) {\n            return;\n        }\n\n        this._originX = value;\n        this._originPixelX = this._originX * this._width;\n        if (this.left != null || this.right != null) {\n            this._reCalcX();\n        }\n        else {\n            this._adjustAlignX();\n        }\n    }\n\n    get originX(): number {\n        return this._originX;\n    }\n\n    set originY(value: number) {\n        if (this._originY === value) {\n            return;\n        }\n\n        this._originY = value;\n        this._originPixelY = this._originY * this._height;\n        if (this.top != null || this.bottom != null) {\n            this._reCalcY();\n        }\n        else {\n            this._adjustAlignY();\n        }\n    }\n\n    get originY(): number {\n        return this._originY;\n    }\n\n    get top() {\n        return this._top;\n    }\n\n    set top(top: number) {\n        this.autoResize = false;\n        this._top = top;\n        this._resizeHeight();\n    }\n\n    get right() {\n        return this._right;\n    }\n\n    set right(right: number) {\n        this.autoResize = false;\n        this._right = right;\n        this._resizeWidth();\n    }\n\n    get bottom() {\n        return this._bottom;\n    }\n\n    set bottom(bottom: number) {\n        this.autoResize = false;\n        this._bottom = bottom;\n        this._resizeHeight();\n    }\n\n    get left() {\n        return this._left;\n    }\n\n    set left(left: number) {\n        this.autoResize = false;\n        this._left = left;\n        this._resizeWidth();\n    }\n\n    get percentWidth() {\n        return this._percentWidth;\n    }\n\n    set percentWidth(percentWidth: number) {\n        this.autoResize = false;\n        this._percentWidth = percentWidth;\n        this._resizeWidth();\n    }\n\n    get percentHeight() {\n        return this._percentHeight;\n    }\n\n    set percentHeight(percentHeight: number) {\n        this.autoResize = false;\n        this._percentHeight = percentHeight;\n        this._resizeHeight();\n    }\n\n    get grid() {\n        return this._grid;\n    }\n\n    set grid(grid: number[]) {\n        this._grid = grid;\n        this.autoResize = false;\n    }\n\n    set rotation(value: number) {\n        if (this._rotation === value) {\n            return;\n        }\n\n        this._rotation = value;\n        this._rotationRad = this._rotation * RAD_PER_DEG;\n    }\n\n    get rotation(): number {\n        return this._rotation;\n    }\n\n    set texture(value: Texture | string) {\n        let texture: Texture;\n\n        if (typeof value === 'string') {\n            texture = Texture.create(value);\n        }\n        else {\n            texture = value;\n        }\n        if (texture === this._texture) {\n            return;\n        }\n\n        this._texture = texture;\n\n        if (!this.autoResize) {\n            return;\n        }\n\n        if (texture) {\n            if (texture.ready) {\n                this.width = texture.width;\n                this.height = texture.height;\n            }\n            else {\n                texture.onReady((size) => {\n                    this.width = size.width;\n                    this.height = size.height;\n                });\n            }\n        }\n        else {\n            this.width = 0;\n            this.height = 0;\n        }\n    }\n\n    get texture() {\n        return this._texture;\n    }\n\n    set parent(sprite: Sprite<any>) {\n        if (sprite === this._parent) {\n            return;\n        }\n\n        this._parent = sprite;\n    }\n\n    get parent() {\n        return this._parent;\n    }\n\n    get stage() {\n        return this._stage;\n    }\n\n    set stage(stage: Stage) {\n        if (stage == null) {\n            this.emit(UIEvent.REMOVED_FROM_STAGE);\n            this._stage = stage;\n        }\n        else {\n            this._stage = stage;\n            this.emit(UIEvent.ADD_TO_STAGE);\n        }\n        this.children && this.children.forEach(child => child.stage = stage);\n    }\n\n    set alignX(value: AlignType) {\n        if (this._alignX === value || value === AlignType.BOTTOM || value === AlignType.TOP) {\n            return;\n        }\n        this._alignX = value;\n        this._adjustAlignX();\n    }\n\n    get alignX() {\n        return this._alignX;\n    }\n\n    set alignY(value: AlignType) {\n        if (this._alignY === value || value === AlignType.LEFT || value === AlignType.RIGHT) {\n            return;\n        }\n        this._alignY = value;\n        this._adjustAlignY();\n    }\n\n    get alignY() {\n        return this._alignY;\n    }\n\n    protected _update(deltaTime: number): void {\n        this.emit(UIEvent.FRAME, deltaTime);\n        this.update(deltaTime);\n\n        if (this.children && this.children.length) {\n            this.children.slice().forEach((child) => {\n                child._update(deltaTime);\n            });\n        }\n    }\n\n    protected _visit(context: CanvasRenderingContext2D): void {\n        if (!this.visible || this.opacity === 0) {\n            return;\n        }\n\n        var sx: number = this.scaleX;\n        var sy: number = this.scaleY;\n\n        context.save();\n\n        if (this.lighterMode) {\n            context.globalCompositeOperation = \"lighter\";\n        }\n        if (this.x !== 0 || this.y !== 0) {\n            context.translate(this.x, this.y);\n        }\n        if (this.opacity !== 1) {\n            context.globalAlpha = this.opacity;\n        }\n        if (this.flippedX) {\n            sx = -sx;\n        }\n        if (this.flippedY) {\n            sy = -sy;\n        }\n        if (sx !== 1 || sy !== 1) {\n            context.scale(sx, sy);\n        }\n\n        var rotationRad: number = this._rotationRad % 360;\n\n        if (rotationRad !== 0) {\n            context.rotate(rotationRad);\n        }\n\n        if ((this._width !== 0 && this._height !== 0) || this.radius > 0) {\n            this.draw(context);\n        }\n\n        this._visitChildren(context);\n\n        context.restore();\n    }\n\n    protected _reLayoutChildrenOnWidthChanged() {\n        if (!this.children || !this.children.length) {\n            return;\n        }\n        this.children.forEach(child => {\n            child._resizeWidth();\n            child._adjustAlignX();\n        });\n    }\n\n    protected _reLayoutChildrenOnHeightChanged() {\n        if (!this.children || !this.children.length) {\n            return;\n        }\n        this.children.forEach(child => {\n            child._resizeHeight();\n            child._adjustAlignY();\n        });\n    }\n\n    protected _resizeWidth() {\n        if (this.parent == null) {\n            return;\n        }\n        const { parent, percentWidth, right, left } = this;\n\n        if (left != null && right != null) {\n            this.width = parent.width - left - right;\n        }\n        else if (percentWidth != null) {\n            this.width = parent.width * percentWidth;\n        }\n\n        this._reCalcX();\n    }\n\n    protected _reCalcX() {\n        const { left, right, parent, width, _originPixelX } = this;\n        if (left != null) {\n            this.x = left + _originPixelX;\n        }\n        else if (right != null && parent != null) {\n            this.x = parent.width - (width + right - _originPixelX);\n        }\n    }\n\n    protected _resizeHeight() {\n        if (this.parent == null) {\n            return;\n        }\n        const { parent, percentHeight, top, bottom } = this;\n        if (top != null && bottom != null) {\n            this.height = parent.height - top - bottom;\n            this.y = top + this._originPixelY;\n            return;\n        }\n\n        if (percentHeight != null) {\n            this.height = parent.height * percentHeight;\n        }\n\n        this._reCalcY();\n    }\n\n    protected _reCalcY() {\n        const { top, bottom, parent, height, _originPixelY } = this;\n        if (top != null) {\n            this.y = top + _originPixelY;\n        }\n        else if (bottom != null && parent != null) {\n            this.y = parent.height - (height + bottom - _originPixelY);\n        }\n    }\n\n    protected _adjustAlignX() {\n        if (!this.parent || this._alignX == null || this.left != null || this.right != null) {\n            return false;\n        }\n\n        let x: number;\n        let ox = this._originPixelX;\n\n        switch (this._alignX) {\n            case AlignType.LEFT:\n                x = ox;\n                break;\n            case AlignType.RIGHT:\n                x = this.parent.width - (this.width - ox);\n                break;\n            case AlignType.CENTER:\n                x = this.parent.width * 0.5 + ox - this.width * 0.5;\n                break;\n        }\n\n        if (x != null) {\n            this.x = x;\n        }\n        return true;\n    }\n\n    protected _adjustAlignY() {\n        if (!this.parent || this._alignY == null || this.top != null || this.bottom != null) {\n            return false;\n        }\n\n        let y: number;\n        let oy = this._originPixelY;\n\n        switch (this._alignY) {\n            case AlignType.TOP:\n                y = oy;\n                break;\n            case AlignType.BOTTOM:\n                y = this.parent.height - (this.height - oy);\n                break;\n            case AlignType.CENTER:\n                y = this.parent.height * 0.5 + oy - this.height * 0.5;\n                break;\n        }\n\n        if (y != null) {\n            this.y = y;\n        }\n        return true;\n    }\n\n    protected _visitChildren(context: CanvasRenderingContext2D): void {\n        if (!this.children || !this.children.length) {\n            return;\n        }\n        if (this._originPixelX !== 0 || this._originPixelY !== 0) {\n            context.translate(-this._originPixelX, -this._originPixelY);\n        }\n\n        this.children.forEach((child) => {\n            child._visit(context);\n        });\n    }\n\n    protected _clip(context: CanvasRenderingContext2D) {\n        if (!this.clipOverflow) {\n            return;\n        }\n\n        context.beginPath();\n        if (this.radius > 0) {\n            context.arc(0, 0, this.radius, 0, Math.PI * 2, true);\n        }\n        else {\n            context.rect(-this._originPixelX, -this._originPixelY, this._width, this._height);\n        }\n        context.closePath();\n        context.clip();\n    }\n\n    protected _drawBgColor(context: CanvasRenderingContext2D): void {\n        if (this.bgColor == null) {\n            return;\n        }\n\n        context.fillStyle = convertColor(this.bgColor);\n        context.beginPath();\n        if (this.radius > 0) {\n            context.arc(0, 0, this.radius, 0, Math.PI * 2, true);\n        }\n        else {\n            context.rect(-this._originPixelX, -this._originPixelY, this._width, this._height);\n        }\n        context.closePath();\n        context.fill();\n    }\n\n    protected _drawBorder(context: CanvasRenderingContext2D): void {\n        if (this.borderColor != null) {\n            context.lineWidth = this.borderWidth || 1;\n            context.strokeStyle = convertColor(this.borderColor || 0x000);\n            context.beginPath();\n            if (this.radius > 0) {\n                context.arc(0, 0, this.radius, 0, Math.PI * 2, true);\n            }\n            else {\n                context.rect(-this._originPixelX, -this._originPixelY, this._width, this._height);\n            }\n            context.closePath();\n            context.stroke();\n        }\n    }\n\n    protected draw(context: CanvasRenderingContext2D): void {\n        this._clip(context);\n        this._drawBgColor(context);\n        this._drawBorder(context);\n\n        let texture = this._texture;\n        if (!texture || !texture.ready || texture.width === 0 || texture.height === 0) {\n            return;\n        }\n\n        let sx: number = this.sourceX;\n        let sy: number = this.sourceY;\n        let sw: number = this.sourceWidth == null ? texture.width : this.sourceWidth;\n        let sh: number = this.sourceHeight == null ? texture.height : this.sourceHeight;\n        let w = this.width;\n        let h = this.height;\n        let ox = this._originPixelX;\n        let oy = this._originPixelY;\n        let grid = this.grid;\n\n        if (!Array.isArray(grid)) {\n            context.drawImage(texture.source, sx, sy, sw, sh, -ox, -oy, w, h);\n        }\n        else {\n            let gridSource = (<Texture>this.texture).createGridSource(w, h, sx, sy, sw, sh, grid);\n            context.drawImage(gridSource, -ox, -oy, w, h);\n        }\n    }\n\n    addChild(target: Sprite<any>, position?: number): void {\n        if (target.parent) {\n            throw new Error(\"canvas2d.Sprite.addChild(): Child has been added.\");\n        }\n\n        if (!this.children) {\n            this.children = [];\n        }\n\n        var children: Sprite<any>[] = this.children;\n\n        if (children.indexOf(target) < 0) {\n            if (position > -1 && position < children.length) {\n                children.splice(position, 0, target);\n            }\n            else {\n                children.push(target);\n            }\n            target.parent = this;\n            if (this.stage) {\n                target.stage = this.stage;\n            }\n            target._resizeWidth();\n            target._resizeHeight();\n            target._adjustAlignX();\n            target._adjustAlignY();\n        }\n    }\n\n    addChildren(...children: Sprite<any>[]) {\n        children.forEach(child => {\n            this.addChild(child);\n        });\n    }\n\n    removeChild(target: Sprite<any>): void {\n        if (!this.children || !this.children.length) {\n            return;\n        }\n        var index = this.children.indexOf(target);\n        if (index > -1) {\n            this.children.splice(index, 1);\n            target.parent = null;\n            target.stage = null;\n        }\n    }\n\n    removeChildren(...children: Sprite<any>[]) {\n        children.forEach(child => {\n            this.removeChild(child);\n        });\n    }\n\n    removeAllChildren(recusive?: boolean): void {\n        if (!this.children || !this.children.length) {\n            return;\n        }\n\n        while (this.children.length) {\n            var sprite: Sprite<any> = this.children[0];\n\n            if (recusive) {\n                sprite.removeAllChildren(true);\n                Action.stop(sprite);\n            }\n            this.removeChild(sprite);\n        }\n\n        this.children = null;\n    }\n\n    contains(target: Sprite<any>) {\n        if (!this.children || !this.children.length) {\n            return false;\n        }\n        return this.children.indexOf(target) > -1 || this.children.some(c => c.contains(target));\n    }\n\n    release(recusive?: boolean) {\n        Action.stop(this);\n\n        if (recusive && this.children) {\n            while (this.children.length) {\n                this.children[0].release(recusive);\n            }\n        }\n        else {\n            this.removeAllChildren();\n        }\n\n        if (this.parent) {\n            this.parent.removeChild(this);\n        }\n\n        ReleasePool.instance.add(this);\n        this.removeAllListeners();\n    }\n\n    update(deltaTime: number): any {\n\n    }\n}\n\nexport interface ISprite {\n    x?: number;\n    y?: number;\n    width?: number;\n    height?: number;\n    scaleX?: number;\n    scaleY?: number;\n    originX?: number;\n    originY?: number;\n    bgColor?: Color;\n    radius?: number;\n    borderWidth?: number;\n    borderColor?: Color;\n    texture?: Texture | string;\n    rotation?: number;\n    opacity?: number;\n    visible?: boolean;\n    alignX?: AlignType,\n    alignY?: AlignType,\n    flippedX?: boolean;\n    flippedY?: boolean;\n    clipOverflow?: boolean;\n    top?: number;\n    right?: number;\n    bottom?: number;\n    left?: number;\n    percentWidth?: number;\n    percentHeight?: number;\n    grid?: number[];\n\n    /**\n     * Position X of the clipping rect on texture\n     */\n    sourceX?: number;\n\n    /**\n     * Position Y of the clipping rect on texture\n     */\n    sourceY?: number;\n\n    /**\n     * Width of the clipping rect on texture\n     */\n    sourceWidth?: number;\n\n    /**\n     * Height of the clipping rect on texture\n     */\n    sourceHeight?: number;\n\n    /**\n     * Use lighter mode\n     */\n    lighterMode?: boolean;\n\n    /**\n     * Auto resize by the texture\n     */\n    autoResize?: boolean;\n\n    touchEnabled?: boolean;\n    mouseEnabled?: boolean;\n\n    /**\n     * Sprite would call this method each frame\n     * @param  deltaTime  Duration between now and last frame\n     */\n    update?(deltaTime: number): any;\n\n    /**\n     * Click event handler\n     */\n    onClick?(e: EventHelper, event: MouseEvent): any;\n\n    /**\n     * Mouse begin event handler\n     */\n    onMouseBegin?(e: EventHelper, event: MouseEvent): any;\n\n    /**\n     * Mouse moved event handler\n     */\n    onMouseMoved?(e: EventHelper, event: MouseEvent): any;\n\n    /**\n     * Mouse ended event handler\n     */\n    onMouseEnded?(e: EventHelper, event: MouseEvent): any;\n\n    /**\n     * Touch begin event handler\n     */\n    onTouchBegin?(touches: EventHelper[], event: TouchEvent): any;\n\n    /**\n     * Touch moved event handler\n     */\n    onTouchMoved?(touches: EventHelper[], event: TouchEvent): any;\n\n    /**\n     * Touch ended event hadndler\n     */\n    onTouchEnded?(touches: EventHelper[], event: TouchEvent): any;\n}\n","﻿import { Rect } from './Texture';\nimport { Stage, Orientation } from './Stage';\nimport { Sprite } from './sprite/Sprite';\nimport { addArrayItem } from './Util';\n\nexport type EventHelper = {\n    identifier?: number;\n    beginX: number;\n    beginY: number;\n    localX?: number;\n    localY?: number;\n    stageX?: number;\n    stageY?: number;\n    _moved?: boolean;\n    beginTarget?: Sprite<any>;\n    target?: Sprite<any>;\n    cancelBubble: boolean;\n    stopPropagation();\n}\n\nconst onClick = \"onClick\";\n\nconst onTouchBegin = \"onTouchBegin\";\nconst onTouchMoved = \"onTouchMoved\";\nconst onTouchEnded = \"onTouchEnded\";\n\nconst onMouseBegin = \"onMouseBegin\";\nconst onMouseMoved = \"onMouseMoved\";\nconst onMouseEnded = \"onMouseEnded\";\n\nexport class UIEvent {\n\n    public static supportTouch: boolean = \"ontouchend\" in window;\n\n    public static TOUCH_BEGIN = \"touchstart\";\n    public static TOUCH_MOVED = \"touchmove\";\n    public static TOUCH_ENDED = \"touchend\";\n\n    public static MOUSE_BEGIN = \"mousedown\";\n    public static MOUSE_MOVED = \"mousemove\";\n    public static MOUSE_ENDED = \"mouseup\";\n\n    public static CLICK = \"click\";\n\n    public static ADD_TO_STAGE = \"addtostage\";\n    public static REMOVED_FROM_STAGE = \"removedfromstage\";\n    public static FRAME = \"frame\";\n\n    private _registered: boolean;\n    private _touchHelperMap: { [index: number]: EventHelper } = {};\n    private _mouseBeginHelper: EventHelper;\n    private _mouseMovedHelper: EventHelper;\n\n    stage: Stage;\n    element: HTMLElement;\n\n    constructor(stage: Stage) {\n        this.stage = stage;\n        this.element = stage.canvas;\n    }\n\n    register() {\n        if (this._registered) {\n            return;\n        }\n\n        var { stage, element } = this;\n\n        if (UIEvent.supportTouch) {\n            element.addEventListener(UIEvent.TOUCH_BEGIN, this._touchBeginHandler, false);\n            element.addEventListener(UIEvent.TOUCH_MOVED, this._touchMovedHandler, false);\n            element.addEventListener(UIEvent.TOUCH_ENDED, this._touchEndedHandler, false);\n        }\n\n        element.addEventListener(UIEvent.MOUSE_BEGIN, this._mouseBeginHandler, false);\n        element.addEventListener(UIEvent.MOUSE_MOVED, this._mouseMovedHandler, false);\n        element.addEventListener(UIEvent.MOUSE_ENDED, this._mouseEndedHandler, false);\n\n        this._touchHelperMap = {};\n        this._registered = true;\n    }\n\n    unregister(): void {\n        if (!this._registered) {\n            return;\n        }\n        var element = this.element;\n\n        element.removeEventListener(UIEvent.TOUCH_BEGIN, this._touchBeginHandler, false);\n        element.removeEventListener(UIEvent.TOUCH_MOVED, this._touchMovedHandler, false);\n        element.removeEventListener(UIEvent.TOUCH_ENDED, this._touchEndedHandler, false);\n\n\n        element.removeEventListener(UIEvent.MOUSE_BEGIN, this._mouseBeginHandler, false);\n        element.removeEventListener(UIEvent.MOUSE_MOVED, this._mouseMovedHandler, false);\n        element.removeEventListener(UIEvent.MOUSE_ENDED, this._mouseEndedHandler, false);\n\n        this._mouseBeginHelper = this._mouseMovedHelper = null;\n        this._registered = false;\n    }\n\n    release(): void {\n        this.unregister();\n        this._mouseBeginHandler = this._mouseMovedHandler = this._mouseEndedHandler = null;\n        this._touchBeginHandler = this._touchMovedHandler = this._touchEndedHandler = null;\n        this._touchHelperMap = null;\n        this.element = this.stage = null;\n    }\n\n    private _transformLocation(event) {\n        var clientRect = this.element.getBoundingClientRect();\n        var scaleX = this.stage.scaleX;\n        var scaleY = this.stage.scaleY;\n        var isRotated = this.stage.isPortrait && this.stage.orientation === Orientation.LANDSCAPE;\n        var x: number;\n        var y: number;\n\n        if (isRotated) {\n            x = (event.clientY - clientRect.top) / scaleX;\n            y = this.stage.height - (event.clientX - clientRect.left) / scaleY;\n        }\n        else {\n            x = (event.clientX - clientRect.left) / scaleX;\n            y = (event.clientY - clientRect.top) / scaleY;\n        }\n        return { x, y };\n    }\n\n    private _transformTouches(touches, justGet?: boolean): EventHelper[] {\n        var helpers: EventHelper[] = [];\n        var clientRect = this.element.getBoundingClientRect();\n        var scaleX = this.stage.scaleX;\n        var scaleY = this.stage.scaleY;\n        var isRotated = this.stage.isPortrait && this.stage.orientation === Orientation.LANDSCAPE;\n        var touchHelperMap = this._touchHelperMap;\n\n        for (var i: number = 0, x: number, y: number, id: number, helper, touch; touch = touches[i]; i++) {\n            id = touch.identifier;\n            var x: number;\n            var y: number;\n\n            if (isRotated) {\n                x = (touch.clientY - clientRect.top) / scaleX;\n                y = this.stage.height - (touch.clientX - clientRect.left) / scaleY;\n            }\n            else {\n                x = (touch.clientX - clientRect.left) / scaleX;\n                y = (touch.clientY - clientRect.top) / scaleY;\n            }\n\n            helper = touchHelperMap[id];\n\n            if (!helper) {\n                helper = touchHelperMap[id] = {\n                    identifier: id,\n                    beginX: x,\n                    beginY: y,\n                    cancelBubble: false,\n                    stopPropagation() {\n                        this.cancelBubble = true;\n                    }\n                };\n            }\n            else if (!justGet) {\n                helper._moved = x - helper.beginX !== 0 || y - helper.beginY !== 0;\n            }\n\n            helper.stageX = x;\n            helper.stageY = y;\n\n            helpers.push(helper);\n        }\n\n        return helpers;\n    }\n\n    private _touchBeginHandler = (event: TouchEvent) => {\n        var stage = this.stage;\n\n        if (!stage.isRunning || !stage.touchEnabled) {\n            return;\n        }\n\n        var helpers = this._transformTouches(event.changedTouches);\n\n        this._dispatchTouch(stage.sprite, 0, 0, helpers.slice(), event, onTouchBegin, UIEvent.TOUCH_BEGIN);\n\n        helpers.forEach((touch) => {\n            touch.beginTarget = touch.target;\n        });\n\n        stage.emit(UIEvent.TOUCH_BEGIN, helpers, event);\n        event.preventDefault();\n    }\n\n    private _touchMovedHandler = (event: TouchEvent) => {\n        var stage = this.stage;\n\n        if (!stage.isRunning || !stage.touchEnabled) {\n            return;\n        }\n\n        var helpers = this._transformTouches(event.changedTouches);\n\n        this._dispatchTouch(stage.sprite, 0, 0, helpers, event, onTouchMoved, UIEvent.TOUCH_MOVED);\n\n        stage.emit(UIEvent.TOUCH_MOVED, helpers, event);\n        event.preventDefault();\n    }\n\n    private _touchEndedHandler = (event: TouchEvent) => {\n        var stage = this.stage;\n\n        if (stage.isRunning && stage.touchEnabled) {\n            var helpers = this._transformTouches(event.changedTouches, true);\n\n            this._dispatchTouch(stage.sprite, 0, 0, helpers.slice(), event, onTouchEnded, UIEvent.TOUCH_ENDED, true);\n\n            helpers.forEach(helper => {\n                helper.target = null;\n                helper.beginTarget = null;\n                this._touchHelperMap[helper.identifier] = null;\n            });\n\n            stage.emit(UIEvent.TOUCH_ENDED, helpers, event);\n            helpers = null;\n        }\n    }\n\n    private _mouseBeginHandler = (event: MouseEvent) => {\n        var stage = this.stage;\n        if (!stage.isRunning || !stage.mouseEnabled) {\n            return;\n        }\n\n        var location = this._transformLocation(event);\n        var helper: EventHelper = {\n            beginX: location.x,\n            beginY: location.y,\n            stageX: location.x,\n            stageY: location.y,\n            cancelBubble: false,\n            stopPropagation() {\n                this.cancelBubble = true;\n            }\n        };\n\n        this._dispatchMouse(stage.sprite, 0, 0, helper, event, UIEvent.MOUSE_BEGIN, onMouseBegin);\n\n        if (helper.target) {\n            helper.beginTarget = helper.target;\n            this._mouseBeginHelper = helper;\n        }\n\n        stage.emit(UIEvent.MOUSE_BEGIN, helper, event);\n        event.preventDefault();\n    }\n\n    private _mouseMovedHandler = (event: MouseEvent) => {\n        var stage = this.stage;\n        if (!stage.isRunning || !stage.mouseEnabled) {\n            return;\n        }\n\n        var location = this._transformLocation(event);\n        var mouseBeginHelper = this._mouseBeginHelper;\n\n        if (mouseBeginHelper) {\n            mouseBeginHelper.stageX = location.x;\n            mouseBeginHelper.stageY = location.y;\n            mouseBeginHelper._moved = mouseBeginHelper.beginX - location.x !== 0 || mouseBeginHelper.beginY - location.y !== 0;\n            mouseBeginHelper.cancelBubble = false;\n            this._dispatchMouse(stage.sprite, 0, 0, mouseBeginHelper, event, UIEvent.MOUSE_MOVED, onMouseMoved);\n            stage.emit(UIEvent.MOUSE_MOVED, mouseBeginHelper, event);\n        }\n        else {\n            let mouseMovedHelper = this._mouseMovedHelper = {\n                beginX: null,\n                beginY: null,\n                stageX: location.x,\n                stageY: location.y,\n                cancelBubble: false,\n                stopPropagation() {\n                    this.cancelBubble = true;\n                }\n            };\n            this._dispatchMouse(stage.sprite, 0, 0, mouseMovedHelper, event, UIEvent.MOUSE_MOVED, onMouseMoved);\n            stage.emit(UIEvent.MOUSE_MOVED, mouseMovedHelper, event);\n        }\n\n        event.preventDefault();\n    }\n\n    private _mouseEndedHandler = (event: MouseEvent) => {\n        var stage = this.stage;\n        if (stage.isRunning && stage.mouseEnabled) {\n            var location = this._transformLocation(event)\n            var helper = this._mouseBeginHelper || this._mouseMovedHelper;\n            var target;\n\n            helper.stageX = location.x;\n            helper.stageY = location.y;\n            target = helper.target;\n\n            var triggerClick = !helper._moved || isMovedSmallRange(helper);\n            this._dispatchMouse(stage.sprite, 0, 0, helper, event, onMouseEnded, UIEvent.MOUSE_ENDED, triggerClick);\n            stage.emit(UIEvent.MOUSE_ENDED, helper, event);\n            helper.target = helper.beginTarget = null;\n        }\n\n        this._mouseBeginHelper = this._mouseMovedHelper = null;\n    }\n\n    private _dispatchTouch(\n        sprite: Sprite<any>,\n        offsetX: number,\n        offsetY: number,\n        helpers: EventHelper[],\n        event: TouchEvent,\n        methodName: string,\n        eventName: string,\n        needTriggerClick?: boolean\n    ): any {\n        if (!sprite.touchEnabled || !sprite.visible) {\n            return;\n        }\n\n        offsetX += sprite.x - (sprite as any)._originPixelX;\n        offsetY += sprite.y - (sprite as any)._originPixelY;\n\n        if (sprite.clipOverflow) {\n            return this._detectTouchOnClipArea(sprite, offsetX, offsetY, helpers, event, methodName, eventName, needTriggerClick);\n        }\n\n        var children = sprite.children;\n        var tmpHelpers: EventHelper[] = helpers.slice();\n        var triggerreds: EventHelper[] = [];\n        var result: EventHelper[];\n\n        var callback = helper => result.indexOf(helper) === -1;\n\n        if (children && children.length) {\n            let index = children.length;\n\n            while (--index >= 0) {\n                result = this._dispatchTouch(children[index], offsetX, offsetY, tmpHelpers, event, methodName, eventName, needTriggerClick);\n                if (result && result.length) {\n                    triggerreds.push(...result);\n\n                    // Remove triggerred touch helper, it won't pass to other child sprites\n                    tmpHelpers = tmpHelpers.filter(callback);\n\n                    // All triggerred then exit the loop\n                    if (!tmpHelpers.length) {\n                        break;\n                    }\n                }\n            }\n        }\n\n        var hits: EventHelper[] = triggerreds.filter(helper => !helper.cancelBubble);\n        var rect: Rect = {\n            x: offsetX,\n            y: offsetY,\n            width: sprite.width,\n            height: sprite.height\n        };\n        var circle = {\n            x: offsetX,\n            y: offsetY,\n            radius: sprite.radius\n        };\n        var count = 0;\n\n        for (let i = 0, helper: EventHelper; helper = tmpHelpers[i]; i++) {\n            if (isRectContainPoint(rect, helper) || isCircleContainPoint(circle, helper)) {\n                if (!helper.target) {\n                    helper.target = sprite;\n                }\n                helper.localX = helper.stageX - rect.x;\n                helper.localY = helper.stageY - rect.y;\n\n                // Add for current sprite hit list\n                hits.push(helper);\n                count++;\n            }\n        }\n\n        if (hits.length) {\n            // var hasMethod: boolean = hasImplements(sprite, methodName);\n            // var hasClickHandler: boolean = hasImplements(sprite, onClick);\n\n            triggerreds.push(...hits.slice(hits.length - count, count));\n\n            sprite.emit(eventName, hits, event);\n            sprite[methodName] && sprite[methodName](hits, event);\n\n            // Click event would just trigger by only a touch\n            if (needTriggerClick && hits.length === 1 && (!hits[0]._moved || isMovedSmallRange(hits[0]))) {\n                sprite.emit(UIEvent.CLICK, hits[0], event);\n                sprite[onClick] && sprite[onClick](hits[0], event as any);\n                addArrayItem(triggerreds, hits[0]);\n            }\n        }\n        return triggerreds;\n    }\n\n    private _detectTouchOnClipArea(\n        sprite: Sprite<any>,\n        offsetX: number,\n        offsetY: number,\n        helpers: EventHelper[],\n        event: TouchEvent,\n        methodName: string,\n        eventName: string,\n        needTriggerClick?: boolean\n    ) {\n        var hits: EventHelper[] = [];\n        var rect: Rect = {\n            x: offsetX,\n            y: offsetY,\n            width: sprite.width,\n            height: sprite.height\n        };\n        var circle = {\n            x: offsetX,\n            y: offsetY,\n            radius: sprite.radius\n        };\n        var count = 0;\n\n        for (let i = 0, helper: EventHelper; helper = helpers[i]; i++) {\n            if (isRectContainPoint(rect, helper) || isCircleContainPoint(circle, helper)) {\n                if (!helper.target) {\n                    helper.target = sprite;\n                }\n                helper.localX = helper.stageX - offsetX;\n                helper.localY = helper.stageY - offsetY;\n\n                // Add for current sprite hit list\n                hits.push(helper);\n                count++;\n            }\n        }\n\n        if (hits.length) {\n            let children = sprite.children;\n            let triggerreds = [];\n            if (children && children.length) {\n                let index = children.length;\n                let result;\n                let filterUnTriggerred = helper => result.indexOf(helper) === -1;\n                let tmpHelpers = hits.slice();\n\n                while (--index >= 0) {\n                    result = this._dispatchTouch(children[index], offsetX, offsetY, tmpHelpers, event, methodName, eventName, needTriggerClick);\n                    if (result && result.length) {\n                        triggerreds.push(...result);\n\n                        // Remove triggerred touch helper, it won't pass to other child sprites\n                        tmpHelpers = tmpHelpers.filter(filterUnTriggerred);\n\n                        // All triggerred then exit the loop\n                        if (!tmpHelpers.length) {\n                            break;\n                        }\n                    }\n                }\n            }\n\n            hits = triggerreds.filter(helper => !helper.cancelBubble);\n\n            if (hits.length) {\n                sprite.emit(eventName, hits, event);\n                sprite[methodName] && sprite[methodName](hits, event);\n\n                // Click event would just trigger by only a touch\n                if (needTriggerClick && hits.length === 1 && (!hits[0]._moved || isMovedSmallRange(hits[0]))) {\n                    sprite.emit(UIEvent.CLICK, hits[0], event);\n                    sprite[onClick] && sprite[onClick](hits[0], event as any);\n                }\n            }\n\n            return triggerreds;\n        }\n    }\n\n    private _dispatchMouse(\n        sprite: Sprite<any>,\n        offsetX: number,\n        offsetY: number,\n        helper: EventHelper,\n        event: MouseEvent,\n        methodName: string,\n        eventName: string,\n        needTriggerClick?: boolean\n    ): boolean {\n        if (!sprite.mouseEnabled || !sprite.visible) {\n            return false;\n        }\n\n        offsetX += sprite.x - (sprite as any)._originPixelX;\n        offsetY += sprite.y - (sprite as any)._originPixelY;\n\n        if (sprite.clipOverflow) {\n            return this._detectMouseOnClipArea(sprite, offsetX, offsetY, helper, event, methodName, eventName, needTriggerClick);\n        }\n\n        var children = sprite.children;\n        var triggerred = false;\n\n        if (children && children.length) {\n            var index = children.length;\n\n            while (--index >= 0) {\n                triggerred = this._dispatchMouse(children[index], offsetX, offsetY, helper, event, methodName, eventName, needTriggerClick);\n                if (triggerred) {\n                    break;\n                }\n            }\n\n            if (helper.cancelBubble) {\n                return true;\n            }\n        }\n\n        var rect: Rect = {\n            x: offsetX,\n            y: offsetY,\n            width: sprite.width,\n            height: sprite.height\n        };\n        var circle = {\n            x: offsetX,\n            y: offsetY,\n            radius: sprite.radius\n        };\n\n        if (triggerred || isRectContainPoint(rect, helper) || isCircleContainPoint(circle, helper)) {\n            if (!helper.target) {\n                helper.target = sprite;\n            }\n            helper.localX = helper.stageX - rect.x;\n            helper.localY = helper.stageY - rect.y;\n\n            sprite.emit(eventName, helper, event);\n            sprite[methodName] && sprite[methodName](helper, event);\n            if (needTriggerClick) {\n                sprite.emit(UIEvent.CLICK, helper, event);\n                sprite[onClick] && sprite[onClick](helper, event);\n            }\n\n            return true;\n        }\n    }\n\n    private _detectMouseOnClipArea(\n        sprite: Sprite<any>,\n        offsetX: number,\n        offsetY: number,\n        helper: EventHelper,\n        event: MouseEvent,\n        methodName: string,\n        eventName: string,\n        needTriggerClick?: boolean\n    ): boolean {\n        var rect: Rect = {\n            x: offsetX,\n            y: offsetY,\n            width: sprite.width,\n            height: sprite.height\n        };\n        var circle = {\n            x: offsetX,\n            y: offsetY,\n            radius: sprite.radius\n        };\n\n        if (isRectContainPoint(rect, helper) || isCircleContainPoint(circle, helper)) {\n            var children = sprite.children;\n            var triggerred = false;\n\n            if (children && children.length) {\n                var index = children.length;\n\n                while (--index >= 0) {\n                    triggerred = this._dispatchMouse(children[index], offsetX, offsetY, helper, event, methodName, eventName, needTriggerClick);\n                    if (triggerred) {\n                        break;\n                    }\n                }\n\n                if (helper.cancelBubble) {\n                    return true;\n                }\n            }\n\n            if (!helper.target) {\n                helper.target = sprite;\n            }\n            helper.localX = helper.stageX - rect.x;\n            helper.localY = helper.stageY - rect.y;\n\n            sprite.emit(eventName, helper, event);\n            sprite[methodName] && sprite[methodName](helper, event);\n            if (needTriggerClick) {\n                sprite.emit(UIEvent.CLICK, helper, event);\n                sprite[onClick] && sprite[onClick](helper, event);\n            }\n\n            return true;\n        }\n    }\n}\n\nfunction isRectContainPoint(rect: Rect, p: EventHelper) {\n    return rect.x <= p.stageX && rect.x + rect.width >= p.stageX &&\n        rect.y <= p.stageY && rect.y + rect.height >= p.stageY;\n}\n\nfunction isCircleContainPoint(circle: { x: number; y: number; radius: number }, p: EventHelper) {\n    var dx = p.stageX - circle.x;\n    var dy = p.stageY - circle.y;\n    return Math.sqrt(dx * dx + dy * dy) <= circle.radius;\n}\n\nfunction isMovedSmallRange(e: EventHelper) {\n    if (e.beginX == null && e.beginY == null) {\n        return false;\n    }\n    let x = Math.abs(e.beginX - e.stageX);\n    let y = Math.abs(e.beginY - e.stageY);\n\n    return x <= 5 && y <= 5;\n}\n\nfunction hasImplements(sprite: Sprite<any>, methodName: string) {\n    return sprite[methodName] !== Sprite.prototype[methodName] && typeof sprite[methodName] === 'function';\n}","﻿import { UIEvent } from './UIEvent';\r\nimport { Sprite } from './sprite/Sprite';\r\nimport { Action } from './action/Action';\r\nimport { EventEmitter } from './EventEmitter';\r\n\r\nexport enum ScaleMode {\r\n    SHOW_ALL,\r\n    NO_BORDER,\r\n    FIX_WIDTH,\r\n    FIX_HEIGHT,\r\n    EXACTFIT,\r\n}\r\n\r\nexport enum Orientation {\r\n    LANDSCAPE,\r\n    PORTRAIT,\r\n}\r\n\r\nexport type VisibleRect = {\r\n    left: number;\r\n    right: number;\r\n    top: number;\r\n    bottom: number;\r\n};\r\n\r\nexport class Stage extends EventEmitter {\r\n\r\n    private _fps: number = 30;\r\n    private _frameRate: number = 1000 / this._fps;\r\n    private _isRunning: boolean;\r\n    private _width: number = 0;\r\n    private _height: number = 0;\r\n    private _sprite: Sprite<{}>;\r\n    private _visibleRect: VisibleRect;\r\n    private _scaleX: number;\r\n    private _scaleY: number;\r\n    private _isPortrait: boolean;\r\n    private _scaleMode: ScaleMode;\r\n    private _autoAdjustCanvasSize: boolean;\r\n    private _orientation: Orientation;\r\n    private _canvas: HTMLCanvasElement;\r\n    private _renderContext: CanvasRenderingContext2D;\r\n    private _bufferCanvas: HTMLCanvasElement;\r\n    private _bufferContext: CanvasRenderingContext2D;\r\n    private _useExternalTimer: boolean;\r\n    private _lastUpdateTime: number;\r\n    private _timerId: number;\r\n    private _uiEvent: UIEvent;\r\n    \r\n    touchEnabled: boolean;\r\n    mouseEnabled: boolean;\r\n\r\n    get fps(): number {\r\n        return this._fps;\r\n    }\r\n\r\n    set fps(value: number) {\r\n        this._frameRate = 1000 / value;\r\n        this._fps = value;\r\n    }\r\n\r\n    get isRunning(): boolean {\r\n        return this._isRunning;\r\n    }\r\n\r\n    get width(): number {\r\n        return this._width;\r\n    }\r\n\r\n    get height(): number {\r\n        return this._height;\r\n    }\r\n\r\n    get canvas(): HTMLCanvasElement {\r\n        return this._canvas;\r\n    }\r\n\r\n    get context(): CanvasRenderingContext2D {\r\n        return this._renderContext;\r\n    }\r\n\r\n    get sprite(): Sprite<{}> {\r\n        return this._sprite;\r\n    }\r\n\r\n    get visibleRect(): VisibleRect {\r\n        return this._visibleRect;\r\n    }\r\n\r\n    get scaleX(): number {\r\n        return this._scaleX;\r\n    }\r\n\r\n    get scaleY(): number {\r\n        return this._scaleY;\r\n    }\r\n\r\n    get isPortrait() {\r\n        return this._isPortrait;\r\n    }\r\n\r\n    get scaleMode(): ScaleMode {\r\n        return this._scaleMode;\r\n    }\r\n\r\n    set scaleMode(value: ScaleMode) {\r\n        if (value === this._scaleMode) {\r\n            return;\r\n        }\r\n\r\n        this._scaleMode = value;\r\n        this.adjustCanvasSize();\r\n    }\r\n\r\n    get autoAdjustCanvasSize() {\r\n        return this._autoAdjustCanvasSize;\r\n    }\r\n\r\n    set autoAdjustCanvasSize(value: boolean) {\r\n        if (value && !this._autoAdjustCanvasSize) {\r\n            this._autoAdjustCanvasSize = true;\r\n            this.adjustCanvasSize();\r\n            window.addEventListener(\"resize\", this.adjustCanvasSize);\r\n        }\r\n        else if (!value && this._autoAdjustCanvasSize) {\r\n            this._autoAdjustCanvasSize = false;\r\n            window.removeEventListener(\"resize\", this.adjustCanvasSize);\r\n        }\r\n    }\r\n\r\n    get orientation() {\r\n        return this._orientation;\r\n    }\r\n\r\n    set orientation(orientation: Orientation) {\r\n        if (this._orientation != orientation) {\r\n            this._orientation = orientation;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param  canvas     Canvas element\r\n     * @param  width      Resolution design width\r\n     * @param  height     Resolution design height\r\n     * @param  scaleMode  Adjust resolution design scale mode \r\n     */\r\n    constructor(\r\n        canvas: HTMLCanvasElement,\r\n        width: number,\r\n        height: number,\r\n        scaleMode: ScaleMode,\r\n        autoAdjustCanvasSize?: boolean,\r\n        orientation = Orientation.PORTRAIT\r\n    ) {\r\n        super();\r\n\r\n        this._sprite = new Sprite({\r\n            x: width * 0.5,\r\n            y: height * 0.5,\r\n            width: width,\r\n            height: height\r\n        });\r\n        this._sprite.stage = this;\r\n        this._scaleMode = scaleMode;\r\n\r\n        this._canvas = canvas;\r\n        this._renderContext = canvas.getContext('2d');\r\n\r\n        this._bufferCanvas = document.createElement(\"canvas\");\r\n        this._bufferContext = this._bufferCanvas.getContext(\"2d\");\r\n\r\n        this._width = canvas.width = this._bufferCanvas.width = width;\r\n        this._height = canvas.height = this._bufferCanvas.height = height;\r\n\r\n        this._scaleX = this._scaleY = 1;\r\n        this._isPortrait = false;\r\n        this._visibleRect = { left: 0, right: width, top: 0, bottom: height };\r\n        this.orientation = orientation;\r\n        this.autoAdjustCanvasSize = autoAdjustCanvasSize;\r\n\r\n        this._uiEvent = new UIEvent(this);\r\n    }\r\n\r\n    setSize(width: number, height: number) {\r\n        this._width = this._canvas.width = this._bufferCanvas.width = width;\r\n        this._height = this._canvas.height = this._bufferCanvas.height = height;\r\n\r\n        if (this._autoAdjustCanvasSize) {\r\n            this.adjustCanvasSize();\r\n        }\r\n\r\n        this._sprite.x = width * 0.5;\r\n        this._sprite.y = height * 0.5;\r\n        this._sprite.width = width;\r\n        this._sprite.height = height;\r\n    }\r\n\r\n    adjustCanvasSize = () => {\r\n        var canvas = this._canvas;\r\n        var stageWidth = this._width;\r\n        var stageHeight = this._height;\r\n        var scaleMode = this._scaleMode;\r\n        var visibleRect = this._visibleRect;\r\n        var orientation = this._orientation;\r\n\r\n        if (!canvas || !canvas.parentNode) {\r\n            return;\r\n        }\r\n\r\n        var style = canvas.style;\r\n        var container = {\r\n            width: canvas.parentElement.offsetWidth,\r\n            height: canvas.parentElement.offsetHeight\r\n        };\r\n        var isPortrait = container.width < container.height;\r\n\r\n        if (orientation === Orientation.LANDSCAPE && isPortrait) {\r\n            let tmpHeight = container.height;\r\n            container.height = container.width;\r\n            container.width = tmpHeight;\r\n        }\r\n\r\n        var sx: number = container.width / stageWidth;\r\n        var sy: number = container.height / stageHeight;\r\n        var deltaWidth: number = 0;\r\n        var deltaHeight: number = 0;\r\n        var scaleX: number;\r\n        var scaleY: number;\r\n        var width: number;\r\n        var height: number;\r\n\r\n        switch (scaleMode) {\r\n            case ScaleMode.SHOW_ALL:\r\n                if (sx < sy) {\r\n                    scaleX = scaleY = sx;\r\n                    width = container.width;\r\n                    height = scaleX * stageHeight;\r\n                }\r\n                else {\r\n                    scaleX = scaleY = sy;\r\n                    width = scaleX * stageWidth;\r\n                    height = container.height;\r\n                }\r\n                break;\r\n            case ScaleMode.NO_BORDER:\r\n                scaleX = scaleY = sx > sy ? sx : sy;\r\n                width = stageWidth * scaleX;\r\n                height = stageHeight * scaleX;\r\n                deltaWidth = (stageWidth - container.width / scaleX) * 0.5 | 0;\r\n                deltaHeight = (stageHeight - container.height / scaleX) * 0.5 | 0;\r\n                break;\r\n            case ScaleMode.FIX_WIDTH:\r\n                scaleX = scaleY = sx;\r\n                width = container.width;\r\n                height = container.height * scaleX;\r\n                deltaHeight = (stageHeight - container.height / scaleX) * 0.5 | 0;\r\n                break;\r\n            case ScaleMode.FIX_HEIGHT:\r\n                scaleX = scaleY = sy;\r\n                width = scaleX * container.width;\r\n                height = container.height;\r\n                deltaWidth = (stageWidth - container.width / scaleX) * 0.5 | 0;\r\n                break;\r\n            case ScaleMode.EXACTFIT:\r\n                scaleX = sx;\r\n                scaleY = sy;\r\n                width = container.width;\r\n                height = container.height;\r\n                break;\r\n            default:\r\n                throw new Error(`Unknow stage scale mode \"${scaleMode}\"`);\r\n        }\r\n\r\n        style.width = width + 'px';\r\n        style.height = height + 'px';\r\n        style.position = 'absolute';\r\n\r\n        visibleRect.left = deltaWidth;\r\n        visibleRect.right = stageWidth - deltaWidth;\r\n        visibleRect.top = deltaHeight;\r\n        visibleRect.bottom = stageHeight - deltaHeight;\r\n\r\n        if (orientation === Orientation.LANDSCAPE && isPortrait) {\r\n            style.top = ((container.width - width) * 0.5) + 'px';\r\n            style.left = ((container.height - height) * 0.5) + 'px';\r\n            style.transformOrigin = style['webkitTransformOrigin'] = '0 0 0';\r\n            style.transform = style['webkitTransform'] = `translateX(${height}px) rotate(90deg)`;\r\n        }\r\n        else {\r\n            style.transform = '';\r\n            style.top = ((container.height - height) * 0.5) + 'px';\r\n            style.left = ((container.width - width) * 0.5) + 'px';\r\n        }\r\n\r\n        this._scaleX = scaleX;\r\n        this._scaleY = scaleY;\r\n        this._isPortrait = isPortrait;\r\n    }\r\n\r\n    start(useExternalTimer?: boolean): void {\r\n        if (this._isRunning) {\r\n            return;\r\n        }\r\n\r\n        this._useExternalTimer = !!useExternalTimer;\r\n\r\n        if (!useExternalTimer) {\r\n            this._lastUpdateTime = Date.now();\r\n            this._startTimer();\r\n        }\r\n\r\n        this._uiEvent.register();\r\n        this._isRunning = true;\r\n    }\r\n\r\n    step(deltaTime: number): void {\r\n        (this._sprite as any)._update(deltaTime);\r\n    }\r\n\r\n    stop(unregisterUIEvent?: boolean): void {\r\n        if (!this._isRunning) {\r\n            return;\r\n        }\r\n\r\n        if (unregisterUIEvent) {\r\n            this._uiEvent.unregister();\r\n        }\r\n\r\n        this._isRunning = false;\r\n        clearTimeout(this._timerId);\r\n    }\r\n\r\n    render() {\r\n        if (!this._isRunning) {\r\n            return;\r\n        }\r\n\r\n        var { width, height } = this._canvas;\r\n\r\n        this._bufferContext.clearRect(0, 0, width, height);\r\n        (this._sprite as any)._visit(this._bufferContext);\r\n\r\n        this._renderContext.clearRect(0, 0, width, height);\r\n        this._renderContext.drawImage(this._bufferCanvas, 0, 0, width, height);\r\n    }\r\n\r\n    /**\r\n     * Add sprite to the stage\r\n     */\r\n    addChild(child: Sprite<any>, position?: number): void {\r\n        this._sprite.addChild(child, position);\r\n    }\r\n\r\n    /**\r\n     * Remove sprite from the stage\r\n     */\r\n    removeChild(child: Sprite<any>): void {\r\n        this._sprite.removeChild(child);\r\n    }\r\n\r\n    /**\r\n     * Remove all sprites from the stage\r\n     * @param  recusive  Recusize remove all the children\r\n     */\r\n    removeAllChildren(recusive?: boolean): void {\r\n        this._sprite.removeAllChildren(recusive);\r\n    }\r\n\r\n    release() {\r\n        this.stop(true);\r\n        this._uiEvent.release();\r\n        this._sprite.release(true);\r\n        this._sprite = this._uiEvent = this._canvas = this._renderContext = this._bufferCanvas = this._bufferContext = null;\r\n    }\r\n\r\n    private _startTimer() {\r\n        this._timerId = setTimeout(() => {\r\n            if (this._useExternalTimer) {\r\n                return;\r\n            }\r\n\r\n            var deltaTime: number = this._getDeltaTime();\r\n            Action.schedule(deltaTime);\r\n            (this._sprite as any)._update(deltaTime);\r\n            this.render();\r\n            this._startTimer();\r\n        }, this._frameRate);\r\n    }\r\n\r\n    private _getDeltaTime() {\r\n        var now = Date.now();\r\n        var delta = now - this._lastUpdateTime;\r\n\r\n        this._lastUpdateTime = now;\r\n        return delta / 1000;\r\n    }\r\n}","\nvar canvas = document.createElement('canvas');\nvar ctx = canvas.getContext('2d');\n\nvar _cache: { [key: string]: MeasuredSize } = {};\n\nfunction getCacheKey(text: string, width: number, fontFace: FontFace, fontSize: number, lineHeight: number) {\n    return text + width + fontFace.name + fontSize + lineHeight;\n}\n\nexport type FontFace = {\n    style: string;\n    weight: string;\n    name: string;\n}\n\nexport type MeasuredSize = {\n    width: number;\n    height: number;\n    lines: { width: number; text: string }[];\n};\n\nexport function measureText(text: string, width: number, fontFace: FontFace, fontSize: number, lineHeight: number): MeasuredSize {\n    var cacheKey = getCacheKey(text, width, fontFace, fontSize, lineHeight);\n    var cached = _cache[cacheKey];\n    if (cached) {\n        return cached;\n    }\n\n    var measuredSize: MeasuredSize = {} as any;\n    var textMetrics: TextMetrics;\n    var lastMeasuredWidth: number;\n    var tryLine: string;\n    var currentLine: string;\n\n    ctx.font = fontFace.style + ' ' + fontFace.weight + ' ' + fontSize + 'px ' + fontFace.name;\n    textMetrics = ctx.measureText(text);\n\n    measuredSize.width = textMetrics.width;\n    measuredSize.height = lineHeight;\n    measuredSize.lines = [];\n\n    if (measuredSize.width <= width) {\n        // The entire text string fits.\n        measuredSize.lines.push({ width: measuredSize.width, text: text });\n    }\n    else {\n        // Break into multiple lines.\n        measuredSize.width = width;\n        currentLine = '';\n\n        let breaker = new LineBreaker(text, fontSize);\n        let remainWidth = width;\n        let index = 0;\n        let words: string;\n\n        while (index < text.length) {\n            let res = breaker.nextBreak(remainWidth);\n\n            if (res.len) {\n                words = text.slice(index, index + res.len);\n                tryLine = currentLine + words;\n                textMetrics = ctx.measureText(tryLine);\n                if (textMetrics.width > width) {\n                    measuredSize.height += lineHeight;\n                    measuredSize.lines.push({\n                        width: lastMeasuredWidth,\n                        text: currentLine.trim(),\n                    });\n                    currentLine = words;\n                    lastMeasuredWidth = ctx.measureText(currentLine.trim()).width;\n                    remainWidth = width;\n                }\n                else {\n                    currentLine = tryLine;\n                    lastMeasuredWidth = textMetrics.width;\n                    remainWidth = width - lastMeasuredWidth;\n                }\n            }\n            else {\n                measuredSize.height += lineHeight;\n                measuredSize.lines.push({\n                    width: lastMeasuredWidth,\n                    text: currentLine.trim(),\n                });\n                currentLine = \"\";\n                lastMeasuredWidth = 0;\n                remainWidth = width;\n            }\n\n            index += res.len;\n        }\n\n        currentLine = currentLine.trim();\n        if (currentLine.length > 0) {\n            textMetrics = ctx.measureText(currentLine);\n            measuredSize.lines.push({ width: textMetrics.width, text: currentLine });\n        }\n    }\n\n    _cache[cacheKey] = measuredSize;\n\n    return measuredSize;\n};\n\nclass LineBreaker {\n\n    private position = 0;\n\n    constructor(public text: string, public fontSize: number) {\n\n    }\n\n    nextBreak(width: number) {\n        let len = Math.max(0, Math.floor(width / this.fontSize) - 1);\n        let pos = this.position;\n        this.position += len;\n        return {\n            len,\n        };\n    }\n}","﻿import { convertColor, Color } from '../Util';\nimport { Sprite, ISprite } from './Sprite';\nimport { measureText } from '../measureText';\n\nexport type FontWeight = \"lighter\" | \"normal\" | \"bold\" | \"bolder\";\nexport type FontStyle = \"oblique\" | \"normal\" | \"italic\";\nexport type TextAlign = \"left\" | \"right\" | \"center\" | \"start\" | \"end\";\n\nconst DefaultFontSize = 24;\n\nexport type ITextLabel = ISprite & {\n    text?: string;\n    fontName?: string;\n    textAlign?: TextAlign;\n    fontColor?: Color;\n    fontSize?: number;\n    lineHeight?: number;\n    fontStyle?: FontStyle;\n    fontWeight?: FontWeight;\n    strokeColor?: Color;\n    strokeWidth?: number;\n    wordWrap?: boolean;\n}\n\nexport class TextLabel extends Sprite<ITextLabel> {\n\n    textAlign: TextAlign = 'center';\n    strokeColor: Color;\n    strokeWidth: number;\n    fontColor: Color = 0x000;\n\n    protected _wordWrap: boolean = true;\n    protected _fontName: string = 'sans-serif';\n    protected _lineHeight: number;\n    protected _fontSize: number = DefaultFontSize;\n    protected _fontWeight: FontWeight = 'normal';\n    protected _fontStyle: FontStyle = 'normal';\n\n    protected _lines: { width: number; text: string; }[] = [];\n    protected _text: string;\n\n    constructor(props?: ITextLabel) {\n        super();\n\n        props && this.setProps(props);\n    }\n\n    set width(value: number) {\n        if (this._width === value) {\n            return;\n        }\n\n        this._width = value;\n        this._originPixelX = this._width * this._originX;\n\n        if (this.left != null || this.right != null) {\n            this._reCalcX();\n        }\n        else {\n            this._adjustAlignX();\n        }\n\n        this._reMeasureText();\n    }\n\n    get width() {\n        return this._width;\n    }\n\n    set height(value: number) {\n        if (this._height === value) {\n            return;\n        }\n\n        this._height = value;\n        this._originPixelY = this._height * this._originY;\n\n        if (this.top != null || this.bottom != null) {\n            this._reCalcY();\n        }\n        else {\n            this._adjustAlignY();\n        }\n    }\n\n    get height() {\n        return this._height;\n    }\n\n    set fontSize(value: number) {\n        if (this._fontSize != value) {\n            this._fontSize = value;\n            if (this._lineHeight == null) {\n                this._lineHeight = value;\n            }\n            this._reMeasureText();\n        }\n    }\n\n    get fontSize() {\n        return this._fontSize;\n    }\n\n    set fontName(value: string) {\n        if (this._fontName != value) {\n            this._fontName = value;\n            this._reMeasureText();\n        }\n    }\n\n    get fontName() {\n        return this._fontName;\n    }\n\n    set fontStyle(value: FontStyle) {\n        if (this._fontStyle != value) {\n            this._fontStyle = value;\n            this._reMeasureText();\n        }\n    }\n\n    get fontStyle() {\n        return this._fontStyle;\n    }\n\n    set fontWeight(value: FontWeight) {\n        if (this._fontWeight != value) {\n            this._fontWeight = value;\n            this._reMeasureText();\n        }\n    }\n\n    get fontWeight() {\n        return this._fontWeight;\n    }\n\n    get lineHeight() {\n        return this._lineHeight == null ? this._fontSize : this._lineHeight;\n    }\n\n    set lineHeight(value: number) {\n        if (this._lineHeight != value) {\n            this._lineHeight = value;\n            this._reMeasureText();\n        }\n    }\n\n    set wordWrap(value: boolean) {\n        if (this._wordWrap !== value) {\n            this._wordWrap = value;\n            this._reMeasureText();\n        }\n    }\n\n    get wordWrap() {\n        return this._wordWrap;\n    }\n\n    set text(content: string) {\n        if (this._text !== content) {\n            this._text = content;\n            this._reMeasureText();\n        }\n    }\n\n    get text(): string {\n        return this._text;\n    }\n\n    private _reMeasureText(): void {\n        if (!this._text || this.width <= 0) {\n            return;\n        }\n        if (!this.wordWrap) {\n            this.height = this.lineHeight;\n            this._lines = [{\n                text: this._text || \"\",\n                width: this._width,\n            }];\n            return;\n        }\n        let res = measureText(this._text, this.width, {\n            style: this.fontStyle,\n            name: this.fontName,\n            weight: this.fontWeight,\n        }, this.fontSize, this.lineHeight);\n\n        this._lines = res.lines;\n        this.height = res.height;\n    }\n\n    addChild(target: any): void {\n        if (Array.isArray(target)) {\n            this.text += target.join(\"\");\n        }\n        else {\n            this.text += String(target);\n        }\n    }\n\n    addChildren(...children: any[]) {\n\n    }\n\n    protected draw(context: CanvasRenderingContext2D): void {\n        super.draw(context);\n\n        if (!this._lines || this._lines.length === 0) {\n            return;\n        }\n\n        const { strokeWidth, strokeColor, textAlign, lineHeight, _originPixelX, _originPixelY, fontSize, fontWeight, fontStyle, fontName, fontColor, width } = this;\n\n        context.font = fontStyle + ' ' + fontWeight + ' ' + fontSize + 'px ' + fontName;\n        context.fillStyle = convertColor(fontColor);\n        context.textAlign = textAlign;\n        context.textBaseline = 'middle';\n        context.lineJoin = 'round';\n\n        if (strokeColor != null) {\n            context.strokeStyle = convertColor(strokeColor || 0x000);\n            context.lineWidth = (strokeWidth || 1) * 2;\n        }\n\n        var x = textAlign === 'left' ? -_originPixelX : textAlign === 'center' ? 0 : width - _originPixelX;\n        var y = -_originPixelY + lineHeight * 0.5;\n\n        this._lines.forEach((line) => {\n            if (line.text.length > 0) {\n                if (strokeColor != null) {\n                    context.strokeText(line.text, x, y);\n                }\n                context.fillText(line.text, x, y);\n            }\n            y += lineHeight;\n        });\n    }\n}\n","import { Texture } from '../Texture';\nimport { Sprite, ISprite } from './Sprite';\nimport { TextAlign } from './TextLabel';\n\nexport type IBMFontLabel = ISprite & {\n    textureMap: { [word: string]: Texture };\n    text?: string;\n    textAlign?: TextAlign;\n    wordWrap?: boolean;\n    wordSpace?: number;\n    lineHeight?: number;\n    fontSize?: number;\n}\n\nexport class BMFontLabel extends Sprite<IBMFontLabel> {\n\n    protected _lineHeight: number = 5;\n    protected _wordSpace: number = 0;\n    protected _fontSize: number = 0;\n    protected _textAlign: TextAlign = \"center\";\n    protected _wordWrap: boolean = true;\n    protected _text: string = \"\";\n    protected _textureMap: { [word: string]: Texture };\n\n    protected _lines: { width: number; words: Texture[] }[] = [];\n    protected _autoResize: boolean = true;\n\n    constructor(props?: IBMFontLabel) {\n        super();\n        props && this.setProps(props);\n    }\n\n    get autoResize() {\n        return this._autoResize;\n    }\n\n    set autoResize(value: boolean) {\n        if (this._autoResize !== value) {\n            this._autoResize = value;\n            if (value && this._lines.length) {\n                this.height = this._lines.length * this.lineHeight;\n            }\n        }\n    }\n\n    set text(text: string) {\n        if (text === this._text) {\n            return;\n        }\n        this._text = text;\n        this._reMeasureText();\n    }\n    get text() {\n        return this._text;\n    }\n\n    get textureMap() {\n        return this._textureMap;\n    }\n\n    set textureMap(textureMap: { [word: string]: Texture }) {\n        this._textureMap = textureMap;\n        this._reMeasureText();\n    }\n\n    get textAlign() {\n        return this._textAlign;\n    }\n\n    set textAlign(value: TextAlign) {\n        if (this._textAlign != value) {\n            this._textAlign = value;\n        }\n    }\n\n    get lineHeight() {\n        return this._lineHeight;\n    }\n\n    set lineHeight(value: number) {\n        if (this._lineHeight != value) {\n            this._lineHeight = value;\n            if (this.autoResize && this._lines.length) {\n                this.height = this._lines.length * value;\n            }\n        }\n    }\n\n    get wordSpace() {\n        return this._wordSpace;\n    }\n\n    set wordSpace(value: number) {\n        if (this._wordSpace !== value) {\n            this._wordSpace = value;\n            this._reMeasureText();\n        }\n    }\n\n    set wordWrap(value: boolean) {\n        if (this._wordWrap !== value) {\n            this._wordWrap = value;\n            this._reMeasureText();\n        }\n    }\n\n    get wordWrap() {\n        return this._wordWrap;\n    }\n\n    get fontSize() {\n        return this._fontSize;\n    }\n\n    set fontSize(value: number) {\n        if (this._fontSize !== value) {\n            this._fontSize = value;\n            this._reMeasureText();\n        }\n    }\n\n    get width() {\n        return this._width;\n    }\n\n    set width(value: number) {\n        if (this._width === value) {\n            return;\n        }\n\n        this._width = value;\n        this._originPixelX = this._width * this._originX;\n\n        if (this.left != null || this.right != null) {\n            this._reCalcX();\n        }\n        else {\n            this._adjustAlignX();\n        }\n\n        this._reMeasureText();\n    }\n\n    get height() {\n        return this._height;\n    }\n\n    set height(value: number) {\n        if (this._height === value) {\n            return;\n        }\n        this._height = value;\n        this._originPixelY = this._height * this._originY;\n\n        if (this.top != null || this.bottom != null) {\n            this._reCalcY();\n        }\n        else {\n            this._adjustAlignY();\n        }\n    }\n\n    protected _reMeasureText() {\n        if (!this.textureMap || !this._text) {\n            this._lines.length = 0;\n            return;\n        }\n\n        const { textureMap, text, width, lineHeight, fontSize, wordWrap, wordSpace, _lines } = this;\n\n        _lines.length = 0;\n\n        var words = this._text.split('');\n        var currLine = _lines[0] = { width: 0, words: [] };\n\n        words.forEach(word => {\n            let texture: Texture;\n            if (word === \" \") {\n                texture = null;\n            }\n            else {\n                texture = textureMap[word];\n                if (!texture) {\n                    console.error(`canvas2d.BMFontLabel: Texture of the word \"${word}\" not found.`, this);\n                    texture = null;\n                }\n                if (!texture.ready) {\n                    console.error(`canvas2d.BMFontLabel: Texture of the word \"${word}\" is not ready to use.`, this);\n                    texture = null;\n                }\n            }\n\n            if (!wordWrap || currLine.width + fontSize <= width) {\n                currLine.width += fontSize;\n                currLine.words.push(texture);\n\n                if (currLine.width + wordSpace >= width) {\n                    currLine = _lines[_lines.length] = {\n                        width: 0, words: []\n                    };\n                }\n            }\n            else {\n                currLine = _lines[_lines.length] = {\n                    width: fontSize, words: [texture]\n                };\n            }\n        });\n\n        if (this.autoResize) {\n            this.height = _lines.length * lineHeight;\n        }\n    }\n\n    protected draw(context: CanvasRenderingContext2D) {\n        super.draw(context);\n\n        const { _originPixelX, _originPixelY, _textAlign, fontSize, lineHeight, wordSpace, width } = this;\n\n        let lineSpace = (lineHeight - fontSize) * 0.5;\n        let y: number = -_originPixelY + lineSpace;\n\n        this._lines.forEach((line, i) => {\n            let x: number;\n\n            if (_textAlign === \"right\") {\n                x = width - line.width - _originPixelX;\n            }\n            else if (_textAlign == \"center\") {\n                x = (width - line.width) * 0.5 - _originPixelX;\n            }\n            else {\n                x = -_originPixelX;\n            }\n\n            line.words.forEach((word, j) => {\n                if (word) {\n                    context.drawImage(word.source, 0, 0, word.width, word.height, x, y, fontSize, fontSize);\n                }\n                x += fontSize + wordSpace;\n            });\n\n            y += lineHeight;\n        });\n    }\n\n    addChild(target: any) {\n        this._text = (this._text || \"\") + target;\n    }\n\n    addChildren(...children: any[]) {\n        this._text = (this._text || \"\") + children.join(\"\");\n    }\n\n}\n","import { Sprite, ISprite } from './sprite/Sprite';\nimport { TextLabel, ITextLabel } from './sprite/TextLabel';\nimport { BMFontLabel, IBMFontLabel } from './sprite/BMFontLabel';\nimport { Stage, ScaleMode, Orientation } from './Stage';\nimport { Texture } from './Texture';\nimport { Action, ActionQueue } from './action/Action';\n\nexport interface Ref<T> {\n    ref?(instance: T): any;\n}\nexport type ActionProps = { actions?: ActionQueue[] };\n\nexport type SpriteProps = ISprite & Ref<Sprite<{}>> & ActionProps;\nexport type TextProps = ITextLabel & Ref<TextLabel> & ActionProps;\nexport type BMFontProps = IBMFontLabel & Ref<BMFontLabel> & ActionProps;\nexport type SpriteClass<T, U> = new (attrs?: T & ISprite) => U;\nexport type StageProps = {\n    width: number;\n    height: number;\n    canvas: HTMLCanvasElement;\n    scaleMode: ScaleMode;\n    autoAdjustCanvasSize?: boolean;\n    orientation?: Orientation;\n    touchEnabled?: boolean;\n    mouseEnabled?: boolean;\n    useExternalTimer?: boolean;\n} & Ref<Stage>;\n\nexport function createSprite<T, U>(type: \"sprite\", props: SpriteProps, ...children: any[]): Sprite<{}>;\nexport function createSprite<T, U>(type: \"text\", props: TextProps, ...children: any[]): TextLabel;\nexport function createSprite<T, U>(type: \"bmfont\", props: BMFontProps, ...children: any[]): BMFontLabel;\nexport function createSprite<T, U>(type: \"stage\", props: StageProps, ...children: any[]): Stage;\nexport function createSprite<T, U>(type: SpriteClass<T, U>, props: T & SpriteProps, ...children: any[]): U;\nexport function createSprite<T, U>(type: any, props: any, ...children: any[]): any {\n    props = props || {};\n\n    let sprite: any;\n    let { ref, actions, ...options } = props;\n\n    if (typeof type === 'function') {\n        sprite = new type(options) as Sprite<any>;\n        addChildren(sprite, children);\n    }\n    else {\n        switch (type) {\n            case \"sprite\":\n                sprite = new Sprite(options);\n                addChildren(sprite, children);\n                break;\n            case \"text\":\n                sprite = createLabel<TextLabel>(type, TextLabel, options, children);\n                break;\n            case \"bmfont\":\n                sprite = createLabel<BMFontLabel>(type, BMFontLabel, options, children);\n                break;\n            case 'stage':\n                sprite = createStage(options, children);\n                break;\n        }\n    }\n\n    if (sprite == null) {\n        console.error(`canvas2d.createSprite(): Unknown sprite type`, type);\n    }\n    else if (actions && actions.length) {\n        (<ActionQueue[]>actions).forEach(queue => {\n            new Action(sprite).queue(queue).start();\n        });\n    }\n\n    if (ref) {\n        ref.call(undefined, sprite);\n    }\n\n    return sprite;\n}\n\nfunction createLabel<T>(tag: string, ctor: any, props: any, children: any[]): T {\n    let sprite = new ctor(props);\n    if (children.length) {\n        sprite.text = children.join('');\n    }\n    return sprite\n}\n\nfunction createStage(props: StageProps, children: Sprite<any>[]) {\n    let { canvas, width, height, scaleMode, autoAdjustCanvasSize, useExternalTimer, touchEnabled, mouseEnabled, orientation } = props;\n    let stage = new Stage(canvas, width, height, scaleMode, autoAdjustCanvasSize, orientation);\n\n    stage.touchEnabled = touchEnabled;\n    stage.mouseEnabled = mouseEnabled;\n    stage.start(useExternalTimer);\n\n    if (children.length) {\n        children.forEach(child => child && stage.addChild(child));\n    }\n\n    return stage;\n}\n\nfunction addChildren(sprite: Sprite<any>, children: any[]) {\n    if (!children.length) {\n        return;\n    }\n    children.forEach(child => {\n        if (!child) {\n            return;\n        }\n        if (Array.isArray(child)) {\n            addChildren(sprite, child);\n        }\n        else {\n            sprite.addChild(child);\n        }\n    });\n}\n","import { EventEmitter } from '../EventEmitter';\n\nexport class HTMLAudio extends EventEmitter {\n\n    static enabled: boolean = false;\n\n    private _audioNode: HTMLAudioElement;\n    private _isLoading: boolean;\n\n    src: string;\n    loop: boolean = false;\n    muted: boolean = false;\n    loaded: boolean = false;\n    volume: number = 1;\n    playing: boolean = false;\n    autoplay: boolean = false;\n    duration: number = 0;\n    currentTime: number = 0;\n\n    constructor(src: string) {\n        super();\n\n        this.src = src;\n        this._handleEvent = this._handleEvent.bind(this);\n    }\n\n    load() {\n        if (this.loaded || this._isLoading) {\n            return;\n        }\n\n        let audioNode = this._audioNode = new Audio();\n        audioNode.addEventListener('canplaythrough', this._handleEvent, false);\n        audioNode.addEventListener('ended', this._handleEvent, false);\n        audioNode.addEventListener('error', this._handleEvent, false);\n\n        audioNode.preload = \"auto\";\n        audioNode['autobuffer'] = true;\n        audioNode.setAttribute('src', this.src);\n        audioNode.volume = this.volume;\n        audioNode.load();\n    }\n\n    play() {\n        if (!HTMLAudio.enabled) {\n            return;\n        }\n        if (this.playing) {\n            this.stop();\n        }\n\n        if (this.loaded) {\n            this._play();\n        }\n        else if (!this._isLoading) {\n            this.autoplay = true;\n            this.load();\n        }\n    }\n\n    pause() {\n        if (this.playing) {\n            this._audioNode.pause();\n            this.currentTime = this._audioNode.currentTime;\n            this.playing = false;\n        }\n    }\n\n    resume() {\n        if (!this.playing && HTMLAudio.enabled) {\n            this.play();\n        }\n    }\n\n    stop() {\n        if (this.playing) {\n            this._audioNode.pause();\n            this._audioNode.currentTime = this.currentTime = 0;\n            this.playing = false;\n        }\n    }\n\n    setMute(muted: boolean) {\n        if (this.muted != muted) {\n            this.muted = muted;\n            if (this._audioNode) {\n                this._audioNode.volume = muted ? 0 : this.volume;\n            }\n        }\n    }\n\n    setVolume(volume: number) {\n        if (this.volume != volume) {\n            this.volume = volume;\n            if (this._audioNode) {\n                this._audioNode.volume = volume;\n            }\n        }\n    }\n\n    clone() {\n        let cloned = new HTMLAudio(this.src);\n\n        if (this.loaded) {\n            cloned._audioNode = <HTMLAudioElement>this._audioNode.cloneNode(true);\n            cloned.loaded = true;\n            cloned.duration = this.duration;\n        }\n\n        return cloned;\n    }\n\n    private _handleEvent(e: Event) {\n        let type = e.type;\n\n        switch (type) {\n            case 'canplaythrough':\n                e.target.removeEventListener('canplaythrough', this._handleEvent, false);\n\n                this.loaded = true;\n                this.duration = this._audioNode.duration;\n                this.emit('load');\n\n                if (this.autoplay) {\n                    this.play();\n                }\n                break;\n            case 'ended':\n                this.playing = false;\n                this.currentTime = 0;\n                this.emit('ended');\n\n                if (this.loop) {\n                    this.play();\n                }\n                break;\n        }\n    }\n\n    private _play() {\n        if (!this.playing) {\n            this._audioNode.volume = this.muted ? 0 : this.volume;\n            this._audioNode.play();\n            this.playing = true;\n        }\n    }\n}","import { EventEmitter } from '../EventEmitter';\n\nvar AudioCtx = window['AudioContext'] || window['webkitAudioContext'];\nvar context: AudioContext = AudioCtx ? new AudioCtx() : null;\n\nexport class WebAudio extends EventEmitter {\n\n    static isSupported: boolean = AudioCtx != null;\n\n    private static _initialized: boolean = false;\n    private static _enabled: boolean = false;\n\n    static set enabled(enabled: boolean) {\n        if (enabled && this.isSupported && !this._initialized) {\n            let source = context.createBufferSource();\n            source.buffer = context.createBuffer(1, 1, 22050);\n            source.connect(context.destination);\n            source.start ? source.start(0, 0, 0) : source['noteOn'](0, 0, 0);\n            this._initialized = true;\n        }\n        this._enabled = enabled;\n    }\n    static get enabled() {\n        return this._enabled;\n    }\n\n    private _gainNode: GainNode;\n    private _audioNode: AudioBufferSourceNode;\n    private _buffer: AudioBuffer;\n    private _startTime: number = 0;\n    private _isLoading: boolean;\n\n    src: string;\n    loop: boolean = false;\n    muted: boolean = false;\n    loaded: boolean = false;\n    volume: number = 1;\n    playing: boolean = false;\n    autoplay: boolean = false;\n    duration: number = 0;\n    currentTime: number = 0;\n\n    constructor(src: string) {\n        super();\n\n        this.src = src;\n        this._handleEvent = this._handleEvent.bind(this);\n        this._gainNode = context.createGain ? context.createGain() : context['createGainNode']();\n        this._gainNode.connect(context.destination);\n    }\n\n    load() {\n        if (this._isLoading || this.loaded) {\n            return;\n        }\n\n        let request = new XMLHttpRequest();\n        request.onprogress = request.onload = request.onerror = this._handleEvent;\n        request.open('GET', this.src, true);\n        request.responseType = 'arraybuffer';\n        request.send();\n\n        this._isLoading = true;\n    }\n\n    play() {\n        if (!WebAudio.enabled) {\n            return;\n        }\n\n        if (this.playing) {\n            this.stop();\n        }\n\n        if (this.loaded) {\n            this._play();\n        }\n        else if (!this._buffer) {\n            this.autoplay = true;\n            this.load();\n        }\n    }\n\n    pause() {\n        if (this.playing) {\n            this._audioNode.stop();\n            this.currentTime += context.currentTime - this._startTime;\n            this.playing = false;\n        }\n    }\n\n    resume() {\n        if (!this.playing && WebAudio.enabled) {\n            this._play();\n        }\n    }\n\n    stop() {\n        if (this.playing) {\n            this._audioNode.stop(0);\n            this._audioNode.disconnect();\n            this.currentTime = 0;\n            this.playing = false;\n        }\n    }\n\n    setMute(muted: boolean) {\n        if (this.muted != muted) {\n            this.muted = muted;\n            this._gainNode.gain.value = muted ? 0 : this.volume;\n        }\n    }\n\n    setVolume(volume: number) {\n        if (this.volume != volume) {\n            this.volume = volume;\n            this._gainNode.gain.value = volume;\n        }\n    }\n\n    clone() {\n        let cloned = new WebAudio(this.src);\n\n        if (this._isLoading) {\n            cloned._isLoading = true;\n            let onLoad = () => {\n                cloned._onDecodeCompleted(this._buffer);\n                this.removeListener(\"load\", onload);\n            };\n            this.on('load', onload);\n        }\n        else if (this.loaded) {\n            cloned._onDecodeCompleted(this._buffer);\n        }\n\n        return cloned;\n    }\n\n    private _handleEvent(e: Event) {\n        let type = e.type;\n        switch (type) {\n            case 'load':\n                let request: XMLHttpRequest = <any>e.target;\n                request.onload = request.onprogress = request.onerror = null;\n                context.decodeAudioData(request.response, (buffer) => this._onDecodeCompleted(buffer), () => this.emit('error'));\n                request = null;\n                break;\n            case 'ended':\n                if (this.playing) {\n                    // play ended, not paused\n                    this.currentTime = 0;\n                    this.playing = false;\n                    this.emit('ended');\n                    if (this.loop) {\n                        this.play();\n                    }\n                }\n                break;\n            default:\n                this.emit(type, e);\n                break;\n        }\n    }\n\n    private _onDecodeCompleted(buffer: AudioBuffer) {\n        this._buffer = buffer;\n        this._isLoading = false;\n        this.loaded = true;\n        this.duration = buffer.duration;\n        this.emit('load');\n        if (this.autoplay) {\n            this.play();\n        }\n    }\n\n    private _play() {\n        this._clearAudioNode();\n\n        let audioNode = context.createBufferSource();\n\n        if (!audioNode.start) {\n            audioNode.start = audioNode['noteOn'];\n            audioNode.stop = audioNode['noteOff'];\n        }\n\n        this._gainNode.gain.value = this.muted ? 0 : this.volume;\n\n        audioNode.buffer = this._buffer;\n        audioNode.onended = this._handleEvent;\n        audioNode.connect(this._gainNode);\n        audioNode.start(0, this.currentTime);\n\n        this._audioNode = audioNode;\n        this._startTime = context.currentTime;\n        this.playing = true;\n    }\n\n    private _clearAudioNode() {\n        let audioNode = this._audioNode;\n\n        if (audioNode) {\n            audioNode.onended = null;\n            audioNode.disconnect(0);\n            this._audioNode = null;\n        }\n    }\n}","﻿import { uid, removeArrayItem } from '../Util';\nimport { HTMLAudio } from './HTMLAudio';\nimport { WebAudio } from './WebAudio';\n\nexport class SoundManager {\n\n    private _ext: \".mp3\" | \".mp4\" | \".wav\" | \".ogg\" = \".mp3\";\n    private _enabled: boolean;\n    private _pausedAudios: { [id: number]: WebAudio | HTMLAudio };\n    private _audioCache: { [index: string]: Array<WebAudio | HTMLAudio> } = {};\n    private _supportedType = {\n        mp3: false,\n        mp4: false,\n        wav: false,\n        ogg: false\n    };\n\n    get enabled() {\n        return this._enabled;\n    }\n\n    set enabled(value: boolean) {\n        if (value == this._enabled) {\n            return;\n        }\n        this._setEnabled(value);\n    }\n\n    get supportedType(): { mp3: boolean; mp4: boolean; wav: boolean; ogg: boolean; } {\n        return { ...this._supportedType };\n    }\n\n    get ext() {\n        return this._ext;\n    }\n\n    set ext(ext) {\n        this._ext = ext;\n    }\n\n    constructor() {\n        this._detectSupportedType();\n    }\n\n    getAudio(name: string): WebAudio | HTMLAudio;\n    getAudio(name: string, returnAll: boolean): Array<WebAudio | HTMLAudio>;\n    getAudio(name: string, returnAll?: boolean): any {\n        var list = this._audioCache[name];\n\n        if (!list || !list.length) {\n            return returnAll ? [] : null;\n        }\n\n        var i: number = 0;\n        var all: Array<WebAudio | HTMLAudio> = [];\n        var audio: WebAudio | HTMLAudio;\n\n        for (; audio = list[i]; i++) {\n            if (!audio.playing) {\n                if (!returnAll) {\n                    return audio;\n                }\n                all.push(audio);\n            }\n        }\n\n        return returnAll ? all : all[0];\n    }\n\n    load(baseUri: string, name: string, onComplete: () => any, channels = 1) {\n        var src = baseUri + name + this._ext;\n        var audio = WebAudio.isSupported ? new WebAudio(src) : new HTMLAudio(src);\n\n        audio.on('load', () => {\n            if (onComplete) {\n                onComplete();\n            }\n\n            var cloned;\n            while (--channels > 0) {\n                cloned = audio.clone();\n                this._audioCache[name].push(cloned);\n            }\n        });\n        audio.on('error', (e: ErrorEvent) => {\n            console.warn(\"canvas2d.Sound.load() Error: \" + src + \" could not be loaded.\");\n            removeArrayItem(this._audioCache[name], audio);\n        });\n\n        if (!this._audioCache[name]) {\n            this._audioCache[name] = [];\n        }\n        this._audioCache[name].push(audio);\n\n        audio.load();\n    }\n\n    /**\n     * Load multiple sound resources\n     */\n    loadList(baseUri: string, resources: { name: string; channels?: number; }[], onAllCompleted?: () => any, onProgress?: (percent: number) => any) {\n        let totalCount = resources.length;\n        let endedCount = 0;\n\n        let onCompleted = () => {\n            ++endedCount;\n\n            if (onProgress) {\n                onProgress(endedCount / totalCount);\n            }\n            if (endedCount === totalCount && onAllCompleted) {\n                onAllCompleted();\n            }\n        }\n\n        resources.forEach(res => this.load(baseUri, res.name, onCompleted, res.channels));\n    }\n\n    /**\n     * Get all audioes by name\n     */\n    getAllAudioes(name: string): Array<WebAudio | HTMLAudio> {\n        return this._audioCache[name] && this._audioCache[name].slice();\n    }\n\n    /**\n     * Play sound by name\n     */\n    play(name: string, loop: boolean = false): WebAudio | HTMLAudio {\n        var audio = this._enabled && this.getAudio(name);\n\n        if (audio) {\n            audio.loop = loop;\n            audio.play();\n        }\n        return audio;\n    }\n\n    /**\n     * Pause sound by name\n     */\n    pause(name: string): void {\n        let list = this.getAllAudioes(name);\n\n        if (list) {\n            list.forEach(audio => audio.pause());\n        }\n    }\n\n    /**\n     * Stop sound by name\n     */\n    stop(name: string): void {\n        let list = this._audioCache[name];\n\n        if (list) {\n            list.forEach(audio => audio.stop());\n        }\n    }\n\n    /**\n     * Resume audio by name\n     */\n    resume(name: string): void {\n        let list = this._audioCache[name];\n        if (list) {\n            list.forEach(audio => !audio.playing && audio.currentTime > 0 && audio.resume());\n        }\n    }\n\n    private _setEnabled(value: boolean) {\n        if (value) {\n            WebAudio.enabled = true;\n            HTMLAudio.enabled = true;\n\n            if (this._pausedAudios) {\n                Object.keys(this._pausedAudios).forEach(id => {\n                    this._pausedAudios[id].resume();\n                });\n                this._pausedAudios = null;\n            }\n        }\n        else {\n            WebAudio.enabled = false;\n            HTMLAudio.enabled = false;\n\n            this._pausedAudios = {};\n            Object.keys(this._audioCache).forEach(name => {\n                this._audioCache[name].forEach(audio => {\n                    if (audio.playing) {\n                        audio.pause();\n                        this._pausedAudios[uid(audio)] = audio;\n                    }\n                });\n            });\n        }\n\n        this._enabled = value;\n    }\n\n    private _detectSupportedType() {\n        var aud = new Audio();\n        var reg = /maybe|probably/i;\n        var mts = {\n            mp3: 'audio/mpeg',\n            mp4: 'audio/mp4; codecs=\"mp4a.40.5\"',\n            wav: 'audio/x-wav',\n            ogg: 'audio/ogg; codecs=\"vorbis\"'\n        };\n\n        for (var name in mts) {\n            this._supportedType[name] = reg.test(aud.canPlayType(mts[name]));\n        }\n\n        aud = null;\n    }\n}\n\nexport const Sound = new SoundManager();\n"],"names":["tslib_1.__extends","ActionType","ActionRepeatMode","AlignType","Orientation","ScaleMode","getCacheKey"],"mappings":"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"}