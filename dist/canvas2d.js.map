{"version":3,"file":null,"sources":["../src/Keys.ts","../src/Tween.ts","../src/Texture.ts","../src/action/Delay.ts","../src/action/Callback.ts","../src/action/Animation.ts","../src/Util.ts","../src/action/ActionListener.ts","../src/action/Transition.ts","../src/action/Action.ts","../src/EventEmitter.ts","../src/ReleasePool.ts","../src/sprite/Sprite.ts","../src/UIEvent.ts","../src/Stage.ts","../src/sprite/TextLabel.ts","../src/sprite/BMFontLabel.ts","../src/createSprite.ts","../src/sound/HTMLAudio.ts","../src/sound/WebAudio.ts","../src/sound/Sound.ts"],"sourcesContent":["﻿export const Keys = {\r\n    MOUSE_LEFT: 1,\r\n    MOUSE_MID: 2,\r\n    MOUSE_RIGHT: 3,\r\n\r\n    BACKSPACE: 8,\r\n    TAB: 9,\r\n    NUM_CENTER: 12,\r\n    ENTER: 13,\r\n    RETURN: 13,\r\n    SHIFT: 16,\r\n    CTRL: 17,\r\n    ALT: 18,\r\n    PAUSE: 19,\r\n    CAPS_LOCK: 20,\r\n    ESC: 27,\r\n    ESCAPE: 27,\r\n    SPACE: 32,\r\n    PAGE_UP: 33,\r\n    PAGE_DOWN: 34,\r\n    END: 35,\r\n    HOME: 36,\r\n    LEFT: 37,\r\n    UP: 38,\r\n    RIGHT: 39,\r\n    DOWN: 40,\r\n    PRINT_SCREEN: 44,\r\n    INSERT: 45,\r\n    DELETE: 46,\r\n\r\n    ZERO: 48,\r\n    ONE: 49,\r\n    TWO: 50,\r\n    THREE: 51,\r\n    FOUR: 52,\r\n    FIVE: 53,\r\n    SIX: 54,\r\n    SEVEN: 55,\r\n    EIGHT: 56,\r\n    NINE: 57,\r\n\r\n    A: 65,\r\n    B: 66,\r\n    C: 67,\r\n    D: 68,\r\n    E: 69,\r\n    F: 70,\r\n    G: 71,\r\n    H: 72,\r\n    I: 73,\r\n    J: 74,\r\n    K: 75,\r\n    L: 76,\r\n    M: 77,\r\n    N: 78,\r\n    O: 79,\r\n    P: 80,\r\n    Q: 81,\r\n    R: 82,\r\n    S: 83,\r\n    T: 84,\r\n    U: 85,\r\n    V: 86,\r\n    W: 87,\r\n    X: 88,\r\n    Y: 89,\r\n    Z: 90,\r\n\r\n    CONTEXT_MENU: 93,\r\n    NUM0: 96,\r\n    NUM1: 97,\r\n    NUM2: 98,\r\n    NUM3: 99,\r\n    NUM4: 100,\r\n    NUM5: 101,\r\n    NUM6: 102,\r\n    NUM7: 103,\r\n    NUM8: 104,\r\n    NUM9: 105,\r\n    NUM_MULTIPLY: 106,\r\n    NUM_PLUS: 107,\r\n    NUM_MINUS: 109,\r\n    NUM_PERIOD: 110,\r\n    NUM_DIVISION: 111,\r\n    F1: 112,\r\n    F2: 113,\r\n    F3: 114,\r\n    F4: 115,\r\n    F5: 116,\r\n    F6: 117,\r\n    F7: 118,\r\n    F8: 119,\r\n    F9: 120,\r\n    F10: 121,\r\n    F11: 122,\r\n    F12: 123\r\n};","﻿export type EasingFunc = (percent: number, ...args: any[]) => number;\r\n\r\nexport const Tween = {\r\n    easeInQuad(pos) {\r\n        return Math.pow(pos, 2);\r\n    },\r\n\r\n    easeOutQuad(pos) {\r\n        return -(Math.pow((pos - 1), 2) - 1);\r\n    },\r\n\r\n    easeInOutQuad(pos) {\r\n        if ((pos /= 0.5) < 1) {\r\n            return 0.5 * Math.pow(pos, 2);\r\n        }\r\n        return -0.5 * ((pos -= 2) * pos - 2);\r\n    },\r\n\r\n    easeInCubic(pos) {\r\n        return Math.pow(pos, 3);\r\n    },\r\n\r\n    easeOutCubic(pos) {\r\n        return (Math.pow((pos - 1), 3) + 1);\r\n    },\r\n\r\n    easeInOutCubic(pos) {\r\n        if ((pos /= 0.5) < 1) {\r\n            return 0.5 * Math.pow(pos, 3);\r\n        }\r\n        return 0.5 * (Math.pow((pos - 2), 3) + 2);\r\n    },\r\n\r\n    easeInQuart(pos) {\r\n        return Math.pow(pos, 4);\r\n    },\r\n\r\n    easeOutQuart(pos) {\r\n        return -(Math.pow((pos - 1), 4) - 1)\r\n    },\r\n\r\n    easeInOutQuart(pos) {\r\n        if ((pos /= 0.5) < 1)\r\n            return 0.5 * Math.pow(pos, 4);\r\n        return -0.5 * ((pos -= 2) * Math.pow(pos, 3) - 2);\r\n    },\r\n\r\n    easeInQuint(pos) {\r\n        return Math.pow(pos, 5);\r\n    },\r\n\r\n    easeOutQuint(pos) {\r\n        return (Math.pow((pos - 1), 5) + 1);\r\n    },\r\n\r\n    easeInOutQuint(pos) {\r\n        if ((pos /= 0.5) < 1) {\r\n            return 0.5 * Math.pow(pos, 5);\r\n        }\r\n        return 0.5 * (Math.pow((pos - 2), 5) + 2);\r\n    },\r\n\r\n    easeInSine(pos) {\r\n        return -Math.cos(pos * (Math.PI / 2)) + 1;\r\n    },\r\n\r\n    easeOutSine(pos) {\r\n        return Math.sin(pos * (Math.PI / 2));\r\n    },\r\n\r\n    easeInOutSine(pos) {\r\n        return (-.5 * (Math.cos(Math.PI * pos) - 1));\r\n    },\r\n\r\n    easeInExpo(pos) {\r\n        return (pos == 0) ? 0 : Math.pow(2, 10 * (pos - 1));\r\n    },\r\n\r\n    easeOutExpo(pos) {\r\n        return (pos == 1) ? 1 : -Math.pow(2, -10 * pos) + 1;\r\n    },\r\n\r\n    easeInOutExpo(pos) {\r\n        if (pos == 0)\r\n            return 0;\r\n        if (pos == 1)\r\n            return 1;\r\n        if ((pos /= 0.5) < 1)\r\n            return 0.5 * Math.pow(2, 10 * (pos - 1));\r\n        return 0.5 * (-Math.pow(2, -10 * --pos) + 2);\r\n    },\r\n\r\n    easeInCirc(pos) {\r\n        return -(Math.sqrt(1 - (pos * pos)) - 1);\r\n    },\r\n\r\n    easeOutCirc(pos) {\r\n        return Math.sqrt(1 - Math.pow((pos - 1), 2))\r\n    },\r\n\r\n    easeInOutCirc(pos) {\r\n        if ((pos /= 0.5) < 1)\r\n            return -0.5 * (Math.sqrt(1 - pos * pos) - 1);\r\n        return 0.5 * (Math.sqrt(1 - (pos -= 2) * pos) + 1);\r\n    },\r\n\r\n    easeOutBounce(pos) {\r\n        if ((pos) < (1 / 2.75)) {\r\n            return (7.5625 * pos * pos);\r\n        }\r\n        else if (pos < (2 / 2.75)) {\r\n            return (7.5625 * (pos -= (1.5 / 2.75)) * pos + .75);\r\n        }\r\n        else if (pos < (2.5 / 2.75)) {\r\n            return (7.5625 * (pos -= (2.25 / 2.75)) * pos + .9375);\r\n        }\r\n        else {\r\n            return (7.5625 * (pos -= (2.625 / 2.75)) * pos + .984375);\r\n        }\r\n    },\r\n\r\n    easeInBack(pos) {\r\n        var s = 1.70158;\r\n        return (pos) * pos * ((s + 1) * pos - s);\r\n    },\r\n\r\n    easeOutBack(pos) {\r\n        var s = 1.70158;\r\n        return (pos = pos - 1) * pos * ((s + 1) * pos + s) + 1;\r\n    },\r\n\r\n    easeInOutBack(pos) {\r\n        var s = 1.70158;\r\n        if ((pos /= 0.5) < 1)\r\n            return 0.5 * (pos * pos * (((s *= (1.525)) + 1) * pos - s));\r\n        return 0.5 * ((pos -= 2) * pos * (((s *= (1.525)) + 1) * pos + s) + 2);\r\n    },\r\n\r\n    elastic(pos) {\r\n        return -1 * Math.pow(4, -8 * pos) * Math.sin((pos * 6 - 1) * (2 * Math.PI) / 2) + 1;\r\n    },\r\n\r\n    swingFromTo(pos) {\r\n        var s = 1.70158;\r\n        return ((pos /= 0.5) < 1) ? 0.5 * (pos * pos * (((s *= (1.525)) + 1) * pos - s)) :\r\n            0.5 * ((pos -= 2) * pos * (((s *= (1.525)) + 1) * pos + s) + 2);\r\n    },\r\n\r\n    swingFrom(pos) {\r\n        var s = 1.70158;\r\n        return pos * pos * ((s + 1) * pos - s);\r\n    },\r\n\r\n    swingTo(pos) {\r\n        var s = 1.70158;\r\n        return (pos -= 1) * pos * ((s + 1) * pos + s) + 1;\r\n    },\r\n\r\n    bounce(pos) {\r\n        if (pos < (1 / 2.75)) {\r\n            return (7.5625 * pos * pos);\r\n        }\r\n        else if (pos < (2 / 2.75)) {\r\n            return (7.5625 * (pos -= (1.5 / 2.75)) * pos + .75);\r\n        }\r\n        else if (pos < (2.5 / 2.75)) {\r\n            return (7.5625 * (pos -= (2.25 / 2.75)) * pos + .9375);\r\n        }\r\n        else {\r\n            return (7.5625 * (pos -= (2.625 / 2.75)) * pos + .984375);\r\n        }\r\n    },\r\n\r\n    bouncePast(pos) {\r\n        if (pos < (1 / 2.75)) {\r\n            return (7.5625 * pos * pos);\r\n        }\r\n        else if (pos < (2 / 2.75)) {\r\n            return 2 - (7.5625 * (pos -= (1.5 / 2.75)) * pos + .75);\r\n        }\r\n        else if (pos < (2.5 / 2.75)) {\r\n            return 2 - (7.5625 * (pos -= (2.25 / 2.75)) * pos + .9375);\r\n        }\r\n        else {\r\n            return 2 - (7.5625 * (pos -= (2.625 / 2.75)) * pos + .984375);\r\n        }\r\n    },\r\n\r\n    easeFromTo(pos) {\r\n        if ((pos /= 0.5) < 1)\r\n            return 0.5 * Math.pow(pos, 4);\r\n        return -0.5 * ((pos -= 2) * Math.pow(pos, 3) - 2);\r\n    },\r\n\r\n    easeFrom(pos) {\r\n        return Math.pow(pos, 4);\r\n    },\r\n\r\n    easeTo(pos) {\r\n        return Math.pow(pos, 0.25);\r\n    },\r\n\r\n    linear(pos) {\r\n        return pos\r\n    },\r\n\r\n    sinusoidal(pos) {\r\n        return (-Math.cos(pos * Math.PI) / 2) + 0.5;\r\n    },\r\n\r\n    reverse(pos) {\r\n        return 1 - pos;\r\n    },\r\n\r\n    mirror(pos, transition) {\r\n        transition = transition || this.sinusoidal;\r\n        if (pos < 0.5)\r\n            return transition(pos * 2);\r\n        else\r\n            return transition(1 - (pos - 0.5) * 2);\r\n    },\r\n\r\n    flicker(pos) {\r\n        var pos = pos + (Math.random() - 0.5) / 5;\r\n        return this.sinusoidal(pos < 0 ? 0 : pos > 1 ? 1 : pos);\r\n    },\r\n\r\n    wobble(pos) {\r\n        return (-Math.cos(pos * Math.PI * (9 * pos)) / 2) + 0.5;\r\n    },\r\n\r\n    pulse(pos, pulses) {\r\n        return (-Math.cos((pos * ((pulses || 5) - .5) * 2) * Math.PI) / 2) + .5;\r\n    },\r\n\r\n    blink(pos, blinks) {\r\n        return Math.round(pos * (blinks || 5)) % 2;\r\n    },\r\n\r\n    spring(pos) {\r\n        return 1 - (Math.cos(pos * 4.5 * Math.PI) * Math.exp(-pos * 6));\r\n    },\r\n\r\n    none(pos) {\r\n        return 0\r\n    },\r\n\r\n    full(pos) {\r\n        return 1\r\n    }\r\n}","﻿var cache: { [index: string]: Texture } = {};\r\nvar loaded: { [index: string]: boolean } = {};\r\nvar loading: { [index: string]: boolean } = {};\r\n\r\nexport type Rect = {\r\n    x: number;\r\n    y: number;\r\n    width: number;\r\n    height: number;\r\n}\r\n\r\n/**\r\n * Sprite texture\r\n */\r\nexport class Texture {\r\n\r\n    private _readyCallbacks: any[] = [];\r\n\r\n    /**\r\n     * Texture resource loading state\r\n     */\r\n    ready: boolean = false;\r\n\r\n    width: number = 0;\r\n    height: number = 0;\r\n\r\n    /**\r\n     * Texture drawable source\r\n     */\r\n    source: HTMLCanvasElement;\r\n\r\n    /**\r\n     * Create a texture by source and clipping rectangle\r\n     * @param  source  Drawable source\r\n     * @param  rect    Clipping rect\r\n     */\r\n    static create(source: string | HTMLCanvasElement | HTMLImageElement, sourceRect?: Rect, textureRect?: Rect): Texture {\r\n        var name = generateTextureName(source, sourceRect, textureRect);\r\n\r\n        if (name && cache[name]) {\r\n            return cache[name];\r\n        }\r\n\r\n        return new Texture(source, sourceRect, textureRect);\r\n    }\r\n\r\n    /**\r\n     * @param  source  Drawable source\r\n     * @param  rect    Clipping rect\r\n     */\r\n    constructor(source: string | HTMLCanvasElement | HTMLImageElement, sourceRect?: Rect, textureRect?: Rect) {\r\n        var name: any = generateTextureName(source, sourceRect, textureRect);\r\n\r\n        if (cache[name]) {\r\n            return cache[name];\r\n        }\r\n\r\n        if (typeof source === 'string') {\r\n            this._createByPath(source, sourceRect, textureRect);\r\n        }\r\n        else if ((source instanceof HTMLImageElement) || (source instanceof HTMLCanvasElement)) {\r\n            this._createByImage(<HTMLImageElement>source, sourceRect, textureRect);\r\n        }\r\n        else {\r\n            throw new Error(\"Invalid texture source\");\r\n        }\r\n\r\n        if (name) {\r\n            cache[name] = this;\r\n        }\r\n    }\r\n\r\n    public onReady(callback: (size: { width: number, height: number }) => any) {\r\n        if (this.ready) {\r\n            callback({ width: this.width, height: this.height });\r\n        }\r\n        else {\r\n            this._readyCallbacks.push(callback);\r\n        }\r\n    }\r\n\r\n    private _createByPath(path: string, sourceRect?: Rect, textureRect?: Rect): void {\r\n        var img: HTMLImageElement = new Image();\r\n\r\n        img.onload = () => {\r\n            this._createByImage(img, sourceRect, textureRect);\r\n\r\n            // if (!loaded[path]) {\r\n            //     console.log(`canvas2d: \"${path}\" loaded.`);\r\n            // }\r\n            loaded[path] = true;\r\n\r\n            if (this._readyCallbacks.length) {\r\n                let size = { width: this.width, height: this.height };\r\n                this._readyCallbacks.forEach((callback) => {\r\n                    callback(size);\r\n                });\r\n                this._readyCallbacks.length = 0;\r\n            }\r\n            img = null;\r\n        };\r\n\r\n        img.onerror = () => {\r\n            img = null;\r\n            console.warn(`canvas2d: Texture creating fail, error loading source \"${path}\".`);\r\n        };\r\n\r\n        // if (!loading[path]) {\r\n        //     console.log(`canvas2d: Start to load: \"${path}\".`);\r\n        // }\r\n\r\n        img.src = path;\r\n        loading[path] = true;\r\n    }\r\n\r\n    private _createByImage(image: HTMLImageElement, sourceRect?: Rect, textureRect?: Rect): void {\r\n        if (!sourceRect) {\r\n            sourceRect = {\r\n                x: 0,\r\n                y: 0,\r\n                width: image.width,\r\n                height: image.height\r\n            };\r\n        }\r\n        if (!textureRect) {\r\n            textureRect = {\r\n                x: 0,\r\n                y: 0,\r\n                width: sourceRect.width,\r\n                height: sourceRect.height,\r\n            };\r\n        }\r\n\r\n        var source: HTMLCanvasElement = createCanvas(image, sourceRect, textureRect);\r\n\r\n        this.width = source.width;\r\n        this.height = source.height;\r\n        this.source = source;\r\n        this.ready = true;\r\n    }\r\n}\r\n\r\nfunction generateTextureName(source: any, sourceRect?: Rect, textureRect?: Rect): any {\r\n    var isStr = typeof source === 'string';\r\n\r\n    if (!isStr && !source.src) {\r\n        return null;\r\n    }\r\n\r\n    var src = isStr ? source : source.src;\r\n    var sourceRectStr = sourceRect ? [sourceRect.x, sourceRect.y, sourceRect.width, sourceRect.height].join(',') : '';\r\n    var textureRectStr = textureRect ? [textureRect.x, textureRect.y, textureRect.width, textureRect.height].join(',') : '';\r\n\r\n    return src + sourceRectStr + textureRectStr;\r\n}\r\n\r\nfunction createCanvas(image: HTMLImageElement, sourceRect: Rect, textureRect: Rect): HTMLCanvasElement {\r\n    var canvas: HTMLCanvasElement = document.createElement(\"canvas\");\r\n    var context: CanvasRenderingContext2D = canvas.getContext('2d');\r\n\r\n    canvas.width = textureRect.width;\r\n    canvas.height = textureRect.height;\r\n\r\n    context.drawImage(\r\n        image, sourceRect.x, sourceRect.y, sourceRect.width, sourceRect.height,\r\n        textureRect.x, textureRect.y, textureRect.width, textureRect.height);\r\n\r\n    return canvas;\r\n}\r\n","import { IAction } from './Action';\r\n\r\nexport class Delay implements IAction {\r\n\r\n    duration: number;\r\n    done: boolean = false;\r\n    elapsed: number = 0;\r\n    immediate: boolean = true;\r\n\r\n    constructor(duration: number) {\r\n        this.duration = duration;\r\n    }\r\n\r\n    step(deltaTime: number): void {\r\n        this.elapsed += deltaTime;\r\n        if (this.elapsed >= this.duration) {\r\n            this.done = true;\r\n        }\r\n    }\r\n\r\n    end(): void {\r\n    }\r\n}","import { IAction } from './Action';\r\n\r\nexport class Callback implements IAction {\r\n\r\n    func: Function;\r\n    done: boolean = false;\r\n    immediate: boolean = true;\r\n\r\n    constructor(func: Function) {\r\n        this.func = func;\r\n    }\r\n\r\n    step(): void {\r\n        this.func.call(null);\r\n        this.end();\r\n    }\r\n\r\n    end(): void {\r\n        this.func = null;\r\n        this.done = true;\r\n    }\r\n}","import { IAction } from './Action';\r\nimport { Texture } from '../Texture';\r\n\r\nexport class Animation implements IAction {\r\n\r\n    done: boolean = false;\r\n    immediate: boolean = false;\r\n    elapsed: number = 0;\r\n    count: number = 0;\r\n    frameIndex: number = 0;\r\n    interval: number;\r\n    frameList: Array<Texture | string>;\r\n    repetitions: number;\r\n\r\n    constructor(frameList: Array<Texture | string>, frameRate: number, repetitions?: number) {\r\n        this.frameList = frameList;\r\n        this.repetitions = repetitions;\r\n        this.interval = 1 / frameRate;\r\n    }\r\n\r\n    step(deltaTime: number, target: any) {\r\n        this.elapsed += deltaTime;\r\n\r\n        if (this.elapsed >= this.interval) {\r\n            target.texture = this.frameList[this.frameIndex++];\r\n\r\n            if (this.frameIndex === this.frameList.length) {\r\n                if (this.repetitions == null || ++this.count < this.repetitions) {\r\n                    this.frameIndex = 0;\r\n                }\r\n                else {\r\n                    this.end();\r\n                }\r\n            }\r\n\r\n            this.elapsed = 0;\r\n        }\r\n    }\r\n\r\n    end() {\r\n        this.frameList = null;\r\n        this.done = true;\r\n    }\r\n}","const Key = 'canvas2d.uid';\r\n\r\nvar counter = 0;\r\nvar cachedColor: { [key: string]: string } = {};\r\n\r\nexport type Color = string | number;\r\n\r\nexport function uid(target: any) {\r\n    if (typeof target[Key] === 'undefined') {\r\n        Object.defineProperty(target, Key, { value: counter++ });\r\n    }\r\n    return target[Key];\r\n}\r\n\r\nexport function addArrayItem(array: any[], item: any) {\r\n    if (array.indexOf(item) === -1) {\r\n        array.push(item);\r\n    }\r\n}\r\n\r\nexport function removeArrayItem(array: any[], item: any) {\r\n    let index = array.indexOf(item);\r\n    if (index > -1) {\r\n        array.splice(index, 1);\r\n    }\r\n}\r\n\r\nexport function convertColor(color: string | number): string {\r\n    if (cachedColor[color]) {\r\n        return cachedColor[color];\r\n    }\r\n    if (typeof color === 'string') {\r\n        if (color.indexOf('rgb') === 0) {\r\n            cachedColor[color] = color;\r\n            return color;\r\n        }\r\n        if (color[0] != '#' || (color.length != 4 && color.length != 7)) {\r\n            throw new Error(`canvas2d: Invalid color string \"${color}\".`);\r\n        }\r\n        cachedColor[color] = color;\r\n        return color;\r\n    }\r\n    if (typeof color === 'number') {\r\n        let result = color.toString(16);\r\n        while (result.length < 3) {\r\n            result = '0' + result;\r\n        }\r\n        if (result.length !== 3 && result.length !== 6) {\r\n            throw new Error(`canvas2d: Invalid hex color \"0x${result}\".`);\r\n        }\r\n        result = cachedColor[color] = '#' + result;\r\n        return result;\r\n    }\r\n}\r\n\r\n","import { Action } from './Action';\r\nimport { addArrayItem, removeArrayItem } from '../Util';\r\n\r\nexport interface IActionListener {\r\n    all(callback: Function): IActionListener;\r\n    any(callback: Function): IActionListener;\r\n}\r\n\r\nexport class ActionListener implements IActionListener {\r\n\r\n    private _resolved: boolean = false;\r\n    private _callbacks: { any?: Array<Function>; all?: Array<Function> } = {};\r\n    private _actions: Array<Action>\r\n\r\n    constructor(actions: Array<Action>) {\r\n        this._actions = actions;\r\n    }\r\n\r\n    all(callback: Function): ActionListener {\r\n        if (this._resolved) {\r\n            callback();\r\n        }\r\n        else {\r\n            if (!this._callbacks.all) {\r\n                this._callbacks.all = [];\r\n            }\r\n            addArrayItem(this._callbacks.all, callback);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    any(callback: Function): ActionListener {\r\n        if (this._resolved) {\r\n            callback();\r\n        }\r\n        else {\r\n            if (!this._callbacks.any) {\r\n                this._callbacks.any = [];\r\n            }\r\n            addArrayItem(this._callbacks.any, callback);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    _step(): void {\r\n        var allDone: boolean = true;\r\n        var anyDone: boolean = false;\r\n\r\n        this._actions.forEach((action) => {\r\n            if (action._done) {\r\n                anyDone = true;\r\n            }\r\n            else {\r\n                allDone = false;\r\n            }\r\n        });\r\n\r\n        if (anyDone && this._callbacks.any) {\r\n            this._callbacks.any.forEach(callback => callback());\r\n            this._callbacks.any = null;\r\n        }\r\n\r\n        if (allDone && this._callbacks.all) {\r\n            this._callbacks.all.forEach(callback => callback());\r\n            removeArrayItem(Action._listenerList, this);\r\n            this._resolved = true;\r\n        }\r\n    }\r\n}","import { IAction } from './Action';\r\nimport { Tween, EasingFunc } from '../Tween';\r\n\r\nexport type TransToProps = {\r\n    [name: string]: number | { dest: number; easing: EasingFunc; }\r\n}\r\n\r\nexport type TransByProps = {\r\n    [name: string]: number | { value: number; easing: EasingFunc; }\r\n}\r\n\r\nexport class Transition implements IAction {\r\n\r\n    private _defaultEasing: EasingFunc = Tween.easeInOutQuad;\r\n\r\n    done: boolean = false;\r\n    immediate: boolean = false;\r\n    elapsed: number = 0;\r\n    duration: number;\r\n    isTransitionBy: boolean;\r\n\r\n    options: Array<{ name: string; dest: number; easing: EasingFunc; }>;\r\n    beginValue: { [name: string]: number };\r\n    deltaValue: { [name: string]: number };\r\n\r\n    constructor(options: any, duration: number, isTransitionBy?: boolean) {\r\n        this.options = [];\r\n        this.deltaValue = {};\r\n        this.duration = duration;\r\n        this.isTransitionBy = isTransitionBy;\r\n\r\n        if (isTransitionBy) {\r\n            this._initAsTransitionBy(options);\r\n        }\r\n        else {\r\n            this._initAsTransitionTo(options);\r\n        }\r\n    }\r\n\r\n    private _initAsTransitionTo(options: TransToProps) {\r\n        Object.keys(options).forEach(name => {\r\n            let info = options[name];\r\n            let easing: EasingFunc;\r\n            let dest: number;\r\n\r\n            if (typeof info === 'number') {\r\n                dest = info;\r\n            }\r\n            else {\r\n                easing = info.easing;\r\n                dest = info.dest;\r\n            }\r\n\r\n            this.options.push({ name, dest, easing });\r\n        });\r\n    }\r\n\r\n    private _initAsTransitionBy(options: TransByProps) {\r\n        let deltaValue = this.deltaValue;\r\n\r\n        Object.keys(options).forEach(name => {\r\n            let info = options[name];\r\n            let easing: EasingFunc;\r\n            let dest: number;\r\n\r\n            if (typeof info === 'number') {\r\n                deltaValue[name] = info;\r\n            }\r\n            else {\r\n                easing = info.easing;\r\n                deltaValue[name] = info.value;\r\n            }\r\n\r\n            this.options.push({ name, dest, easing });\r\n        });\r\n    }\r\n\r\n    private _initBeginValue(target: any) {\r\n        let beginValue = this.beginValue = {};\r\n        let deltaValue = this.deltaValue;\r\n\r\n        if (this.isTransitionBy) {\r\n            this.options.forEach(option => {\r\n                beginValue[option.name] = target[option.name];\r\n                option.dest = target[option.name] + deltaValue[option.name];\r\n            });\r\n        }\r\n        else {\r\n            this.options.forEach(option => {\r\n                beginValue[option.name] = target[option.name];\r\n                deltaValue[option.name] = option.dest - target[option.name];\r\n            });\r\n        }\r\n    }\r\n\r\n    step(deltaTime: number, target: any): void {\r\n        this.elapsed += deltaTime;\r\n\r\n        if (this.beginValue == null) {\r\n            this._initBeginValue(target);\r\n        }\r\n\r\n        if (this.elapsed >= this.duration) {\r\n            return this.end(target);\r\n        }\r\n\r\n        var percent = this.elapsed / this.duration;\r\n        var beginValue = this.beginValue;\r\n        var deltaValue = this.deltaValue;\r\n\r\n        this.options.forEach(({name, dest, easing}) => {\r\n            easing = easing || this._defaultEasing;\r\n            target[name] = beginValue[name] + (easing(percent) * deltaValue[name]);\r\n        });\r\n    }\r\n\r\n    end(target: any): void {\r\n        this.options.forEach((attr) => {\r\n            target[attr.name] = attr.dest;\r\n        });\r\n        this.beginValue = null;\r\n        this.deltaValue = null;\r\n        this.options = null;\r\n        this.done = true;\r\n    }\r\n}","﻿import { Texture } from '../Texture';\r\nimport { Delay } from './Delay';\r\nimport { Callback } from './Callback';\r\nimport { Animation } from './Animation';\r\nimport { Tween, EasingFunc } from '../Tween';\r\nimport { IActionListener, ActionListener } from './ActionListener';\r\nimport { TransByProps, TransToProps, Transition } from './Transition';\r\nimport { addArrayItem, removeArrayItem } from '../Util';\r\n\r\nexport enum ActionType {\r\n    TO,\r\n    BY,\r\n    ANIM,\r\n    WAIT,\r\n    CALLBACK,\r\n}\r\n\r\nexport type ActionQueue = Array<{\r\n    type: ActionType.TO;\r\n    options: TransToProps;\r\n    duration: number;\r\n} | {\r\n        type: ActionType.BY;\r\n        options: TransByProps;\r\n        duration: number;\r\n    } | {\r\n        type: ActionType.ANIM;\r\n        frameList: Array<Texture | string>;\r\n        frameRate: number;\r\n        repetitions?: number;\r\n    } | {\r\n        type: ActionType.WAIT;\r\n        duration: number;\r\n    } | {\r\n        type: ActionType.CALLBACK;\r\n        callback: Function;\r\n    }>;\r\n\r\nexport interface IAction {\r\n    immediate?: boolean;\r\n    done: boolean;\r\n\r\n    step(deltaTime: number, target: any): void;\r\n    end(target: any): void;\r\n}\r\n\r\nexport class Action {\r\n\r\n    /**\r\n     * Stop action by target\r\n     */\r\n    static stop(target: any) {\r\n        Action._actionList.slice().forEach((action) => {\r\n            if (action.target === target) {\r\n                action.stop();\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Listen a action list, when all actions are done then publish to listener\r\n     */\r\n    static listen(actions: Array<Action>): IActionListener {\r\n        var listener = new ActionListener(actions);\r\n        Action._listenerList.push(listener);\r\n        return listener;\r\n    }\r\n\r\n    static schedule(deltaTime: number): void {\r\n        Action._actionList.slice().forEach(action => {\r\n            action._step(deltaTime);\r\n\r\n            if (action._done) {\r\n                removeArrayItem(Action._actionList, action);\r\n            }\r\n        });\r\n\r\n        Action._listenerList.slice().forEach((listener: ActionListener) => {\r\n            listener._step();\r\n        });\r\n    }\r\n\r\n    static _actionList: Array<Action> = [];\r\n    static _listenerList: Array<IActionListener> = [];\r\n\r\n    private _queue: Array<IAction> = [];\r\n\r\n    _done: boolean = false;\r\n\r\n    /**\r\n     * Action running state\r\n     */\r\n    isRunning: boolean = false;\r\n    target: any;\r\n\r\n    constructor(target: any) {\r\n        this.target = target;\r\n    }\r\n\r\n    queue(actions: ActionQueue) {\r\n        actions.forEach(action => {\r\n            switch (action.type) {\r\n                case ActionType.ANIM:\r\n                    this.animate(action.frameList, action.frameRate, action.repetitions);\r\n                    break;\r\n                case ActionType.BY:\r\n                    this.by(action.options, action.duration);\r\n                    break;\r\n                case ActionType.TO:\r\n                    this.to(action.options, action.duration);\r\n                    break;\r\n                case ActionType.WAIT:\r\n                    this.wait(action.duration);\r\n                    break;\r\n                case ActionType.CALLBACK:\r\n                    this.then(action.callback);\r\n                    break;\r\n            }\r\n        });\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Add a callback, it will exec after previous action is done.\r\n     */\r\n    then(callback: Function): Action {\r\n        this._queue.push(new Callback(callback));\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Add a delay action.\r\n     */\r\n    wait(time: number): Action {\r\n        this._queue.push(new Delay(time));\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Add a animation action\r\n     */\r\n    animate(frameList: Array<Texture | string>, frameRate: number, repetitions?: number): Action {\r\n        var anim = new Animation(frameList, frameRate, repetitions);\r\n        this._queue.push(anim);\r\n        anim.step(anim.interval, this.target);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * TransitionTo action\r\n     */\r\n    to(attrs: TransToProps, duration: number): Action {\r\n        this._queue.push(new Transition(attrs, duration));\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * TransitionBy action\r\n     */\r\n    by(attrs: TransByProps, duration: number): Action {\r\n        this._queue.push(new Transition(attrs, duration, true));\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Start the action\r\n     */\r\n    start(): Action {\r\n        if (!this.isRunning) {\r\n            addArrayItem(Action._actionList, this);\r\n            this.isRunning = true;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Stop the action\r\n     */\r\n    stop() {\r\n        this._done = true;\r\n        this.isRunning = false;\r\n        this._queue.length = 0;\r\n\r\n        removeArrayItem(Action._actionList, this);\r\n    }\r\n\r\n    private _step(deltaTime: number): void {\r\n        if (!this._queue.length) {\r\n            return;\r\n        }\r\n\r\n        var action = this._queue[0];\r\n\r\n        action.step(deltaTime, this.target);\r\n\r\n        if (action.done) {\r\n            this._queue.shift();\r\n\r\n            if (!this._queue.length) {\r\n                this._done = true;\r\n                this.isRunning = false;\r\n                this.target = null;\r\n            }\r\n            else if (action.immediate) {\r\n                this._step(deltaTime);\r\n            }\r\n        }\r\n    }\r\n}","import { uid, addArrayItem, removeArrayItem } from './Util';\r\n\r\nvar counter = 0;\r\nvar eventCache: { [id: number]: { [type: string]: EventListener[] } } = {};\r\n\r\nexport type EventListener = (...args: any[]) => any;\r\n\r\nexport class EventEmitter {\r\n\r\n    addListener(type: string, listener: EventListener) {\r\n        let id = uid(this);\r\n        if (!eventCache[id]) {\r\n            eventCache[id] = {};\r\n        }\r\n        if (!eventCache[id][type]) {\r\n            eventCache[id][type] = [];\r\n        }\r\n\r\n        addArrayItem(eventCache[id][type], listener);\r\n        return this;\r\n    }\r\n\r\n    on(type: string, listener: EventListener) {\r\n        return this.addListener(type, listener);\r\n    }\r\n\r\n    removeListener(type: string, listener: EventListener) {\r\n        let cache = eventCache[uid(this)];\r\n\r\n        if (cache && cache[type]) {\r\n            removeArrayItem(cache[type], listener);\r\n            if (!cache[type].length) {\r\n                delete cache[type];\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    removeAllListeners(type?: string) {\r\n        let id = uid(this);\r\n        let cache = eventCache[id];\r\n\r\n        if (cache) {\r\n            if (type == null) {\r\n                EventEmitter[id] = null;\r\n            }\r\n            else {\r\n                delete cache[type];\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    emit(type: string, ...args: any[]) {\r\n        let id = uid(this);\r\n        let cache = eventCache[id];\r\n\r\n        if (cache && cache[type]) {\r\n            cache[type].slice().forEach(listener => {\r\n                listener.apply(this, args);\r\n            });\r\n        }\r\n        return this;\r\n    }\r\n}","var instance: ReleasePool;\r\n\r\nexport class ReleasePool {\r\n\r\n    private _objs: Object[] = [];\r\n    private _timerId: number;\r\n\r\n    add(obj: Object) {\r\n        this._objs.push(obj);\r\n        if (this._timerId != null) {\r\n            return;\r\n        }\r\n        this._timerId = setTimeout(() => this._release(), 0);\r\n    }\r\n\r\n    private _release() {\r\n        this._objs.forEach(obj => {\r\n            Object.keys(obj).forEach(key => delete obj[key]);\r\n        });\r\n        this._timerId = null;\r\n        this._objs.length = 0;\r\n    }\r\n\r\n    static get instance() {\r\n        if (!instance) {\r\n            instance = new ReleasePool();\r\n        }\r\n        return instance;\r\n    }\r\n}","import { EventHelper } from '../UIEvent';\r\nimport { Color, convertColor, uid } from '../Util';\r\nimport { Action } from '../action/Action';\r\nimport { Texture } from '../Texture';\r\nimport { EventEmitter } from '../EventEmitter';\r\nimport { ReleasePool } from '../ReleasePool';\r\n\r\nexport const RAD_PER_DEG: number = Math.PI / 180;\r\n\r\nexport enum AlignType {\r\n    TOP,\r\n    RIGHT,\r\n    BOTTOM,\r\n    LEFT,\r\n    CENTER\r\n}\r\n\r\nexport class Sprite<T extends ISprite> extends EventEmitter {\r\n\r\n    protected _width: number = 0;\r\n    protected _height: number = 0;\r\n    protected _originX: number = 0.5;\r\n    protected _originY: number = 0.5;\r\n    protected _rotation: number = 0;\r\n    protected _rotationRad: number = 0;\r\n    protected _texture: Texture;\r\n    protected _alignX: AlignType;\r\n    protected _alignY: AlignType;\r\n    protected _parent: Sprite<T>;\r\n\r\n    protected _props: T & ISprite; // Define for tsx\r\n\r\n    _originPixelX: number = 0;\r\n    _originPixelY: number = 0;\r\n\r\n    id: number;\r\n\r\n    x: number = 0;\r\n    y: number = 0;\r\n    scaleX: number = 1;\r\n    scaleY: number = 1;\r\n    radius: number = 0;\r\n    opacity: number = 1;\r\n    sourceX: number = 0;\r\n    sourceY: number = 0;\r\n    sourceWidth: number;\r\n    sourceHeight: number;\r\n    lighterMode: boolean = false;\r\n    autoResize: boolean = true;\r\n    flippedX: boolean = false;\r\n    flippedY: boolean = false;\r\n    visible: boolean = true;\r\n    clipOverflow: boolean = false;\r\n    bgColor: Color;\r\n    borderColor: Color;\r\n    borderWidth: number;\r\n    children: Sprite<any>[];\r\n\r\n    touchEnabled: boolean = true;\r\n    mouseEnabled: boolean = true;\r\n    keyboardEnabled: boolean = true;\r\n\r\n    onClick: ISprite[\"onClick\"];\r\n\r\n    /**\r\n     * Mouse begin event handler\r\n     */\r\n    onMouseBegin: ISprite[\"onMouseBegin\"];\r\n\r\n    /**\r\n     * Mouse moved event handler\r\n     */\r\n    onMouseMoved: ISprite[\"onMouseMoved\"];\r\n\r\n    /**\r\n     * Mouse ended event handler\r\n     */\r\n    onMouseEnded: ISprite[\"onMouseEnded\"];\r\n\r\n    /**\r\n     * Touch begin event handler\r\n     */\r\n    onTouchBegin: ISprite[\"onTouchBegin\"];\r\n\r\n    /**\r\n     * Touch moved event handler\r\n     */\r\n    onTouchMoved: ISprite[\"onTouchMoved\"];\r\n\r\n    /**\r\n     * KeyDown event handler\r\n     */\r\n    onKeyDown: ISprite[\"onKeyDown\"];\r\n\r\n    /**\r\n     * KeyUp event handler\r\n     */\r\n    onKeyUp: ISprite[\"onKeyUp\"];\r\n\r\n    /**\r\n     * Touch ended event hadndler\r\n     */\r\n    onTouchEnded: ISprite[\"onTouchEnded\"];\r\n\r\n    constructor(attrs?: ISprite) {\r\n        super();\r\n        this.id = uid(this);\r\n        this._init(attrs);\r\n    }\r\n\r\n    protected _init(attrs?: ISprite) {\r\n        if (attrs) {\r\n            Object.keys(attrs).forEach(name => this[name] = attrs[name]);\r\n        }\r\n    }\r\n\r\n    set width(value: number) {\r\n        if (this._width === value) {\r\n            return;\r\n        }\r\n\r\n        this._width = value;\r\n        this._originPixelX = this._width * this._originX;\r\n        this.adjustAlignX();\r\n\r\n        this.children && this.children.forEach(sprite => sprite.adjustAlignX());\r\n    }\r\n\r\n    get width(): number {\r\n        return this._width;\r\n    }\r\n\r\n    set height(value: number) {\r\n        if (this._height === value) {\r\n            return;\r\n        }\r\n\r\n        this._height = value;\r\n        this._originPixelY = this._height * this._originY;\r\n        this.adjustAlignY();\r\n\r\n        this.children && this.children.forEach(sprite => sprite.adjustAlignY());\r\n    }\r\n\r\n    get height(): number {\r\n        return this._height;\r\n    }\r\n\r\n    set originX(value: number) {\r\n        if (this._originX === value) {\r\n            return;\r\n        }\r\n\r\n        this._originX = value;\r\n        this._originPixelX = this._originX * this._width;\r\n        this.adjustAlignX();\r\n    }\r\n\r\n    get originX(): number {\r\n        return this._originX;\r\n    }\r\n\r\n    set originY(value: number) {\r\n        if (this._originY === value) {\r\n            return;\r\n        }\r\n\r\n        this._originY = value;\r\n        this._originPixelY = this._originY * this._height;\r\n        this.adjustAlignY();\r\n    }\r\n\r\n    get originY(): number {\r\n        return this._originY;\r\n    }\r\n\r\n    set rotation(value: number) {\r\n        if (this._rotation === value) {\r\n            return;\r\n        }\r\n\r\n        this._rotation = value;\r\n        this._rotationRad = this._rotation * RAD_PER_DEG;\r\n    }\r\n\r\n    get rotation(): number {\r\n        return this._rotation;\r\n    }\r\n\r\n    set texture(value: Texture | string) {\r\n        let texture: Texture;\r\n\r\n        if (typeof value === 'string') {\r\n            texture = Texture.create(value);\r\n        }\r\n        else {\r\n            texture = value;\r\n        }\r\n\r\n        if (texture === this._texture) {\r\n            return;\r\n        }\r\n\r\n        this._texture = texture;\r\n\r\n        if (!this.autoResize) {\r\n            return;\r\n        }\r\n\r\n        if (texture) {\r\n            if (texture.ready) {\r\n                this.width = texture.width;\r\n                this.height = texture.height;\r\n            }\r\n            else {\r\n                texture.onReady((size) => {\r\n                    this.width = size.width;\r\n                    this.height = size.height;\r\n                });\r\n            }\r\n        }\r\n        else {\r\n            this.width = 0;\r\n            this.height = 0;\r\n        }\r\n    }\r\n\r\n    get texture() {\r\n        return this._texture;\r\n    }\r\n\r\n    set parent(sprite: Sprite<any>) {\r\n        if (sprite === this._parent) {\r\n            return;\r\n        }\r\n\r\n        this._parent = sprite;\r\n\r\n        if (sprite) {\r\n            this.adjustAlignX();\r\n            this.adjustAlignY();\r\n        }\r\n    }\r\n\r\n    get parent() {\r\n        return this._parent;\r\n    }\r\n\r\n    set alignX(value: AlignType) {\r\n        if (this._alignX === value || value === AlignType.BOTTOM || value === AlignType.TOP) {\r\n            return;\r\n        }\r\n        this._alignX = value;\r\n        this.adjustAlignX();\r\n    }\r\n\r\n    get alignX() {\r\n        return this._alignX;\r\n    }\r\n\r\n    set alignY(value: AlignType) {\r\n        if (this._alignY === value || value === AlignType.LEFT || value === AlignType.RIGHT) {\r\n            return;\r\n        }\r\n        this._alignY = value;\r\n        this.adjustAlignY();\r\n    }\r\n\r\n    get alignY() {\r\n        return this._alignY;\r\n    }\r\n\r\n    _update(deltaTime: number): void {\r\n        this.update(deltaTime);\r\n\r\n        if (this.children && this.children.length) {\r\n            this.children.slice().forEach((child) => {\r\n                child._update(deltaTime);\r\n            });\r\n        }\r\n    }\r\n\r\n    _visit(context: CanvasRenderingContext2D): void {\r\n        if (!this.visible || this.opacity === 0) {\r\n            return;\r\n        }\r\n\r\n        var sx: number = this.scaleX;\r\n        var sy: number = this.scaleY;\r\n\r\n        context.save();\r\n\r\n        if (this.lighterMode) {\r\n            context.globalCompositeOperation = \"lighter\";\r\n        }\r\n        if (this.x !== 0 || this.y !== 0) {\r\n            context.translate(this.x, this.y);\r\n        }\r\n        if (this.opacity !== 1) {\r\n            context.globalAlpha = this.opacity;\r\n        }\r\n        if (this.flippedX) {\r\n            sx = -sx;\r\n        }\r\n        if (this.flippedY) {\r\n            sy = -sy;\r\n        }\r\n        if (sx !== 1 || sy !== 1) {\r\n            context.scale(sx, sy);\r\n        }\r\n\r\n        var rotationRad: number = this._rotationRad % 360;\r\n\r\n        if (rotationRad !== 0) {\r\n            context.rotate(rotationRad);\r\n        }\r\n\r\n        if ((this._width !== 0 && this._height !== 0) || this.radius > 0) {\r\n            this.draw(context);\r\n        }\r\n\r\n        this._visitAllChildren(context);\r\n\r\n        context.restore();\r\n    }\r\n\r\n    adjustAlignX() {\r\n        if (!this.parent || this._alignX == null) {\r\n            return;\r\n        }\r\n\r\n        let x: number;\r\n        let ox = this._originPixelX;\r\n\r\n        switch (this._alignX) {\r\n            case AlignType.LEFT:\r\n                x = ox;\r\n                break;\r\n            case AlignType.RIGHT:\r\n                x = this.parent.width - (this.width - ox);\r\n                break;\r\n            case AlignType.CENTER:\r\n                x = this.parent.width * 0.5 + ox - this.width * 0.5;\r\n                break;\r\n        }\r\n\r\n        if (x != null) {\r\n            this.x = x;\r\n        }\r\n    }\r\n\r\n    adjustAlignY() {\r\n        if (!this.parent || this._alignY == null) {\r\n            return;\r\n        }\r\n\r\n        let y: number;\r\n        let oy = this._originPixelY;\r\n\r\n        switch (this._alignY) {\r\n            case AlignType.TOP:\r\n                y = oy;\r\n                break;\r\n            case AlignType.BOTTOM:\r\n                y = this.parent.height - (this.height - oy);\r\n                break;\r\n            case AlignType.CENTER:\r\n                y = this.parent.height * 0.5 + oy - this.height * 0.5;\r\n                break;\r\n        }\r\n\r\n        if (y != null) {\r\n            this.y = y;\r\n        }\r\n    }\r\n\r\n    protected _visitAllChildren(context: CanvasRenderingContext2D): void {\r\n        if (!this.children || !this.children.length) {\r\n            return;\r\n        }\r\n        if (this._originPixelX !== 0 || this._originPixelY !== 0) {\r\n            context.translate(-this._originPixelX, -this._originPixelY);\r\n        }\r\n\r\n        this.children.forEach((child) => {\r\n            child._visit(context);\r\n        });\r\n    }\r\n\r\n    protected _clip(context: CanvasRenderingContext2D) {\r\n        if (!this.clipOverflow) {\r\n            return;\r\n        }\r\n\r\n        context.beginPath();\r\n        if (this.radius > 0) {\r\n            context.arc(0, 0, this.radius, 0, Math.PI * 2, true);\r\n        }\r\n        else {\r\n            context.rect(-this._originPixelX, -this._originPixelY, this._width, this._height);\r\n        }\r\n        context.closePath();\r\n        context.clip();\r\n    }\r\n\r\n    protected _drawBgColor(context: CanvasRenderingContext2D): void {\r\n        if (this.bgColor == null) {\r\n            return;\r\n        }\r\n\r\n        context.fillStyle = convertColor(this.bgColor);\r\n        context.beginPath();\r\n        if (this.radius > 0) {\r\n            context.arc(0, 0, this.radius, 0, Math.PI * 2, true);\r\n        }\r\n        else {\r\n            context.rect(-this._originPixelX, -this._originPixelY, this._width, this._height);\r\n        }\r\n        context.closePath();\r\n        context.fill();\r\n    }\r\n\r\n    protected _drawBorder(context: CanvasRenderingContext2D): void {\r\n        if (this.borderWidth != null) {\r\n            context.lineWidth = this.borderWidth;\r\n            context.strokeStyle = convertColor(this.borderColor || 0x000);\r\n            context.beginPath();\r\n            if (this.radius > 0) {\r\n                context.arc(0, 0, this.radius, 0, Math.PI * 2, true);\r\n            }\r\n            else {\r\n                context.rect(-this._originPixelX, -this._originPixelY, this._width, this._height);\r\n            }\r\n            context.closePath();\r\n            context.stroke();\r\n        }\r\n    }\r\n\r\n    protected draw(context: CanvasRenderingContext2D): void {\r\n        this._clip(context);\r\n        this._drawBgColor(context);\r\n        this._drawBorder(context);\r\n\r\n        var texture = this._texture;\r\n        if (texture && texture.ready && texture.width !== 0 && texture.height !== 0) {\r\n            var sx: number = this.sourceX;\r\n            var sy: number = this.sourceY;\r\n            var sw: number = this.sourceWidth == null ? texture.width : this.sourceWidth;\r\n            var sh: number = this.sourceHeight == null ? texture.height : this.sourceHeight;\r\n\r\n            context.drawImage(\r\n                texture.source, sx, sy, sw, sh,\r\n                -this._originPixelX, -this._originPixelY, this.width, this.height\r\n            );\r\n        }\r\n    }\r\n\r\n    addChild(target: Sprite<any>, position?: number): void {\r\n        if (target.parent) {\r\n            throw new Error(\"canvas2d.Sprite.addChild(): Child has been added.\");\r\n        }\r\n\r\n        if (!this.children) {\r\n            this.children = [];\r\n        }\r\n\r\n        var children: Sprite<any>[] = this.children;\r\n\r\n        if (children.indexOf(target) === -1) {\r\n            if (position > -1 && position < children.length) {\r\n                children.splice(position, 0, target);\r\n            }\r\n            else {\r\n                children.push(target);\r\n            }\r\n            target.parent = this;\r\n        }\r\n    }\r\n\r\n    removeChild(target: Sprite<any>): void {\r\n        if (!this.children || !this.children.length) {\r\n            return;\r\n        }\r\n        var index = this.children.indexOf(target);\r\n        if (index > -1) {\r\n            this.children.splice(index, 1);\r\n            target.parent = null;\r\n        }\r\n    }\r\n\r\n    removeAllChildren(recusive?: boolean): void {\r\n        if (!this.children || !this.children.length) {\r\n            return;\r\n        }\r\n\r\n        while (this.children.length) {\r\n            var sprite: Sprite<any> = this.children[0];\r\n\r\n            if (recusive) {\r\n                sprite.removeAllChildren(true);\r\n                Action.stop(sprite);\r\n            }\r\n            this.removeChild(sprite);\r\n        }\r\n\r\n        this.children = null;\r\n    }\r\n\r\n    release(recusive?: boolean) {\r\n        Action.stop(this);\r\n\r\n        if (recusive && this.children) {\r\n            while (this.children.length) {\r\n                this.children[0].release(recusive);\r\n            }\r\n        }\r\n        else {\r\n            this.removeAllChildren();\r\n        }\r\n\r\n        if (this.parent) {\r\n            this.parent.removeChild(this);\r\n        }\r\n\r\n        ReleasePool.instance.add(this);\r\n    }\r\n\r\n    update(deltaTime: number): any {\r\n\r\n    }\r\n}\r\n\r\nexport interface ISprite {\r\n    x?: number;\r\n    y?: number;\r\n    width?: number;\r\n    height?: number;\r\n    scaleX?: number;\r\n    scaleY?: number;\r\n    originX?: number;\r\n    originY?: number;\r\n    bgColor?: Color;\r\n    radius?: number;\r\n    borderWidth?: number;\r\n    borderColor?: Color;\r\n    texture?: Texture | string;\r\n    rotation?: number;\r\n    opacity?: number;\r\n    visible?: boolean;\r\n    alignX?: AlignType,\r\n    alignY?: AlignType,\r\n    flippedX?: boolean;\r\n    flippedY?: boolean;\r\n    clipOverflow?: boolean;\r\n\r\n    /**\r\n     * Position X of the clipping rect on texture\r\n     */\r\n    sourceX?: number;\r\n\r\n    /**\r\n     * Position Y of the clipping rect on texture\r\n     */\r\n    sourceY?: number;\r\n\r\n    /**\r\n     * Width of the clipping rect on texture\r\n     */\r\n    sourceWidth?: number;\r\n\r\n    /**\r\n     * Height of the clipping rect on texture\r\n     */\r\n    sourceHeight?: number;\r\n\r\n    /**\r\n     * Use lighter mode\r\n     */\r\n    lighterMode?: boolean;\r\n\r\n    /**\r\n     * Auto resize by the texture\r\n     */\r\n    autoResize?: boolean;\r\n\r\n    touchEnabled?: boolean;\r\n    mouseEnabled?: boolean;\r\n    keyboardEnabled?: boolean;\r\n\r\n    /**\r\n     * Sprite would call this method each frame\r\n     * @param  deltaTime  Duration between now and last frame\r\n     */\r\n    update?(deltaTime: number): any;\r\n\r\n    /**\r\n     * Click event handler\r\n     */\r\n    onClick?(e: EventHelper, event: MouseEvent): any;\r\n\r\n    /**\r\n     * Mouse begin event handler\r\n     */\r\n    onMouseBegin?(e: EventHelper, event: MouseEvent): any;\r\n\r\n    /**\r\n     * Mouse moved event handler\r\n     */\r\n    onMouseMoved?(e: EventHelper, event: MouseEvent): any;\r\n\r\n    /**\r\n     * Mouse ended event handler\r\n     */\r\n    onMouseEnded?(e: EventHelper, event: MouseEvent): any;\r\n\r\n    /**\r\n     * Touch begin event handler\r\n     */\r\n    onTouchBegin?(touches: EventHelper[], event: TouchEvent): any;\r\n\r\n    /**\r\n     * Touch moved event handler\r\n     */\r\n    onTouchMoved?(touches: EventHelper[], event: TouchEvent): any;\r\n\r\n    /**\r\n     * Touch ended event hadndler\r\n     */\r\n    onTouchEnded?(touches: EventHelper[], event: TouchEvent): any;\r\n\r\n    /**\r\n     * KeyDown event handler\r\n     */\r\n    onKeyDown?(event: KeyboardEvent): any;\r\n\r\n    /**\r\n     * KeyUp event handler\r\n     */\r\n    onKeyUp?(event: KeyboardEvent): any;\r\n}\r\n","﻿import { Rect } from './Texture';\r\nimport { Stage, Orientation } from './Stage';\r\nimport { Sprite } from './sprite/Sprite';\r\nimport { addArrayItem } from './Util';\r\n\r\nexport type EventHelper = {\r\n    identifier?: number;\r\n    beginX: number;\r\n    beginY: number;\r\n    localX?: number;\r\n    localY?: number;\r\n    stageX?: number;\r\n    stageY?: number;\r\n    _moved?: boolean;\r\n    beginTarget?: Sprite<any>;\r\n    target?: Sprite<any>;\r\n    cancelBubble: boolean;\r\n}\r\n\r\nconst keyDown = \"keydown\";\r\nconst keyUp = \"keyup\";\r\n\r\nconst touchBegin = \"touchstart\";\r\nconst touchMoved = \"touchmove\";\r\nconst touchEnded = \"touchend\";\r\n\r\nconst mouseBegin = \"mousedown\";\r\nconst mouseMoved = \"mousemove\";\r\nconst mouseEnded = \"mouseup\";\r\n\r\nconst onClick = \"onClick\";\r\nconst onKeyUp = \"onKeyUp\";\r\nconst onKeyDown = \"onKeyDown\";\r\n\r\nconst onTouchBegin = \"onTouchBegin\";\r\nconst onTouchMoved = \"onTouchMoved\";\r\nconst onTouchEnded = \"onTouchEnded\";\r\n\r\nconst onMouseBegin = \"onMouseBegin\";\r\nconst onMouseMoved = \"onMouseMoved\";\r\nconst onMouseEnded = \"onMouseEnded\";\r\n\r\nexport class UIEvent {\r\n\r\n    public static supportTouch: boolean = \"ontouchend\" in window;\r\n\r\n    private _registered: boolean;\r\n    private _touchHelperMap: { [index: number]: EventHelper } = {};\r\n    private _mouseBeginHelper: EventHelper;\r\n    private _mouseMovedHelper: EventHelper;\r\n\r\n    stage: Stage;\r\n    element: HTMLElement;\r\n\r\n    constructor(stage: Stage) {\r\n        this.stage = stage;\r\n        this.element = stage.canvas;\r\n    }\r\n\r\n    register() {\r\n        if (this._registered) {\r\n            return;\r\n        }\r\n\r\n        var { stage, element } = this;\r\n\r\n        if (stage.touchEnabled && UIEvent.supportTouch) {\r\n            element.addEventListener(touchBegin, this._touchBeginHandler, false);\r\n            element.addEventListener(touchMoved, this._touchMovedHandler, false);\r\n            element.addEventListener(touchEnded, this._touchEndedHandler, false);\r\n        }\r\n        if (stage.mouseEnabled) {\r\n            element.addEventListener(mouseBegin, this._mouseBeginHandler, false);\r\n            element.addEventListener(mouseMoved, this._mouseMovedHandler, false);\r\n            element.addEventListener(mouseEnded, this._mouseEndedHandler, false);\r\n        }\r\n        if (stage.keyboardEnabled) {\r\n            document.addEventListener(keyDown, this._keyDownHandler, false);\r\n            document.addEventListener(keyUp, this._keyUpHandler, false);\r\n        }\r\n\r\n        this._touchHelperMap = {};\r\n        this._registered = true;\r\n    }\r\n\r\n    unregister(): void {\r\n        if (!this._registered) {\r\n            return;\r\n        }\r\n        var element = this.element;\r\n\r\n        element.removeEventListener(touchBegin, this._touchBeginHandler, false);\r\n        element.removeEventListener(touchMoved, this._touchMovedHandler, false);\r\n        element.removeEventListener(touchEnded, this._touchEndedHandler, false);\r\n\r\n\r\n        element.removeEventListener(mouseBegin, this._mouseBeginHandler, false);\r\n        element.removeEventListener(mouseMoved, this._mouseMovedHandler, false);\r\n        element.removeEventListener(mouseEnded, this._mouseEndedHandler, false);\r\n\r\n        document.removeEventListener(keyDown, this._keyDownHandler, false);\r\n        document.removeEventListener(keyUp, this._keyUpHandler, false);\r\n\r\n        this._mouseBeginHelper = this._mouseMovedHelper = null;\r\n        this._registered = false;\r\n    }\r\n\r\n    release(): void {\r\n        this.unregister();\r\n        this._mouseBeginHandler = this._mouseMovedHandler = this._mouseEndedHandler = null;\r\n        this._touchBeginHandler = this._touchMovedHandler = this._touchEndedHandler = null;\r\n        this._keyUpHandler = this._keyDownHandler = null;\r\n        this._touchHelperMap = null;\r\n        this.element = this.stage = null;\r\n    }\r\n\r\n    transformLocation(event) {\r\n        var clientRect = this.element.getBoundingClientRect();\r\n        var scale = this.stage.scale;\r\n        var isRotated = this.stage.isPortrait && this.stage.orientation === Orientation.LANDSCAPE;\r\n        var x: number;\r\n        var y: number;\r\n\r\n        if (isRotated) {\r\n            x = (event.clientY - clientRect.top) / scale;\r\n            y = this.stage.height - (event.clientX - clientRect.left) / scale;\r\n        }\r\n        else {\r\n            x = (event.clientX - clientRect.left) / scale;\r\n            y = (event.clientY - clientRect.top) / scale;\r\n        }\r\n        return { x, y };\r\n    }\r\n\r\n    private _transformTouches(touches, justGet?: boolean): EventHelper[] {\r\n        var helpers: EventHelper[] = [];\r\n        var clientRect = this.element.getBoundingClientRect();\r\n        var scale = this.stage.scale;\r\n        var isRotated = this.stage.isPortrait && this.stage.orientation === Orientation.LANDSCAPE;\r\n        var touchHelperMap = this._touchHelperMap;\r\n\r\n        for (var i: number = 0, x: number, y: number, id: number, helper, touch; touch = touches[i]; i++) {\r\n            id = touch.identifier;\r\n            var x: number;\r\n            var y: number;\r\n\r\n            if (isRotated) {\r\n                x = (touch.clientY - clientRect.top) / scale;\r\n                y = this.stage.height - (touch.clientX - clientRect.left) / scale;\r\n            }\r\n            else {\r\n                x = (touch.clientX - clientRect.left) / scale;\r\n                y = (touch.clientY - clientRect.top) / scale;\r\n            }\r\n\r\n            helper = touchHelperMap[id];\r\n\r\n            if (!helper) {\r\n                helper = touchHelperMap[id] = {\r\n                    identifier: id,\r\n                    beginX: x,\r\n                    beginY: y,\r\n                    cancelBubble: false\r\n                };\r\n            }\r\n            else if (!justGet) {\r\n                helper._moved = x - helper.beginX !== 0 || y - helper.beginY !== 0;\r\n            }\r\n\r\n            helper.stageX = x;\r\n            helper.stageY = y;\r\n\r\n            helpers.push(helper);\r\n        }\r\n\r\n        return helpers;\r\n    }\r\n\r\n    private _touchBeginHandler = (event: TouchEvent) => {\r\n        var stage = this.stage;\r\n\r\n        if (!stage.isRunning || !stage.touchEnabled) {\r\n            return;\r\n        }\r\n\r\n        var helpers = this._transformTouches(event.changedTouches);\r\n\r\n        this._dispatchTouch(stage.sprite, 0, 0, helpers.slice(), event, onTouchBegin);\r\n\r\n        helpers.forEach((touch) => {\r\n            touch.beginTarget = touch.target;\r\n        });\r\n\r\n        event.preventDefault();\r\n    }\r\n\r\n    private _touchMovedHandler = (event: TouchEvent) => {\r\n        var stage = this.stage;\r\n\r\n        if (!stage.isRunning || !stage.touchEnabled) {\r\n            return;\r\n        }\r\n\r\n        var helpers = this._transformTouches(event.changedTouches);\r\n\r\n        this._dispatchTouch(stage.sprite, 0, 0, helpers, event, onTouchMoved);\r\n\r\n        event.preventDefault();\r\n    }\r\n\r\n    private _touchEndedHandler = (event: TouchEvent) => {\r\n        var stage = this.stage;\r\n\r\n        if (stage.isRunning && stage.touchEnabled) {\r\n            var helpers = this._transformTouches(event.changedTouches, true);\r\n\r\n            this._dispatchTouch(stage.sprite, 0, 0, helpers.slice(), event, onTouchEnded, true);\r\n\r\n            helpers.forEach(helper => {\r\n                // target = helper.target;\r\n\r\n                // if (hasImplements(target, ontouchended)) {\r\n                //     target[ontouchended](helper, helpers, event);\r\n                // }\r\n\r\n                // if (hasImplements(target, onclick) && target === helper.beginTarget && (!helper._moved || isMovedSmallRange(helper))) {\r\n                //     target[onclick](helper, event);\r\n                // }\r\n\r\n                helper.target = null;\r\n                helper.beginTarget = null;\r\n                this._touchHelperMap[helper.identifier] = null;\r\n            });\r\n\r\n            helpers = null;\r\n        }\r\n    }\r\n\r\n    private _mouseBeginHandler = (event: MouseEvent) => {\r\n        var stage = this.stage;\r\n        if (!stage.isRunning || !stage.mouseEnabled) {\r\n            return;\r\n        }\r\n\r\n        var location = this.transformLocation(event);\r\n        var helper: EventHelper = {\r\n            beginX: location.x,\r\n            beginY: location.y,\r\n            stageX: location.x,\r\n            stageY: location.y,\r\n            cancelBubble: false\r\n        };\r\n\r\n        this._dispatchMouse(stage.sprite, 0, 0, helper, event, onMouseBegin);\r\n\r\n        if (helper.target) {\r\n            helper.beginTarget = helper.target;\r\n            this._mouseBeginHelper = helper;\r\n        }\r\n\r\n        event.preventDefault();\r\n    }\r\n\r\n    private _mouseMovedHandler = (event: MouseEvent) => {\r\n        var stage = this.stage;\r\n        if (!stage.isRunning || !stage.mouseEnabled) {\r\n            return;\r\n        }\r\n\r\n        var location = this.transformLocation(event);\r\n        var mouseBeginHelper = this._mouseBeginHelper;\r\n\r\n        if (mouseBeginHelper) {\r\n            mouseBeginHelper.stageX = location.x;\r\n            mouseBeginHelper.stageY = location.y;\r\n            mouseBeginHelper._moved = mouseBeginHelper.beginX - location.x !== 0 || mouseBeginHelper.beginY - location.y !== 0;\r\n            this._dispatchMouse(stage.sprite, 0, 0, mouseBeginHelper, event, onMouseMoved);\r\n        }\r\n        else {\r\n            let mouseMovedHelper = this._mouseMovedHelper = {\r\n                beginX: null,\r\n                beginY: null,\r\n                stageX: location.x,\r\n                stageY: location.y,\r\n                cancelBubble: false\r\n            };\r\n            this._dispatchMouse(stage.sprite, 0, 0, mouseMovedHelper, event, onMouseMoved);\r\n        }\r\n\r\n        event.preventDefault();\r\n    }\r\n\r\n    private _mouseEndedHandler = (event: MouseEvent) => {\r\n        var stage = this.stage;\r\n        if (stage.isRunning && stage.mouseEnabled) {\r\n            var location = this.transformLocation(event)\r\n            var helper = this._mouseBeginHelper || this._mouseMovedHelper;\r\n            var target;\r\n\r\n            helper.stageX = location.x;\r\n            helper.stageY = location.y;\r\n            target = helper.target;\r\n\r\n            // if (hasImplements(target, ON_MOUSE_ENDED)) {\r\n            //     target[ON_MOUSE_ENDED](helper, event);\r\n            // }\r\n\r\n            var triggerClick = !helper._moved || isMovedSmallRange(helper);\r\n            this._dispatchMouse(stage.sprite, 0, 0, helper, event, onMouseEnded, triggerClick);\r\n\r\n            // if (hasImplements(target, ON_CLICK) && target === helper.beginTarget && (!helper._moved || isMovedSmallRange(helper))) {\r\n            //     target[ON_CLICK](helper, event);\r\n            // }\r\n        }\r\n\r\n        this._mouseBeginHelper = helper.target = helper.beginTarget = null;\r\n    }\r\n\r\n    private _keyDownHandler = (event: KeyboardEvent) => {\r\n        var stage = this.stage;\r\n        if (!stage.isRunning || !stage.keyboardEnabled) {\r\n            return;\r\n        }\r\n        this._dispatchKeyboard(stage.sprite, event.keyCode, event, onKeyDown);\r\n    }\r\n\r\n    private _keyUpHandler = (event: KeyboardEvent) => {\r\n        var stage = this.stage;\r\n        if (!stage.isRunning || !stage.keyboardEnabled) {\r\n            return;\r\n        }\r\n        this._dispatchKeyboard(stage.sprite, event.keyCode, event, onKeyUp);\r\n    }\r\n\r\n    private _dispatchTouch(\r\n        sprite: Sprite<any>,\r\n        offsetX: number,\r\n        offsetY: number,\r\n        helpers: EventHelper[],\r\n        event: TouchEvent,\r\n        methodName: string,\r\n        needTriggerClick?: boolean\r\n    ): any {\r\n        if (sprite.touchEnabled === false || !sprite.visible) {\r\n            return;\r\n        }\r\n\r\n        offsetX += sprite.x - sprite._originPixelX;\r\n        offsetY += sprite.y - sprite._originPixelY;\r\n\r\n        var children = sprite.children;\r\n        var tmpHelpers: EventHelper[] = helpers.slice();\r\n        var triggerreds: EventHelper[] = [];\r\n        var result: EventHelper[];\r\n\r\n        var callback = helper => result.indexOf(helper) === -1;\r\n\r\n        if (children && children.length) {\r\n            let index = children.length;\r\n\r\n            while (--index >= 0) {\r\n                result = this._dispatchTouch(children[index], offsetX, offsetY, tmpHelpers, event, methodName, needTriggerClick);\r\n                if (result && result.length) {\r\n                    triggerreds.push(...result);\r\n\r\n                    // Remove triggerred touch helper, it won't pass to other child sprites\r\n                    tmpHelpers = tmpHelpers.filter(callback);\r\n\r\n                    // All triggerred then exit the loop\r\n                    if (!tmpHelpers.length) {\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        var hits: EventHelper[] = triggerreds.filter(helper => !helper.cancelBubble);\r\n        var rect: Rect = {\r\n            x: offsetX,\r\n            y: offsetY,\r\n            width: sprite.width,\r\n            height: sprite.height\r\n        };\r\n        var circle = {\r\n            x: offsetX,\r\n            y: offsetY,\r\n            radius: sprite.radius\r\n        };\r\n        var count = 0;\r\n        var detect = rect.width === 0 && rect.height === 0 ? (helper: EventHelper) => {\r\n            return isCircleContainPoint(circle, helper);\r\n        } : (helper: EventHelper) => {\r\n            return isRectContainPoint(rect, helper);\r\n        };\r\n\r\n        for (let i = 0, helper: EventHelper; helper = tmpHelpers[i]; i++) {\r\n            if (detect(helper)) {\r\n                if (!helper.target) {\r\n                    helper.target = sprite;\r\n                }\r\n                helper.localX = helper.stageX - rect.x;\r\n                helper.localY = helper.stageY - rect.y;\r\n\r\n                // Add for current sprite hit list\r\n                hits.push(helper);\r\n                count++;\r\n            }\r\n        }\r\n\r\n        if (hits.length) {\r\n            var hasMethod: boolean = hasImplements(sprite, methodName);\r\n            var hasClickHandler: boolean = hasImplements(sprite, onClick);\r\n\r\n            if (hasMethod) {\r\n                sprite[methodName](hits, event);\r\n                triggerreds.push(...hits.slice(hits.length - count, count));\r\n            }\r\n\r\n            // Click event would just trigger by only a touch\r\n            if (hasClickHandler && needTriggerClick && hits.length === 1 && (!hits[0]._moved || isMovedSmallRange(hits[0]))) {\r\n                sprite[onClick](hits[0], event as any);\r\n                addArrayItem(triggerreds, hits[0]);\r\n            }\r\n        }\r\n        return triggerreds;\r\n    }\r\n\r\n    private _dispatchMouse(\r\n        sprite: Sprite<any>,\r\n        offsetX: number,\r\n        offsetY: number,\r\n        helper: EventHelper,\r\n        event: MouseEvent,\r\n        methodName: string,\r\n        triggerClick?: boolean\r\n    ): boolean {\r\n        if (sprite.mouseEnabled === false || !sprite.visible) {\r\n            return false;\r\n        }\r\n\r\n        offsetX += sprite.x - sprite._originPixelX;\r\n        offsetY += sprite.y - sprite._originPixelY;\r\n\r\n        var children = sprite.children;\r\n        var triggerred = false;\r\n\r\n        if (children && children.length) {\r\n            var index = children.length;\r\n\r\n            while (--index >= 0) {\r\n                triggerred = this._dispatchMouse(children[index], offsetX, offsetY, helper, event, methodName, triggerClick);\r\n                if (triggerred) {\r\n                    break;\r\n                }\r\n            }\r\n\r\n            if (helper.cancelBubble) {\r\n                return true;\r\n            }\r\n        }\r\n\r\n        var rect: Rect = {\r\n            x: offsetX,\r\n            y: offsetY,\r\n            width: sprite.width,\r\n            height: sprite.height\r\n        };\r\n        var circle = {\r\n            x: offsetX,\r\n            y: offsetY,\r\n            radius: sprite.radius\r\n        };\r\n        var detect = rect.width === 0 && rect.height === 0 ? (helper: EventHelper) => {\r\n            return isCircleContainPoint(circle, helper);\r\n        } : (helper: EventHelper) => {\r\n            return isRectContainPoint(rect, helper);\r\n        };\r\n\r\n        if (triggerred || detect(helper)) {\r\n            var hasMethod: boolean = hasImplements(sprite, methodName);\r\n            var hasClickHandler: boolean = hasImplements(sprite, onClick);\r\n\r\n            if (!helper.target) {\r\n                helper.target = sprite;\r\n            }\r\n            helper.localX = helper.stageX - rect.x;\r\n            helper.localY = helper.stageY - rect.y;\r\n\r\n            if (hasMethod) {\r\n                sprite[methodName](helper, event);\r\n            }\r\n            if (hasClickHandler && triggerClick) {\r\n                sprite[onClick](helper, event);\r\n            }\r\n\r\n            return true;\r\n        }\r\n    }\r\n\r\n    private _dispatchKeyboard(sprite: Sprite<any>, keyCode: number, event, methodName: string) {\r\n        if (sprite.keyboardEnabled === false) {\r\n            return;\r\n        }\r\n\r\n        if (hasImplements(sprite, methodName)) {\r\n            sprite[methodName](keyCode, event);\r\n        }\r\n\r\n        var i = 0, children = sprite.children, child;\r\n\r\n        if (children && children.length) {\r\n            for (; child = children[i]; i++) {\r\n                this._dispatchKeyboard(child, keyCode, event, methodName);\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction isRectContainPoint(rect: Rect, p: EventHelper) {\r\n    return rect.x <= p.stageX && rect.x + rect.width >= p.stageX &&\r\n        rect.y <= p.stageY && rect.y + rect.height >= p.stageY;\r\n}\r\n\r\nfunction isCircleContainPoint(circle: { x: number; y: number; radius: number }, p: EventHelper) {\r\n    var dx = p.stageX - circle.x;\r\n    var dy = p.stageY - circle.y;\r\n    return Math.sqrt(dx * dx + dy * dy) <= circle.radius;\r\n}\r\n\r\nfunction isMovedSmallRange(e: EventHelper) {\r\n    if (e.beginX == null && e.beginY == null) {\r\n        return false;\r\n    }\r\n    let x = Math.abs(e.beginX - e.stageX);\r\n    let y = Math.abs(e.beginY - e.stageY);\r\n\r\n    return x <= 5 && y <= 5;\r\n}\r\n\r\nfunction hasImplements(sprite: Sprite<any>, methodName: string) {\r\n    return sprite[methodName] !== Sprite.prototype[methodName] && typeof sprite[methodName] === 'function';\r\n}","﻿import { UIEvent } from './UIEvent';\r\nimport { Sprite } from './sprite/Sprite';\r\nimport { Action } from './action/Action';\r\n\r\nexport enum ScaleMode {\r\n    SHOW_ALL,\r\n    NO_BORDER,\r\n    FIX_WIDTH,\r\n    FIX_HEIGHT\r\n}\r\n\r\nexport enum Orientation {\r\n    LANDSCAPE,\r\n    PORTRAIT,\r\n}\r\n\r\nexport type VisibleRect = {\r\n    left: number;\r\n    right: number;\r\n    top: number;\r\n    bottom: number;\r\n};\r\n\r\nexport class Stage {\r\n\r\n    private _fps: number = 30;\r\n    private _frameRate: number = 1000 / this._fps;\r\n    private _isRunning: boolean;\r\n    private _width: number = 0;\r\n    private _height: number = 0;\r\n    private _rootSprite: Sprite<{}>;\r\n    private _visibleRect: VisibleRect;\r\n    private _canvasScale: number;\r\n    private _isPortrait: boolean;\r\n    private _scaleMode: ScaleMode;\r\n    private _autoAdjustCanvasSize: boolean;\r\n    private _orientation: Orientation;\r\n    private _canvasElement: HTMLCanvasElement;\r\n    private _renderContext: CanvasRenderingContext2D;\r\n    private _bufferCanvas: HTMLCanvasElement;\r\n    private _bufferContext: CanvasRenderingContext2D;\r\n    private _useExternalTimer: boolean;\r\n    private _lastUpdateTime: number;\r\n    private _eventLoopTimerId: number;\r\n    private _uiEvent: UIEvent;\r\n\r\n    touchEnabled: boolean;\r\n    mouseEnabled: boolean;\r\n    keyboardEnabled: boolean;\r\n\r\n    get fps(): number {\r\n        return this._fps;\r\n    }\r\n\r\n    set fps(value: number) {\r\n        this._frameRate = 1000 / value;\r\n        this._fps = value;\r\n    }\r\n\r\n    get isRunning(): boolean {\r\n        return this._isRunning;\r\n    }\r\n\r\n    get width(): number {\r\n        return this._width;\r\n    }\r\n\r\n    get height(): number {\r\n        return this._height;\r\n    }\r\n\r\n    get canvas(): HTMLCanvasElement {\r\n        return this._canvasElement;\r\n    }\r\n\r\n    get context(): CanvasRenderingContext2D {\r\n        return this._renderContext;\r\n    }\r\n\r\n    get sprite(): Sprite<{}> {\r\n        return this._rootSprite;\r\n    }\r\n\r\n    get visibleRect(): VisibleRect {\r\n        return this._visibleRect;\r\n    }\r\n\r\n    get scale(): number {\r\n        return this._canvasScale;\r\n    }\r\n\r\n    get isPortrait() {\r\n        return this._isPortrait;\r\n    }\r\n\r\n    get scaleMode(): ScaleMode {\r\n        return this._scaleMode;\r\n    }\r\n\r\n    set scaleMode(value: ScaleMode) {\r\n        if (value === this._scaleMode) {\r\n            return;\r\n        }\r\n\r\n        this._scaleMode = value;\r\n        this.adjustCanvasSize();\r\n    }\r\n\r\n    get autoAdjustCanvasSize() {\r\n        return this._autoAdjustCanvasSize;\r\n    }\r\n\r\n    set autoAdjustCanvasSize(value: boolean) {\r\n        if (value && !this._autoAdjustCanvasSize) {\r\n            this._autoAdjustCanvasSize = true;\r\n            this.adjustCanvasSize();\r\n            window.addEventListener(\"resize\", this.adjustCanvasSize);\r\n        }\r\n        else if (!value && this._autoAdjustCanvasSize) {\r\n            this._autoAdjustCanvasSize = false;\r\n            window.removeEventListener(\"resize\", this.adjustCanvasSize);\r\n        }\r\n    }\r\n\r\n    get orientation() {\r\n        return this._orientation;\r\n    }\r\n\r\n    set orientation(orientation: Orientation) {\r\n        if (this._orientation != orientation) {\r\n            this._orientation = orientation;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param  canvas     Canvas element\r\n     * @param  width      Resolution design width\r\n     * @param  height     Resolution design height\r\n     * @param  scaleMode  Adjust resolution design scale mode \r\n     */\r\n    constructor(\r\n        canvas: HTMLCanvasElement,\r\n        width: number,\r\n        height: number,\r\n        scaleMode: ScaleMode,\r\n        autoAdjustCanvasSize?: boolean,\r\n        orientation = Orientation.PORTRAIT\r\n    ) {\r\n        this._rootSprite = new Sprite({\r\n            x: width * 0.5,\r\n            y: height * 0.5,\r\n            width: width,\r\n            height: height\r\n        });\r\n\r\n        this._scaleMode = scaleMode;\r\n\r\n        this._canvasElement = canvas;\r\n        this._renderContext = canvas.getContext('2d');\r\n\r\n        this._bufferCanvas = document.createElement(\"canvas\");\r\n        this._bufferContext = this._bufferCanvas.getContext(\"2d\");\r\n\r\n        this._width = canvas.width = this._bufferCanvas.width = width;\r\n        this._height = canvas.height = this._bufferCanvas.height = height;\r\n\r\n        this._canvasScale = 1;\r\n        this._isPortrait = false;\r\n        this._visibleRect = { left: 0, right: width, top: 0, bottom: height };\r\n        this.orientation = orientation;\r\n        this.autoAdjustCanvasSize = autoAdjustCanvasSize;\r\n\r\n        this._uiEvent = new UIEvent(this);\r\n    }\r\n\r\n    setSize(width: number, height: number) {\r\n        this._width = this._canvasElement.width = this._bufferCanvas.width = width;\r\n        this._height = this._canvasElement.height = this._bufferCanvas.height = height;\r\n\r\n        if (this._autoAdjustCanvasSize) {\r\n            this.adjustCanvasSize();\r\n        }\r\n\r\n        this._rootSprite.x = width * 0.5;\r\n        this._rootSprite.y = height * 0.5;\r\n        this._rootSprite.width = width;\r\n        this._rootSprite.height = height;\r\n    }\r\n\r\n    adjustCanvasSize = () => {\r\n        var canvasElement = this._canvasElement;\r\n        var stageWidth = this._width;\r\n        var stageHeight = this._height;\r\n        var currentScaleMode = this._scaleMode;\r\n        var visibleRect = this._visibleRect;\r\n        var orientation = this._orientation;\r\n\r\n        if (!canvasElement || !canvasElement.parentNode) {\r\n            return;\r\n        }\r\n\r\n        var style = canvasElement.style;\r\n        var container = {\r\n            width: canvasElement.parentElement.offsetWidth,\r\n            height: canvasElement.parentElement.offsetHeight\r\n        };\r\n        var isPortrait = container.width < container.height;\r\n\r\n        if (orientation === Orientation.LANDSCAPE && isPortrait) {\r\n            let tmpHeight = container.height;\r\n            container.height = container.width;\r\n            container.width = tmpHeight;\r\n        }\r\n\r\n        var scaleX: number = container.width / stageWidth;\r\n        var scaleY: number = container.height / stageHeight;\r\n        var deltaWidth: number = 0;\r\n        var deltaHeight: number = 0;\r\n        var scale: number;\r\n        var width: number;\r\n        var height: number;\r\n\r\n        switch (currentScaleMode) {\r\n            case ScaleMode.SHOW_ALL:\r\n                if (scaleX < scaleY) {\r\n                    scale = scaleX;\r\n                    width = container.width;\r\n                    height = scale * stageHeight;\r\n                }\r\n                else {\r\n                    scale = scaleY;\r\n                    width = scale * stageWidth;\r\n                    height = container.height;\r\n                }\r\n                break;\r\n            case ScaleMode.NO_BORDER:\r\n                scale = scaleX > scaleY ? scaleX : scaleY;\r\n                width = stageWidth * scale;\r\n                height = stageHeight * scale;\r\n                deltaWidth = (stageWidth - container.width / scale) * 0.5 | 0;\r\n                deltaHeight = (stageHeight - container.height / scale) * 0.5 | 0;\r\n                break;\r\n            case ScaleMode.FIX_WIDTH:\r\n                scale = scaleX;\r\n                width = container.width;\r\n                height = container.height * scale;\r\n                deltaHeight = (stageHeight - container.height / scale) * 0.5 | 0;\r\n                break;\r\n            case ScaleMode.FIX_HEIGHT:\r\n                scale = scaleY;\r\n                width = scale * container.width;\r\n                height = container.height;\r\n                deltaWidth = (stageWidth - container.width / scale) * 0.5 | 0;\r\n                break;\r\n            default:\r\n                throw new Error(`Unknow stage scale mode \"${currentScaleMode}\"`);\r\n        }\r\n\r\n        style.width = width + 'px';\r\n        style.height = height + 'px';\r\n        style.position = 'absolute';\r\n\r\n        visibleRect.left = deltaWidth;\r\n        visibleRect.right = stageWidth - deltaWidth;\r\n        visibleRect.top = deltaHeight;\r\n        visibleRect.bottom = stageHeight - deltaHeight;\r\n\r\n        if (orientation === Orientation.LANDSCAPE && isPortrait) {\r\n            style.top = ((container.width - width) * 0.5) + 'px';\r\n            style.left = ((container.height - height) * 0.5) + 'px';\r\n            style.transformOrigin = style['webkitTransformOrigin'] = '0 0 0';\r\n            style.transform = style['webkitTransform'] = `translateX(${height}px) rotate(90deg)`;\r\n        }\r\n        else {\r\n            style.transform = '';\r\n            style.top = ((container.height - height) * 0.5) + 'px';\r\n            style.left = ((container.width - width) * 0.5) + 'px';\r\n        }\r\n\r\n        this._canvasScale = scale;\r\n        this._isPortrait = isPortrait;\r\n    }\r\n\r\n    start(useExternalTimer?: boolean): void {\r\n        if (this._isRunning) {\r\n            return;\r\n        }\r\n\r\n        this._useExternalTimer = !!useExternalTimer;\r\n\r\n        if (!useExternalTimer) {\r\n            this._lastUpdateTime = Date.now();\r\n            this._startTimer();\r\n        }\r\n\r\n        this._uiEvent.register();\r\n        this._isRunning = true;\r\n    }\r\n\r\n    step(deltaTime: number): void {\r\n        this._rootSprite._update(deltaTime);\r\n    }\r\n\r\n    stop(unregisterUIEvent?: boolean): void {\r\n        if (!this._isRunning) {\r\n            return;\r\n        }\r\n\r\n        if (unregisterUIEvent) {\r\n            this._uiEvent.unregister();\r\n        }\r\n\r\n        this._isRunning = false;\r\n        clearTimeout(this._eventLoopTimerId);\r\n    }\r\n\r\n    render() {\r\n        if (!this._isRunning) {\r\n            return;\r\n        }\r\n\r\n        var { width, height } = this._canvasElement;\r\n\r\n        this._bufferContext.clearRect(0, 0, width, height);\r\n        this._rootSprite._visit(this._bufferContext);\r\n\r\n        this._renderContext.clearRect(0, 0, width, height);\r\n        this._renderContext.drawImage(this._bufferCanvas, 0, 0, width, height);\r\n    }\r\n\r\n    /**\r\n     * Add sprite to the stage\r\n     */\r\n    addChild(child: Sprite<any>, position?: number): void {\r\n        this._rootSprite.addChild(child, position);\r\n    }\r\n\r\n    /**\r\n     * Remove sprite from the stage\r\n     */\r\n    removeChild(child: Sprite<any>): void {\r\n        this._rootSprite.removeChild(child);\r\n    }\r\n\r\n    /**\r\n     * Remove all sprites from the stage\r\n     * @param  recusive  Recusize remove all the children\r\n     */\r\n    removeAllChildren(recusive?: boolean): void {\r\n        this._rootSprite.removeAllChildren(recusive);\r\n    }\r\n\r\n    release() {\r\n        this.stop(true);\r\n        this._uiEvent.release();\r\n        this._rootSprite.release(true);\r\n        this._rootSprite = this._uiEvent = this._canvasElement = this._renderContext = this._bufferCanvas = this._bufferContext = null;\r\n    }\r\n\r\n    private _startTimer() {\r\n        this._eventLoopTimerId = setTimeout(() => {\r\n            if (this._useExternalTimer) {\r\n                return;\r\n            }\r\n\r\n            var deltaTime: number = this._getDeltaTime();\r\n            Action.schedule(deltaTime);\r\n            this._rootSprite._update(deltaTime);\r\n            this.render();\r\n            this._startTimer();\r\n        }, this._frameRate);\r\n    }\r\n\r\n    private _getDeltaTime() {\r\n        var now = Date.now();\r\n        var delta = now - this._lastUpdateTime;\r\n\r\n        this._lastUpdateTime = now;\r\n        return delta / 1000;\r\n    }\r\n}","﻿import { convertColor, Color } from '../Util';\r\nimport { Sprite, ISprite } from './Sprite';\r\n\r\nvar measureContext = document.createElement(\"canvas\").getContext(\"2d\");\r\nvar regEnter = /\\n/;\r\n\r\nexport type FontWeight = \"lighter\" | \"normal\" | \"bold\" | \"bolder\";\r\nexport type FontStyle = \"oblique\" | \"normal\" | \"italic\";\r\nexport type TextAlign = \"left\" | \"right\" | \"center\" | \"start\" | \"end\";\r\n\r\nexport interface ITextLabel extends ISprite {\r\n    text?: string;\r\n    fontName?: string;\r\n    textAlign?: TextAlign;\r\n    fontColor?: Color;\r\n    fontSize?: number;\r\n    lineSpace?: number;\r\n    fontStyle?: FontStyle;\r\n    fontWeight?: FontWeight;\r\n    maxWidth?: number;\r\n    strokeColor?: Color;\r\n    strokeWidth?: number;\r\n}\r\n\r\nexport class TextLabel extends Sprite<ITextLabel> {\r\n\r\n    maxWidth: number;\r\n    fontName: string = 'sans-serif';\r\n    textAlign: TextAlign = 'center';\r\n    lineSpace: number = 5;\r\n    fontColor: Color = 0x000;\r\n    fontSize: number = 20;\r\n    fontWeight: FontWeight = 'normal';\r\n    fontStyle: FontStyle = 'normal';\r\n    strokeColor: Color;\r\n    strokeWidth: number;\r\n\r\n    private _lines: string[];\r\n    private _text: string = '';\r\n\r\n    constructor(props?: ITextLabel) {\r\n        super();\r\n        super._init(props);\r\n    }\r\n\r\n    protected _init(props?: ISprite) {\r\n\r\n    }\r\n\r\n    set texture(value: any) {\r\n        throw new Error(`canvas2d: TextLabel cannot set texture.`);\r\n    }\r\n\r\n    set text(content: string) {\r\n        if (this._text !== content) {\r\n            this._text = content;\r\n\r\n            if (this.autoResize) {\r\n                this._resize();\r\n            }\r\n            else {\r\n                this._lines = content.split(regEnter);\r\n            }\r\n        }\r\n    }\r\n\r\n    get text(): string {\r\n        return this._text;\r\n    }\r\n\r\n    private _resize(): void {\r\n        this._lines = this._text.split(regEnter);\r\n\r\n        var width = 0;\r\n        var height = 0;\r\n        var fontSize = this.fontSize;\r\n        var lineSpace = this.lineSpace;\r\n\r\n        measureContext.save();\r\n        measureContext.font = this.fontStyle + ' ' + this.fontWeight + ' ' + fontSize + 'px ' + this.fontName;\r\n\r\n        this._lines.forEach((text, i) => {\r\n            width = Math.max(width, measureContext.measureText(text).width);\r\n            height = lineSpace * i + fontSize * (i + 1);\r\n        });\r\n\r\n        measureContext.restore();\r\n\r\n        this.width = width;\r\n        this.height = height;\r\n    }\r\n\r\n    addChild(): void {\r\n        throw new Error(`canvas2d.TextLabel.addChild(): Don't call this method.`);\r\n    }\r\n\r\n    protected draw(context: CanvasRenderingContext2D): void {\r\n        this._drawBgColor(context);\r\n        this._drawBorder(context);\r\n\r\n        if (this._text.length === 0) {\r\n            return;\r\n        }\r\n\r\n        context.font = this.fontStyle + ' ' + this.fontWeight + ' ' + this.fontSize + 'px ' + this.fontName;\r\n        context.fillStyle = convertColor(this.fontColor);\r\n        context.textAlign = this.textAlign;\r\n        context.textBaseline = 'middle';\r\n        context.lineJoin = 'round';\r\n\r\n        if (this.strokeWidth) {\r\n            context.strokeStyle = convertColor(this.strokeColor || 0x000);\r\n            context.lineWidth = this.strokeWidth * 2;\r\n        }\r\n\r\n        var y = 0;\r\n        var h = this.fontSize + this.lineSpace;\r\n\r\n        this._lines.forEach((text) => {\r\n            if (text.length > 0) {\r\n                if (this.strokeWidth) {\r\n                    context.strokeText(text, 0, y, 0xffff);\r\n                }\r\n                context.fillText(text, 0, y, 0xffff);\r\n            }\r\n            y += h;\r\n        });\r\n    }\r\n}\r\n","import { Texture } from '../Texture';\r\nimport { Sprite, ISprite } from './Sprite';\r\n\r\nexport interface IBMFontLabel extends ISprite {\r\n    textureMap: { [word: string]: Texture };\r\n    text?: string;\r\n}\r\n\r\nexport class BMFontLabel extends Sprite<IBMFontLabel> {\r\n\r\n    private _text: string;\r\n    private _words: Texture[];\r\n    private _textureMap: { [word: string]: Texture };\r\n\r\n    constructor(attrs?: IBMFontLabel) {\r\n        super(attrs);\r\n    }\r\n\r\n    set text(text: string) {\r\n        if (text === this._text) {\r\n            return;\r\n        }\r\n        this.setText(text);\r\n    }\r\n    get text() {\r\n        return this._text;\r\n    }\r\n\r\n    get textureMap() {\r\n        return this._textureMap;\r\n    }\r\n\r\n    set textureMap(textureMap: { [word: string]: Texture }) {\r\n        this._textureMap = textureMap;\r\n        this.setText(this._text);\r\n    }\r\n\r\n    setText(text: string) {\r\n        this._text = text || '';\r\n\r\n        if (!this.textureMap || !this._text) {\r\n            return;\r\n        }\r\n\r\n        var words = this._text.split('');\r\n\r\n        if (!words.length) {\r\n            this._words.length = 0;\r\n        }\r\n        else {\r\n            this._words = words.map(word => {\r\n                if (!this._textureMap[word]) {\r\n                    console.error(`canvas2d.BMFontLabel: Texture of the word \"${word}\" not found.`, this);\r\n                }\r\n                return this._textureMap[word];\r\n            });\r\n        }\r\n\r\n        this.removeAllChildren();\r\n\r\n        if (this._words && this._words.length) {\r\n            this._words.forEach((word, i) => {\r\n                if (!word) {\r\n                    return;\r\n                }\r\n\r\n                super.addChild(new Sprite({\r\n                    x: i * word.width,\r\n                    texture: word,\r\n                    originX: 0,\r\n                    originY: 0\r\n                }));\r\n            });\r\n\r\n            this.width = this._words.length * this._words[0].width;\r\n            this.height = this._words[0].height;\r\n        }\r\n    }\r\n\r\n    addChild() {\r\n        throw new Error(`canvas2d.BMFontLabel.addChild(): Don't call this method.`);\r\n    }\r\n\r\n}\r\n","import { Sprite, ISprite } from './sprite/Sprite';\r\nimport { TextLabel, ITextLabel } from './sprite/TextLabel';\r\nimport { BMFontLabel, IBMFontLabel } from './sprite/BMFontLabel';\r\nimport { Stage, ScaleMode, Orientation } from './Stage';\r\nimport { Texture } from './Texture';\r\nimport { Action, ActionQueue } from './action/Action';\r\n\r\nexport interface Ref<T> {\r\n    ref?(instance: T): any;\r\n}\r\nexport type ActionProps = { actions?: ActionQueue[] };\r\n\r\nexport type SpriteProps = ISprite & Ref<Sprite<{}>> & ActionProps;\r\nexport type TextProps = ITextLabel & Ref<TextLabel> & ActionProps;\r\nexport type BMFontProps = IBMFontLabel & Ref<BMFontLabel> & ActionProps;\r\nexport type SpriteClass<T, U> = new (attrs?: T & ISprite) => U;\r\nexport type StageProps = {\r\n    width: number;\r\n    height: number;\r\n    canvas: HTMLCanvasElement;\r\n    scaleMode: ScaleMode;\r\n    autoAdjustCanvasSize?: boolean;\r\n    orientation?: Orientation;\r\n    touchEnabled?: boolean;\r\n    mouseEnabled?: boolean;\r\n    keyboardEnabled?: boolean;\r\n    useExternalTimer?: boolean;\r\n} & Ref<Stage>;\r\n\r\nexport function createSprite<T, U>(type: \"sprite\", props: SpriteProps, ...children: any[]): Sprite<{}>;\r\nexport function createSprite<T, U>(type: \"text\", props: TextProps, ...children: any[]): TextLabel;\r\nexport function createSprite<T, U>(type: \"bmfont\", props: BMFontProps, ...children: any[]): BMFontLabel;\r\nexport function createSprite<T, U>(type: \"stage\", props: StageProps, ...children: any[]): Stage;\r\nexport function createSprite<T, U>(type: SpriteClass<T, U>, props: T & SpriteProps, ...children: any[]): U;\r\nexport function createSprite<T, U>(type: any, props: any, ...children: any[]): any {\r\n    props = props || {};\r\n\r\n    let sprite: any;\r\n    let { ref, actions, ...options } = props;\r\n\r\n    if (typeof type === 'function') {\r\n        sprite = new type(options);\r\n    }\r\n    else {\r\n        switch (type) {\r\n            case \"sprite\":\r\n                sprite = new Sprite(options);\r\n                addChildren(sprite, children);\r\n                break;\r\n            case \"text\":\r\n                sprite = createLabel<TextLabel>(type, TextLabel, options, children);\r\n                break;\r\n            case \"bmfont\":\r\n                sprite = createLabel<BMFontLabel>(type, BMFontLabel, options, children);\r\n                break;\r\n            case 'stage':\r\n                sprite = createStage(options, children);\r\n                break;\r\n        }\r\n    }\r\n\r\n    if (sprite == null) {\r\n        console.error(`canvas2d.createSprite(): Unknown sprite type`, type);\r\n    }\r\n    else if (actions && actions.length) {\r\n        (<ActionQueue[]>actions).forEach(queue => {\r\n            new Action(sprite).queue(queue).start();\r\n        });\r\n    }\r\n\r\n    if (ref) {\r\n        ref.call(undefined, sprite);\r\n    }\r\n\r\n    return sprite;\r\n}\r\n\r\nfunction createLabel<T>(tag: string, ctor: any, props: any, children: any[]): T {\r\n    let sprite = new ctor(props);\r\n    if (children.length) {\r\n        if (!ensureString(children)) {\r\n            throw new Error(`canvas2d: <${tag}> only support string children.`);\r\n        }\r\n        sprite.text = children.join('');\r\n    }\r\n    return sprite\r\n}\r\n\r\nfunction createStage(props: StageProps, children: Sprite<any>[]) {\r\n    let { canvas, width, height, scaleMode, autoAdjustCanvasSize, useExternalTimer, touchEnabled, mouseEnabled, keyboardEnabled, orientation } = props;\r\n    let stage = new Stage(canvas, width, height, scaleMode, autoAdjustCanvasSize, orientation);\r\n\r\n    stage.touchEnabled = touchEnabled;\r\n    stage.mouseEnabled = mouseEnabled;\r\n    stage.keyboardEnabled = keyboardEnabled;\r\n    stage.start(useExternalTimer);\r\n\r\n    if (children.length) {\r\n        children.forEach(child => child && stage.addChild(child));\r\n    }\r\n\r\n    return stage;\r\n}\r\n\r\nfunction ensureString(list: any[]) {\r\n    return list.every(item => typeof item === 'string');\r\n}\r\n\r\nfunction addChildren(sprite: Sprite<any>, children: any[]) {\r\n    if (!children.length) {\r\n        return;\r\n    }\r\n    children.forEach(child => {\r\n        if (!child) {\r\n            return;\r\n        }\r\n        if (Array.isArray(child)) {\r\n            addChildren(sprite, child);\r\n        }\r\n        else {\r\n            sprite.addChild(child);\r\n        }\r\n    });\r\n}\r\n","import { EventEmitter } from '../EventEmitter';\r\n\r\nexport class HTMLAudio extends EventEmitter {\r\n\r\n    static enabled: boolean = false;\r\n\r\n    private _audioNode: HTMLAudioElement;\r\n    private _isLoading: boolean;\r\n\r\n    src: string;\r\n    loop: boolean = false;\r\n    muted: boolean = false;\r\n    loaded: boolean = false;\r\n    volume: number = 1;\r\n    playing: boolean = false;\r\n    autoplay: boolean = false;\r\n    duration: number = 0;\r\n    currentTime: number = 0;\r\n\r\n    constructor(src: string) {\r\n        super();\r\n\r\n        this.src = src;\r\n        this._handleEvent = this._handleEvent.bind(this);\r\n    }\r\n\r\n    load() {\r\n        if (this.loaded || this._isLoading) {\r\n            return;\r\n        }\r\n\r\n        let audioNode = this._audioNode = new Audio();\r\n        audioNode.addEventListener('canplaythrough', this._handleEvent, false);\r\n        audioNode.addEventListener('ended', this._handleEvent, false);\r\n        audioNode.addEventListener('error', this._handleEvent, false);\r\n\r\n        audioNode.preload = \"auto\";\r\n        audioNode['autobuffer'] = true;\r\n        audioNode.setAttribute('src', this.src);\r\n        audioNode.volume = this.volume;\r\n        audioNode.load();\r\n    }\r\n\r\n    play() {\r\n        if (!HTMLAudio.enabled) {\r\n            return;\r\n        }\r\n        if (this.playing) {\r\n            this.stop();\r\n        }\r\n\r\n        if (this.loaded) {\r\n            this._play();\r\n        }\r\n        else if (!this._isLoading) {\r\n            this.autoplay = true;\r\n            this.load();\r\n        }\r\n    }\r\n\r\n    pause() {\r\n        if (this.playing) {\r\n            this._audioNode.pause();\r\n            this.currentTime = this._audioNode.currentTime;\r\n            this.playing = false;\r\n        }\r\n    }\r\n\r\n    resume() {\r\n        if (!this.playing && HTMLAudio.enabled) {\r\n            this.play();\r\n        }\r\n    }\r\n\r\n    stop() {\r\n        if (this.playing) {\r\n            this._audioNode.pause();\r\n            this._audioNode.currentTime = this.currentTime = 0;\r\n            this.playing = false;\r\n        }\r\n    }\r\n\r\n    setMute(muted: boolean) {\r\n        if (this.muted != muted) {\r\n            this.muted = muted;\r\n            if (this._audioNode) {\r\n                this._audioNode.volume = muted ? 0 : this.volume;\r\n            }\r\n        }\r\n    }\r\n\r\n    setVolume(volume: number) {\r\n        if (this.volume != volume) {\r\n            this.volume = volume;\r\n            if (this._audioNode) {\r\n                this._audioNode.volume = volume;\r\n            }\r\n        }\r\n    }\r\n\r\n    clone() {\r\n        let cloned = new HTMLAudio(this.src);\r\n\r\n        if (this.loaded) {\r\n            cloned._audioNode = <HTMLAudioElement>this._audioNode.cloneNode(true);\r\n            cloned.loaded = true;\r\n            cloned.duration = this.duration;\r\n        }\r\n\r\n        return cloned;\r\n    }\r\n\r\n    private _handleEvent(e: Event) {\r\n        let type = e.type;\r\n\r\n        switch (type) {\r\n            case 'canplaythrough':\r\n                e.target.removeEventListener('canplaythrough', this._handleEvent, false);\r\n\r\n                this.loaded = true;\r\n                this.duration = this._audioNode.duration;\r\n                this.emit('load');\r\n\r\n                if (this.autoplay) {\r\n                    this.play();\r\n                }\r\n                break;\r\n            case 'ended':\r\n                this.playing = false;\r\n                this.currentTime = 0;\r\n                this.emit('ended');\r\n\r\n                if (this.loop) {\r\n                    this.play();\r\n                }\r\n                break;\r\n        }\r\n    }\r\n\r\n    private _play() {\r\n        if (!this.playing) {\r\n            this._audioNode.volume = this.muted ? 0 : this.volume;\r\n            this._audioNode.play();\r\n            this.playing = true;\r\n        }\r\n    }\r\n}","import { EventEmitter } from '../EventEmitter';\r\n\r\nvar AudioCtx = window['AudioContext'] || window['webkitAudioContext'];\r\nvar context: AudioContext = AudioCtx ? new AudioCtx() : null;\r\n\r\nexport class WebAudio extends EventEmitter {\r\n\r\n    static isSupported: boolean = AudioCtx != null;\r\n\r\n    private static _initialized: boolean = false;\r\n    private static _enabled: boolean = false;\r\n\r\n    static set enabled(enabled: boolean) {\r\n        if (enabled && this.isSupported && !this._initialized) {\r\n            let source = context.createBufferSource();\r\n            source.buffer = context.createBuffer(1, 1, 22050);\r\n            source.connect(context.destination);\r\n            source.start ? source.start(0, 0, 0) : source['noteOn'](0, 0, 0);\r\n            this._initialized = true;\r\n        }\r\n        this._enabled = enabled;\r\n    }\r\n    static get enabled() {\r\n        return this._enabled;\r\n    }\r\n\r\n    private _gainNode: GainNode;\r\n    private _audioNode: AudioBufferSourceNode;\r\n    private _buffer: AudioBuffer;\r\n    private _startTime: number = 0;\r\n    private _isLoading: boolean;\r\n\r\n    src: string;\r\n    loop: boolean = false;\r\n    muted: boolean = false;\r\n    loaded: boolean = false;\r\n    volume: number = 1;\r\n    playing: boolean = false;\r\n    autoplay: boolean = false;\r\n    duration: number = 0;\r\n    currentTime: number = 0;\r\n\r\n    constructor(src: string) {\r\n        super();\r\n\r\n        this.src = src;\r\n        this._handleEvent = this._handleEvent.bind(this);\r\n        this._gainNode = context.createGain ? context.createGain() : context['createGainNode']();\r\n        this._gainNode.connect(context.destination);\r\n    }\r\n\r\n    load() {\r\n        if (this._isLoading || this.loaded) {\r\n            return;\r\n        }\r\n\r\n        let request = new XMLHttpRequest();\r\n        request.onprogress = request.onload = request.onerror = this._handleEvent;\r\n        request.open('GET', this.src, true);\r\n        request.responseType = 'arraybuffer';\r\n        request.send();\r\n\r\n        this._isLoading = true;\r\n    }\r\n\r\n    play() {\r\n        if (!WebAudio.enabled) {\r\n            return;\r\n        }\r\n\r\n        if (this.playing) {\r\n            this.stop();\r\n        }\r\n\r\n        if (this.loaded) {\r\n            this._play();\r\n        }\r\n        else if (!this._buffer) {\r\n            this.autoplay = true;\r\n            this.load();\r\n        }\r\n    }\r\n\r\n    pause() {\r\n        if (this.playing) {\r\n            this._audioNode.stop();\r\n            this.currentTime += context.currentTime - this._startTime;\r\n            this.playing = false;\r\n        }\r\n    }\r\n\r\n    resume() {\r\n        if (!this.playing && WebAudio.enabled) {\r\n            this._play();\r\n        }\r\n    }\r\n\r\n    stop() {\r\n        if (this.playing) {\r\n            this._audioNode.stop(0);\r\n            this._audioNode.disconnect();\r\n            this.currentTime = 0;\r\n            this.playing = false;\r\n        }\r\n    }\r\n\r\n    setMute(muted: boolean) {\r\n        if (this.muted != muted) {\r\n            this.muted = muted;\r\n            this._gainNode.gain.value = muted ? 0 : this.volume;\r\n        }\r\n    }\r\n\r\n    setVolume(volume: number) {\r\n        if (this.volume != volume) {\r\n            this.volume = volume;\r\n            this._gainNode.gain.value = volume;\r\n        }\r\n    }\r\n\r\n    clone() {\r\n        let cloned = new WebAudio(this.src);\r\n\r\n        if (this._isLoading) {\r\n            cloned._isLoading = true;\r\n            let onLoad = () => {\r\n                cloned._onDecodeCompleted(this._buffer);\r\n                this.removeListener(\"load\", onload);\r\n            };\r\n            this.on('load', onload);\r\n        }\r\n        else if (this.loaded) {\r\n            cloned._onDecodeCompleted(this._buffer);\r\n        }\r\n\r\n        return cloned;\r\n    }\r\n\r\n    private _handleEvent(e: Event) {\r\n        let type = e.type;\r\n        switch (type) {\r\n            case 'load':\r\n                let request: XMLHttpRequest = <any>e.target;\r\n                request.onload = request.onprogress = request.onerror = null;\r\n                context.decodeAudioData(request.response, (buffer) => this._onDecodeCompleted(buffer), () => this.emit('error'));\r\n                request = null;\r\n                break;\r\n            case 'ended':\r\n                if (this.playing) {\r\n                    // play ended, not paused\r\n                    this.currentTime = 0;\r\n                    this.playing = false;\r\n                    this.emit('ended');\r\n                    if (this.loop) {\r\n                        this.play();\r\n                    }\r\n                }\r\n                break;\r\n            default:\r\n                this.emit(type, e);\r\n                break;\r\n        }\r\n    }\r\n\r\n    private _onDecodeCompleted(buffer: AudioBuffer) {\r\n        this._buffer = buffer;\r\n        this._isLoading = false;\r\n        this.loaded = true;\r\n        this.duration = buffer.duration;\r\n        this.emit('load');\r\n        if (this.autoplay) {\r\n            this.play();\r\n        }\r\n    }\r\n\r\n    private _play() {\r\n        this._clearAudioNode();\r\n\r\n        let audioNode = context.createBufferSource();\r\n\r\n        if (!audioNode.start) {\r\n            audioNode.start = audioNode['noteOn'];\r\n            audioNode.stop = audioNode['noteOff'];\r\n        }\r\n\r\n        this._gainNode.gain.value = this.muted ? 0 : this.volume;\r\n\r\n        audioNode.buffer = this._buffer;\r\n        audioNode.onended = this._handleEvent;\r\n        audioNode.connect(this._gainNode);\r\n        audioNode.start(0, this.currentTime);\r\n\r\n        this._audioNode = audioNode;\r\n        this._startTime = context.currentTime;\r\n        this.playing = true;\r\n    }\r\n\r\n    private _clearAudioNode() {\r\n        let audioNode = this._audioNode;\r\n\r\n        if (audioNode) {\r\n            audioNode.onended = null;\r\n            audioNode.disconnect(0);\r\n            this._audioNode = null;\r\n        }\r\n    }\r\n}","﻿import { uid, removeArrayItem } from '../Util';\r\nimport { HTMLAudio } from './HTMLAudio';\r\nimport { WebAudio } from './WebAudio';\r\n\r\nexport class SoundManager {\r\n\r\n    private _ext: \".mp3\" | \".mp4\" | \".wav\" | \".ogg\" = \".mp3\";\r\n    private _enabled: boolean;\r\n    private _pausedAudios: { [id: number]: WebAudio | HTMLAudio };\r\n    private _audioCache: { [index: string]: Array<WebAudio | HTMLAudio> } = {};\r\n    private _supportedType = {\r\n        mp3: false,\r\n        mp4: false,\r\n        wav: false,\r\n        ogg: false\r\n    };\r\n\r\n    get enabled() {\r\n        return this._enabled;\r\n    }\r\n\r\n    set enabled(value: boolean) {\r\n        if (value == this._enabled) {\r\n            return;\r\n        }\r\n        this._setEnabled(value);\r\n    }\r\n\r\n    get supportedType(): { mp3: boolean; mp4: boolean; wav: boolean; ogg: boolean; } {\r\n        return { ...this._supportedType };\r\n    }\r\n\r\n    get ext() {\r\n        return this._ext;\r\n    }\r\n\r\n    set ext(ext) {\r\n        this._ext = ext;\r\n    }\r\n\r\n    constructor() {\r\n        this._detectSupportedType();\r\n    }\r\n\r\n    getAudio(name: string): WebAudio | HTMLAudio;\r\n    getAudio(name: string, returnAll: boolean): Array<WebAudio | HTMLAudio>;\r\n    getAudio(name: string, returnAll?: boolean): any {\r\n        var list = this._audioCache[name];\r\n\r\n        if (!list || !list.length) {\r\n            return returnAll ? [] : null;\r\n        }\r\n\r\n        var i: number = 0;\r\n        var all: Array<WebAudio | HTMLAudio> = [];\r\n        var audio: WebAudio | HTMLAudio;\r\n\r\n        for (; audio = list[i]; i++) {\r\n            if (!audio.playing) {\r\n                if (!returnAll) {\r\n                    return audio;\r\n                }\r\n                all.push(audio);\r\n            }\r\n        }\r\n\r\n        return returnAll ? all : all[0];\r\n    }\r\n\r\n    load(baseUri: string, name: string, onComplete: () => any, channels = 1) {\r\n        var src = baseUri + name + this._ext;\r\n        var audio = WebAudio.isSupported ? new WebAudio(src) : new HTMLAudio(src);\r\n\r\n        audio.on('load', () => {\r\n            if (onComplete) {\r\n                onComplete();\r\n            }\r\n\r\n            var cloned;\r\n            while (--channels > 0) {\r\n                cloned = audio.clone();\r\n                this._audioCache[name].push(cloned);\r\n            }\r\n        });\r\n        audio.on('error', (e: ErrorEvent) => {\r\n            console.warn(\"canvas2d.Sound.load() Error: \" + src + \" could not be loaded.\");\r\n            removeArrayItem(this._audioCache[name], audio);\r\n        });\r\n\r\n        if (!this._audioCache[name]) {\r\n            this._audioCache[name] = [];\r\n        }\r\n        this._audioCache[name].push(audio);\r\n\r\n        audio.load();\r\n    }\r\n\r\n    /**\r\n     * Load multiple sound resources\r\n     */\r\n    loadList(baseUri: string, resources: { name: string; channels?: number; }[], onAllCompleted?: () => any, onProgress?: (percent: number) => any) {\r\n        let totalCount = resources.length;\r\n        let endedCount = 0;\r\n\r\n        let onCompleted = () => {\r\n            ++endedCount;\r\n\r\n            if (onProgress) {\r\n                onProgress(endedCount / totalCount);\r\n            }\r\n            if (endedCount === totalCount && onAllCompleted) {\r\n                onAllCompleted();\r\n            }\r\n        }\r\n\r\n        resources.forEach(res => this.load(baseUri, res.name, onCompleted, res.channels));\r\n    }\r\n\r\n    /**\r\n     * Get all audioes by name\r\n     */\r\n    getAllAudioes(name: string): Array<WebAudio | HTMLAudio> {\r\n        return this._audioCache[name] && this._audioCache[name].slice();\r\n    }\r\n\r\n    /**\r\n     * Play sound by name\r\n     */\r\n    play(name: string, loop: boolean = false): WebAudio | HTMLAudio {\r\n        var audio = this._enabled && this.getAudio(name);\r\n\r\n        if (audio) {\r\n            audio.loop = loop;\r\n            audio.play();\r\n        }\r\n        return audio;\r\n    }\r\n\r\n    /**\r\n     * Pause sound by name\r\n     */\r\n    pause(name: string): void {\r\n        let list = this.getAllAudioes(name);\r\n\r\n        if (list) {\r\n            list.forEach(audio => audio.pause());\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Stop sound by name\r\n     */\r\n    stop(name: string): void {\r\n        let list = this._audioCache[name];\r\n\r\n        if (list) {\r\n            list.forEach(audio => audio.stop());\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Resume audio by name\r\n     */\r\n    resume(name: string): void {\r\n        let list = this._audioCache[name];\r\n        if (list) {\r\n            list.forEach(audio => !audio.playing && audio.currentTime > 0 && audio.resume());\r\n        }\r\n    }\r\n\r\n    private _setEnabled(value: boolean) {\r\n        if (value) {\r\n            WebAudio.enabled = true;\r\n            HTMLAudio.enabled = true;\r\n\r\n            if (this._pausedAudios) {\r\n                Object.keys(this._pausedAudios).forEach(id => {\r\n                    this._pausedAudios[id].resume();\r\n                });\r\n                this._pausedAudios = null;\r\n            }\r\n        }\r\n        else {\r\n            WebAudio.enabled = false;\r\n            HTMLAudio.enabled = false;\r\n\r\n            this._pausedAudios = {};\r\n            Object.keys(this._audioCache).forEach(name => {\r\n                this._audioCache[name].forEach(audio => {\r\n                    if (audio.playing) {\r\n                        audio.pause();\r\n                        this._pausedAudios[uid(audio)] = audio;\r\n                    }\r\n                });\r\n            });\r\n        }\r\n\r\n        this._enabled = value;\r\n    }\r\n\r\n    private _detectSupportedType() {\r\n        var aud = new Audio();\r\n        var reg = /maybe|probably/i;\r\n        var mts = {\r\n            mp3: 'audio/mpeg',\r\n            mp4: 'audio/mp4; codecs=\"mp4a.40.5\"',\r\n            wav: 'audio/x-wav',\r\n            ogg: 'audio/ogg; codecs=\"vorbis\"'\r\n        };\r\n\r\n        for (var name in mts) {\r\n            this._supportedType[name] = reg.test(aud.canPlayType(mts[name]));\r\n        }\r\n\r\n        aud = null;\r\n    }\r\n}\r\n\r\nexport const Sound = new SoundManager();\r\n"],"names":["ActionType","AlignType","tslib_1.__extends","Orientation","ScaleMode"],"mappings":"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"}