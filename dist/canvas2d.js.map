{"version":3,"file":null,"sources":["../src/Keys.ts","../src/Tween.ts","../src/CanvasSource.ts","../src/Texture.ts","../src/action/BaseAction.ts","../src/action/Delay.ts","../src/action/Callback.ts","../src/action/Animation.ts","../src/Util.ts","../src/action/ActionListener.ts","../src/action/Transition.ts","../src/action/Action.ts","../src/EventEmitter.ts","../src/ReleasePool.ts","../src/sprite/Sprite.ts","../src/UIEvent.ts","../src/Stage.ts","../src/measureText.ts","../src/sprite/TextLabel.ts","../src/sprite/BMFontLabel.ts","../src/createSprite.ts","../src/sound/HTMLAudio.ts","../src/sound/WebAudio.ts","../src/sound/Sound.ts"],"sourcesContent":["﻿export const Keys = {\r\n    MOUSE_LEFT: 1,\r\n    MOUSE_MID: 2,\r\n    MOUSE_RIGHT: 3,\r\n\r\n    BACKSPACE: 8,\r\n    TAB: 9,\r\n    NUM_CENTER: 12,\r\n    ENTER: 13,\r\n    RETURN: 13,\r\n    SHIFT: 16,\r\n    CTRL: 17,\r\n    ALT: 18,\r\n    PAUSE: 19,\r\n    CAPS_LOCK: 20,\r\n    ESC: 27,\r\n    ESCAPE: 27,\r\n    SPACE: 32,\r\n    PAGE_UP: 33,\r\n    PAGE_DOWN: 34,\r\n    END: 35,\r\n    HOME: 36,\r\n    LEFT: 37,\r\n    UP: 38,\r\n    RIGHT: 39,\r\n    DOWN: 40,\r\n    PRINT_SCREEN: 44,\r\n    INSERT: 45,\r\n    DELETE: 46,\r\n\r\n    ZERO: 48,\r\n    ONE: 49,\r\n    TWO: 50,\r\n    THREE: 51,\r\n    FOUR: 52,\r\n    FIVE: 53,\r\n    SIX: 54,\r\n    SEVEN: 55,\r\n    EIGHT: 56,\r\n    NINE: 57,\r\n\r\n    A: 65,\r\n    B: 66,\r\n    C: 67,\r\n    D: 68,\r\n    E: 69,\r\n    F: 70,\r\n    G: 71,\r\n    H: 72,\r\n    I: 73,\r\n    J: 74,\r\n    K: 75,\r\n    L: 76,\r\n    M: 77,\r\n    N: 78,\r\n    O: 79,\r\n    P: 80,\r\n    Q: 81,\r\n    R: 82,\r\n    S: 83,\r\n    T: 84,\r\n    U: 85,\r\n    V: 86,\r\n    W: 87,\r\n    X: 88,\r\n    Y: 89,\r\n    Z: 90,\r\n\r\n    CONTEXT_MENU: 93,\r\n    NUM0: 96,\r\n    NUM1: 97,\r\n    NUM2: 98,\r\n    NUM3: 99,\r\n    NUM4: 100,\r\n    NUM5: 101,\r\n    NUM6: 102,\r\n    NUM7: 103,\r\n    NUM8: 104,\r\n    NUM9: 105,\r\n    NUM_MULTIPLY: 106,\r\n    NUM_PLUS: 107,\r\n    NUM_MINUS: 109,\r\n    NUM_PERIOD: 110,\r\n    NUM_DIVISION: 111,\r\n    F1: 112,\r\n    F2: 113,\r\n    F3: 114,\r\n    F4: 115,\r\n    F5: 116,\r\n    F6: 117,\r\n    F7: 118,\r\n    F8: 119,\r\n    F9: 120,\r\n    F10: 121,\r\n    F11: 122,\r\n    F12: 123\r\n};","﻿export type EasingFunc = (percent: number, ...args: any[]) => number;\r\n\r\nexport const Tween = {\r\n    easeInQuad(pos) {\r\n        return Math.pow(pos, 2);\r\n    },\r\n\r\n    easeOutQuad(pos) {\r\n        return -(Math.pow((pos - 1), 2) - 1);\r\n    },\r\n\r\n    easeInOutQuad(pos) {\r\n        if ((pos /= 0.5) < 1) {\r\n            return 0.5 * Math.pow(pos, 2);\r\n        }\r\n        return -0.5 * ((pos -= 2) * pos - 2);\r\n    },\r\n\r\n    easeInCubic(pos) {\r\n        return Math.pow(pos, 3);\r\n    },\r\n\r\n    easeOutCubic(pos) {\r\n        return (Math.pow((pos - 1), 3) + 1);\r\n    },\r\n\r\n    easeInOutCubic(pos) {\r\n        if ((pos /= 0.5) < 1) {\r\n            return 0.5 * Math.pow(pos, 3);\r\n        }\r\n        return 0.5 * (Math.pow((pos - 2), 3) + 2);\r\n    },\r\n\r\n    easeInQuart(pos) {\r\n        return Math.pow(pos, 4);\r\n    },\r\n\r\n    easeOutQuart(pos) {\r\n        return -(Math.pow((pos - 1), 4) - 1)\r\n    },\r\n\r\n    easeInOutQuart(pos) {\r\n        if ((pos /= 0.5) < 1)\r\n            return 0.5 * Math.pow(pos, 4);\r\n        return -0.5 * ((pos -= 2) * Math.pow(pos, 3) - 2);\r\n    },\r\n\r\n    easeInQuint(pos) {\r\n        return Math.pow(pos, 5);\r\n    },\r\n\r\n    easeOutQuint(pos) {\r\n        return (Math.pow((pos - 1), 5) + 1);\r\n    },\r\n\r\n    easeInOutQuint(pos) {\r\n        if ((pos /= 0.5) < 1) {\r\n            return 0.5 * Math.pow(pos, 5);\r\n        }\r\n        return 0.5 * (Math.pow((pos - 2), 5) + 2);\r\n    },\r\n\r\n    easeInSine(pos) {\r\n        return -Math.cos(pos * (Math.PI / 2)) + 1;\r\n    },\r\n\r\n    easeOutSine(pos) {\r\n        return Math.sin(pos * (Math.PI / 2));\r\n    },\r\n\r\n    easeInOutSine(pos) {\r\n        return (-.5 * (Math.cos(Math.PI * pos) - 1));\r\n    },\r\n\r\n    easeInExpo(pos) {\r\n        return (pos == 0) ? 0 : Math.pow(2, 10 * (pos - 1));\r\n    },\r\n\r\n    easeOutExpo(pos) {\r\n        return (pos == 1) ? 1 : -Math.pow(2, -10 * pos) + 1;\r\n    },\r\n\r\n    easeInOutExpo(pos) {\r\n        if (pos == 0)\r\n            return 0;\r\n        if (pos == 1)\r\n            return 1;\r\n        if ((pos /= 0.5) < 1)\r\n            return 0.5 * Math.pow(2, 10 * (pos - 1));\r\n        return 0.5 * (-Math.pow(2, -10 * --pos) + 2);\r\n    },\r\n\r\n    easeInCirc(pos) {\r\n        return -(Math.sqrt(1 - (pos * pos)) - 1);\r\n    },\r\n\r\n    easeOutCirc(pos) {\r\n        return Math.sqrt(1 - Math.pow((pos - 1), 2))\r\n    },\r\n\r\n    easeInOutCirc(pos) {\r\n        if ((pos /= 0.5) < 1)\r\n            return -0.5 * (Math.sqrt(1 - pos * pos) - 1);\r\n        return 0.5 * (Math.sqrt(1 - (pos -= 2) * pos) + 1);\r\n    },\r\n\r\n    easeOutBounce(pos) {\r\n        if ((pos) < (1 / 2.75)) {\r\n            return (7.5625 * pos * pos);\r\n        }\r\n        else if (pos < (2 / 2.75)) {\r\n            return (7.5625 * (pos -= (1.5 / 2.75)) * pos + .75);\r\n        }\r\n        else if (pos < (2.5 / 2.75)) {\r\n            return (7.5625 * (pos -= (2.25 / 2.75)) * pos + .9375);\r\n        }\r\n        else {\r\n            return (7.5625 * (pos -= (2.625 / 2.75)) * pos + .984375);\r\n        }\r\n    },\r\n\r\n    easeInBack(pos) {\r\n        var s = 1.70158;\r\n        return (pos) * pos * ((s + 1) * pos - s);\r\n    },\r\n\r\n    easeOutBack(pos) {\r\n        var s = 1.70158;\r\n        return (pos = pos - 1) * pos * ((s + 1) * pos + s) + 1;\r\n    },\r\n\r\n    easeInOutBack(pos) {\r\n        var s = 1.70158;\r\n        if ((pos /= 0.5) < 1)\r\n            return 0.5 * (pos * pos * (((s *= (1.525)) + 1) * pos - s));\r\n        return 0.5 * ((pos -= 2) * pos * (((s *= (1.525)) + 1) * pos + s) + 2);\r\n    },\r\n\r\n    elastic(pos) {\r\n        return -1 * Math.pow(4, -8 * pos) * Math.sin((pos * 6 - 1) * (2 * Math.PI) / 2) + 1;\r\n    },\r\n\r\n    swingFromTo(pos) {\r\n        var s = 1.70158;\r\n        return ((pos /= 0.5) < 1) ? 0.5 * (pos * pos * (((s *= (1.525)) + 1) * pos - s)) :\r\n            0.5 * ((pos -= 2) * pos * (((s *= (1.525)) + 1) * pos + s) + 2);\r\n    },\r\n\r\n    swingFrom(pos) {\r\n        var s = 1.70158;\r\n        return pos * pos * ((s + 1) * pos - s);\r\n    },\r\n\r\n    swingTo(pos) {\r\n        var s = 1.70158;\r\n        return (pos -= 1) * pos * ((s + 1) * pos + s) + 1;\r\n    },\r\n\r\n    bounce(pos) {\r\n        if (pos < (1 / 2.75)) {\r\n            return (7.5625 * pos * pos);\r\n        }\r\n        else if (pos < (2 / 2.75)) {\r\n            return (7.5625 * (pos -= (1.5 / 2.75)) * pos + .75);\r\n        }\r\n        else if (pos < (2.5 / 2.75)) {\r\n            return (7.5625 * (pos -= (2.25 / 2.75)) * pos + .9375);\r\n        }\r\n        else {\r\n            return (7.5625 * (pos -= (2.625 / 2.75)) * pos + .984375);\r\n        }\r\n    },\r\n\r\n    bouncePast(pos) {\r\n        if (pos < (1 / 2.75)) {\r\n            return (7.5625 * pos * pos);\r\n        }\r\n        else if (pos < (2 / 2.75)) {\r\n            return 2 - (7.5625 * (pos -= (1.5 / 2.75)) * pos + .75);\r\n        }\r\n        else if (pos < (2.5 / 2.75)) {\r\n            return 2 - (7.5625 * (pos -= (2.25 / 2.75)) * pos + .9375);\r\n        }\r\n        else {\r\n            return 2 - (7.5625 * (pos -= (2.625 / 2.75)) * pos + .984375);\r\n        }\r\n    },\r\n\r\n    easeFromTo(pos) {\r\n        if ((pos /= 0.5) < 1)\r\n            return 0.5 * Math.pow(pos, 4);\r\n        return -0.5 * ((pos -= 2) * Math.pow(pos, 3) - 2);\r\n    },\r\n\r\n    easeFrom(pos) {\r\n        return Math.pow(pos, 4);\r\n    },\r\n\r\n    easeTo(pos) {\r\n        return Math.pow(pos, 0.25);\r\n    },\r\n\r\n    linear(pos) {\r\n        return pos\r\n    },\r\n\r\n    sinusoidal(pos) {\r\n        return (-Math.cos(pos * Math.PI) / 2) + 0.5;\r\n    },\r\n\r\n    reverse(pos) {\r\n        return 1 - pos;\r\n    },\r\n\r\n    mirror(pos, transition) {\r\n        transition = transition || this.sinusoidal;\r\n        if (pos < 0.5)\r\n            return transition(pos * 2);\r\n        else\r\n            return transition(1 - (pos - 0.5) * 2);\r\n    },\r\n\r\n    flicker(pos) {\r\n        var pos = pos + (Math.random() - 0.5) / 5;\r\n        return this.sinusoidal(pos < 0 ? 0 : pos > 1 ? 1 : pos);\r\n    },\r\n\r\n    wobble(pos) {\r\n        return (-Math.cos(pos * Math.PI * (9 * pos)) / 2) + 0.5;\r\n    },\r\n\r\n    pulse(pos, pulses) {\r\n        return (-Math.cos((pos * ((pulses || 5) - .5) * 2) * Math.PI) / 2) + .5;\r\n    },\r\n\r\n    blink(pos, blinks) {\r\n        return Math.round(pos * (blinks || 5)) % 2;\r\n    },\r\n\r\n    spring(pos) {\r\n        return 1 - (Math.cos(pos * 4.5 * Math.PI) * Math.exp(-pos * 6));\r\n    },\r\n\r\n    none(pos) {\r\n        return 0\r\n    },\r\n\r\n    full(pos) {\r\n        return 1\r\n    }\r\n}","import { uid } from \"./canvas2d\";\r\n\r\nexport class CanvasSource {\r\n\r\n    private static instanceList: CanvasSource[] = [];\r\n    private static activeCount: number = 0;\r\n\r\n    public static create() {\r\n        let instance: CanvasSource;\r\n        let { instanceList } = this;\r\n        for (let i = 0; instance = instanceList[i]; i++) {\r\n            if (instance.isIdle) {\r\n                instance.isIdle = false;\r\n                this.activeCount += 1;\r\n                return instance;\r\n            }\r\n        }\r\n        if (!instance) {\r\n            instance = new CanvasSource();\r\n            instanceList.push(instance);\r\n        }\r\n        this.activeCount += 1;\r\n        return instance;\r\n    }\r\n\r\n    private isIdle: boolean;\r\n\r\n    canvas: HTMLCanvasElement;\r\n    context: CanvasRenderingContext2D;\r\n\r\n    width: number;\r\n    height: number;\r\n\r\n    constructor() {\r\n        this.isIdle = false;\r\n        this.canvas = document.createElement('canvas');\r\n        this.context = this.canvas.getContext('2d');\r\n        this.width = this.canvas.width;\r\n        this.height = this.canvas.height;\r\n    }\r\n\r\n    setSize(width: number, height: number) {\r\n        this.canvas.width = this.width = width;\r\n        this.canvas.height = this.height = height;\r\n    }\r\n\r\n    clear() {\r\n        this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);\r\n    }\r\n\r\n    recycle() {\r\n        CanvasSource.activeCount -= 1;\r\n        this.setSize(0, 0);\r\n        this.isIdle = true;\r\n    }\r\n}","﻿import { CanvasSource } from \"./CanvasSource\";\r\n\r\nexport type Rect = {\r\n    x: number;\r\n    y: number;\r\n    width: number;\r\n    height: number;\r\n}\r\n\r\n/**\r\n * Sprite texture\r\n */\r\nexport class Texture {\r\n\r\n    private static textureCache: { [index: string]: Texture } = {};\r\n    private static loadingImages: { [index: string]: HTMLImageElement } = {};\r\n    private static loadedImages: { [path: string]: HTMLImageElement } = {};\r\n\r\n    private _readyCallbacks: any[] = [];\r\n    private _gridSourceCache: { [key: string]: CanvasSource } = {};\r\n    private _gridSourceCount = 0;\r\n\r\n    public static retryTimes: number = 2;\r\n    public static version: string;\r\n\r\n    public static create(source: string | HTMLCanvasElement | HTMLImageElement, sourceRect?: Rect, textureRect?: Rect): Texture {\r\n        var name = getCacheKey(source, sourceRect, textureRect);\r\n\r\n        if (name && this.textureCache[name]) {\r\n            return this.textureCache[name];\r\n        }\r\n\r\n        return new Texture(source, sourceRect, textureRect);\r\n    }\r\n\r\n    public static getByName(name: string) {\r\n        return this.textureCache[name];\r\n    }\r\n\r\n    /**\r\n     * 缓存Texture实例\r\n     */\r\n    public static cacheAs(name: string, texture: Texture) {\r\n        this.textureCache[name] = texture;\r\n    }\r\n\r\n    /**\r\n     * 清除缓存\r\n     */\r\n    public static clearCache(name?: string) {\r\n        if (name != null) {\r\n            let texture = this.textureCache[name];\r\n            if (texture) {\r\n                texture.clearCacheGridSources();\r\n            }\r\n            delete this.textureCache[name];\r\n        }\r\n        else {\r\n            this.textureCache = {};\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Texture resource loading state\r\n     */\r\n    ready: boolean = false;\r\n\r\n    width: number = 0;\r\n    height: number = 0;\r\n    name: string;\r\n\r\n    source: HTMLCanvasElement | HTMLImageElement | HTMLVideoElement;\r\n\r\n    private canvasSource: CanvasSource;\r\n\r\n    constructor(source: string | HTMLCanvasElement | HTMLImageElement, sourceRect?: Rect, textureRect?: Rect) {\r\n        var name: any = getCacheKey(source, sourceRect, textureRect);\r\n\r\n        if (Texture.textureCache[name]) {\r\n            return Texture.textureCache[name];\r\n        }\r\n\r\n        if (typeof source === 'string') {\r\n            this._createByPath(source, sourceRect, textureRect, Texture.retryTimes);\r\n        }\r\n        else if ((source instanceof HTMLImageElement) || (source instanceof HTMLCanvasElement)) {\r\n            this._createByImage(<HTMLImageElement>source, sourceRect, textureRect);\r\n        }\r\n        else {\r\n            throw new Error(\"Invalid texture source\");\r\n        }\r\n\r\n        if (name) {\r\n            this.name = name;\r\n            Texture.textureCache[name] = this;\r\n        }\r\n    }\r\n\r\n    public onReady(callback: (size: { width: number, height: number }) => any) {\r\n        if (this.ready) {\r\n            callback({ width: this.width, height: this.height });\r\n        }\r\n        else {\r\n            this._readyCallbacks.push(callback);\r\n        }\r\n    }\r\n\r\n    public createGridSource(w: number, h: number, sx: number, sy: number, sw: number, sh: number, grid: number[]) {\r\n        w = Math.ceil(w);\r\n        h = Math.ceil(h);\r\n\r\n        let cacheKey = [w, h, sx, sy, sw, sh, grid].join(':');\r\n\r\n        if (this._gridSourceCache[cacheKey]) {\r\n            return this._gridSourceCache[cacheKey].canvas;\r\n        }\r\n\r\n        const [top, right, bottom, left, repeat] = grid;\r\n        let grids = [\r\n            { x: 0, y: 0, w: left, h: top, sx: sx, sy: sy, sw: left, sh: top }, // left top\r\n            { x: w - right, y: 0, w: right, h: top, sx: sx + sw - right, sy: sy, sw: right, sh: top }, // right top\r\n            { x: 0, y: h - bottom, w: left, h: bottom, sx: sx, sy: sy + sh - bottom, sw: left, sh: bottom }, // left bottom\r\n            { x: w - right, y: h - bottom, w: right, h: bottom, sx: sx + sw - right, sy: sh - bottom + sy, sw: right, sh: bottom }, // right bottom\r\n            { x: left, y: 0, w: w - left - right, h: top, sx: sx + left, sy: sy, sw: sw - left - right, sh: top }, // top\r\n            { x: left, y: h - bottom, w: w - left - right, h: bottom, sx: sx + left, sy: sh - bottom + sy, sw: sw - left - right, sh: bottom }, // bottom\r\n            { x: 0, y: top, w: left, h: h - top - bottom, sx: sx, sy: top, sw: left, sh: sh - top - bottom }, // left\r\n            { x: w - right, y: top, w: right, h: h - top - bottom, sx: sx + sw - right, sy: top, sw: right, sh: sh - top - bottom }, // right\r\n        ];\r\n        let centerGrid = { x: left, y: top, w: w - left - right, h: h - top - bottom, sx: sx + left, sy: top, sw: sw - left - right, sh: sh - top - bottom };\r\n        let source = CanvasSource.create();\r\n        let canvas = source.canvas;\r\n        let context = source.context;\r\n        source.setSize(w, h);\r\n\r\n        for (let i = 0, l = grids.length; i < l; i++) {\r\n            let g = grids[i];\r\n            if (g.w && g.h) {\r\n                context.drawImage(this.source, g.sx, g.sy, g.sw, g.sh,\r\n                    Math.ceil(g.x),\r\n                    Math.ceil(g.y),\r\n                    Math.ceil(g.w),\r\n                    Math.ceil(g.h));\r\n            }\r\n        }\r\n\r\n        if (repeat) {\r\n            let cvs = getRepeatPatternSource(this.source, {\r\n                x: centerGrid.sx,\r\n                y: centerGrid.sy,\r\n                width: centerGrid.sw,\r\n                height: centerGrid.sh,\r\n            },\r\n                centerGrid.sw,\r\n                centerGrid.sh\r\n            );\r\n            let pattern = context.createPattern(cvs, \"repeat\");\r\n            context.fillStyle = pattern;\r\n            context.fillRect(Math.ceil(centerGrid.x), Math.ceil(centerGrid.y), Math.ceil(centerGrid.w), Math.ceil(centerGrid.h));\r\n        }\r\n        else if (centerGrid.w && centerGrid.h) {\r\n            context.drawImage(this.source, centerGrid.sx, centerGrid.sy, centerGrid.sw, centerGrid.sh,\r\n                Math.ceil(centerGrid.x),\r\n                Math.ceil(centerGrid.y),\r\n                Math.ceil(centerGrid.w),\r\n                Math.ceil(centerGrid.h));\r\n        }\r\n\r\n        this._gridSourceCache[cacheKey] = source;\r\n        this._gridSourceCount += 1;\r\n        return canvas;\r\n    }\r\n\r\n    public clearCacheGridSources() {\r\n        for (let k in this._gridSourceCache) {\r\n            this._gridSourceCache[k].recycle();\r\n        }\r\n        this._gridSourceCache = {};\r\n        this._gridSourceCount = 0;\r\n    }\r\n\r\n    public destroy() {\r\n        if (this.canvasSource) {\r\n            this.canvasSource.recycle();\r\n        }\r\n        this.clearCacheGridSources();\r\n        this._readyCallbacks.length = 0;\r\n        this.source = this.canvasSource = null;\r\n    }\r\n\r\n    private _createByPath(path: string, sourceRect: Rect, textureRect: Rect, retryTimes: number): void {\r\n        if (Texture.loadedImages[path]) {\r\n            return this._onImageLoaded(img, path, sourceRect, textureRect);\r\n        }\r\n        var img: HTMLImageElement = Texture.loadingImages[path] || new Image();\r\n        var onLoad = () => {\r\n            this._onImageLoaded(img, path, sourceRect, textureRect);\r\n            img.removeEventListener(\"load\", onLoad);\r\n            img.removeEventListener(\"error\", onError);\r\n        };\r\n        var onError = () => {\r\n            img.removeEventListener(\"load\", onLoad);\r\n            img.removeEventListener(\"error\", onError);\r\n            delete Texture.loadingImages[path];\r\n            img = null;\r\n            if (retryTimes) {\r\n                this._createByPath(path, sourceRect, textureRect, --retryTimes);\r\n            }\r\n            else {\r\n                this._readyCallbacks.length = 0;\r\n                if (this.name != null) {\r\n                    delete Texture.textureCache[this.name];\r\n                }\r\n            }\r\n            console.warn(`canvas2d: Texture creating fail, error loading source \"${path}\".`);\r\n        };\r\n\r\n        img.addEventListener('load', onLoad);\r\n        img.addEventListener('error', onError);\r\n\r\n        let src = Texture.version != null ? path + '?v=' + Texture.version : path;\r\n\r\n        if (!Texture.loadingImages[path]) {\r\n            img.crossOrigin = 'anonymous';\r\n            Texture.loadingImages[path] = img;\r\n            img.src = src;\r\n        }\r\n    }\r\n\r\n    private _onImageLoaded(img: HTMLImageElement, path: string, sourceRect: Rect, textureRect: Rect) {\r\n        this._createByImage(img, sourceRect, textureRect);\r\n\r\n        Texture.loadedImages[path] = img;\r\n        delete Texture.loadingImages[path];\r\n\r\n        if (this._readyCallbacks.length) {\r\n            let size = { width: this.width, height: this.height };\r\n            for (let i = 0, callback: Function; callback = this._readyCallbacks[i]; i++) {\r\n                callback(size);\r\n            }\r\n            this._readyCallbacks.length = 0;\r\n        }\r\n        img = null;\r\n    }\r\n\r\n    private _createByImage(image: HTMLImageElement, sourceRect: Rect, textureRect: Rect): void {\r\n        var source;\r\n\r\n        if (!sourceRect && !textureRect) {\r\n            source = image;\r\n        }\r\n        else {\r\n            if (!sourceRect) {\r\n                sourceRect = {\r\n                    x: 0,\r\n                    y: 0,\r\n                    width: image.width,\r\n                    height: image.height\r\n                };\r\n            }\r\n            if (!textureRect) {\r\n                textureRect = {\r\n                    x: 0,\r\n                    y: 0,\r\n                    width: sourceRect.width,\r\n                    height: sourceRect.height,\r\n                };\r\n            }\r\n\r\n            // source = createCanvas(image, sourceRect, textureRect);\r\n\r\n            let canvasSource = this.canvasSource = CanvasSource.create();\r\n            canvasSource.setSize(textureRect.width, textureRect.height);\r\n            canvasSource.context.drawImage(\r\n                image, sourceRect.x, sourceRect.y, sourceRect.width, sourceRect.height,\r\n                textureRect.x, textureRect.y, sourceRect.width, sourceRect.height);\r\n\r\n            source = canvasSource.canvas;\r\n        }\r\n\r\n        this.width = source.width;\r\n        this.height = source.height;\r\n        this.source = source;\r\n        this.ready = true;\r\n    }\r\n}\r\n\r\nfunction getCacheKey(source: any, sourceRect: Rect, textureRect: Rect): any {\r\n    var isStr = typeof source === 'string';\r\n\r\n    if (!isStr && !source.src) {\r\n        return null;\r\n    }\r\n\r\n    var src = isStr ? source : source.src;\r\n    var sourceRectStr = sourceRect ? [sourceRect.x, sourceRect.y, sourceRect.width, sourceRect.height].join(',') : '';\r\n    var textureRectStr = textureRect ? [textureRect.x, textureRect.y, textureRect.width, textureRect.height].join(',') : '';\r\n\r\n    return src + sourceRectStr + textureRectStr;\r\n}\r\n\r\n// function createCanvas(image: any, sourceRect: Rect, textureRect: Rect): HTMLCanvasElement {\r\n//     var canvas: HTMLCanvasElement = document.createElement(\"canvas\");\r\n//     var context: CanvasRenderingContext2D = canvas.getContext('2d');\r\n\r\n//     canvas.width = textureRect.width;\r\n//     canvas.height = textureRect.height;\r\n\r\n//     context.drawImage(\r\n//         image, sourceRect.x, sourceRect.y, sourceRect.width, sourceRect.height,\r\n//         textureRect.x, textureRect.y, sourceRect.width, sourceRect.height);\r\n\r\n//     return canvas;\r\n// }\r\n\r\nlet cvs: HTMLCanvasElement;\r\nlet ctx: CanvasRenderingContext2D;\r\n\r\nfunction getRepeatPatternSource(source: any, sourceRect: Rect, canvasWidth: number, canvasHeight: number) {\r\n    if (!cvs) {\r\n        cvs = document.createElement(\"canvas\");\r\n        ctx = cvs.getContext(\"2d\");\r\n    }\r\n    cvs.width = canvasWidth;\r\n    cvs.height = canvasHeight;\r\n    ctx.drawImage(\r\n        source, sourceRect.x, sourceRect.y, sourceRect.width, sourceRect.height,\r\n        0, 0, sourceRect.width, sourceRect.height\r\n    );\r\n    return cvs;\r\n}\r\n","export abstract class BaseAction {\r\n\r\n    immediate: boolean = false;\r\n    done: boolean = false;\r\n\r\n    abstract step(deltaTime: number, target: any);\r\n    abstract reset();\r\n    abstract reverse();\r\n    abstract end(target: any);\r\n    abstract destroy();\r\n}","import { BaseAction } from './BaseAction';\r\n\r\nexport class Delay extends BaseAction {\r\n\r\n    protected duration: number;\r\n    protected elapsed: number = 0;\r\n\r\n    constructor(duration: number) {\r\n        super();\r\n        this.duration = duration;\r\n    }\r\n\r\n    step(deltaTime: number): void {\r\n        this.elapsed += deltaTime;\r\n        if (this.elapsed >= this.duration) {\r\n            this.done = true;\r\n        }\r\n    }\r\n\r\n    end(): void {\r\n    }\r\n\r\n    reset() {\r\n        this.elapsed = 0;\r\n        this.done = false;\r\n    }\r\n\r\n    reverse() {\r\n        this.done = false;\r\n        this.elapsed = 0;\r\n    }\r\n\r\n    destroy() {\r\n    }\r\n}","import { BaseAction } from './BaseAction';\r\n\r\nexport class Callback extends BaseAction {\r\n\r\n    protected func: Function;\r\n    immediate: boolean = true;\r\n\r\n    constructor(func: Function) {\r\n        super();\r\n        this.func = func;\r\n    }\r\n\r\n    step(): void {\r\n        this.func.call(null);\r\n        this.end();\r\n    }\r\n\r\n    end(): void {\r\n        this.func = null;\r\n        this.done = true;\r\n    }\r\n\r\n    reset() {\r\n        this.done = false;\r\n    }\r\n\r\n    reverse() {\r\n        this.done = false;\r\n    }\r\n\r\n    destroy() {\r\n        this.func = null;\r\n    }\r\n}","import { Texture } from '../Texture';\r\nimport { BaseAction } from './BaseAction';\r\n\r\nexport class Animation extends BaseAction {\r\n\r\n    interval: number;\r\n    \r\n    protected elapsed: number = 0;\r\n    protected count: number = 0;\r\n    protected frameIndex: number = 0;\r\n    protected frameList: Array<Texture | string>;\r\n    protected repetitions: number;\r\n\r\n    constructor(frameList: Array<Texture | string>, frameRate: number, repetitions?: number) {\r\n        super();\r\n\r\n        this.frameList = frameList;\r\n        this.repetitions = repetitions;\r\n        this.interval = 1 / frameRate;\r\n    }\r\n\r\n    step(deltaTime: number, target: any) {\r\n        this.elapsed += deltaTime;\r\n\r\n        if (this.elapsed >= this.interval) {\r\n            target.texture = this.frameList[this.frameIndex++];\r\n\r\n            if (this.frameIndex === this.frameList.length) {\r\n                if (this.repetitions == null || ++this.count < this.repetitions) {\r\n                    this.frameIndex = 0;\r\n                }\r\n                else {\r\n                    this.end();\r\n                }\r\n            }\r\n\r\n            this.elapsed = 0;\r\n        }\r\n    }\r\n\r\n    end() {\r\n        this.done = true;\r\n    }\r\n\r\n    reset() {\r\n        this.done = false;\r\n        this.frameIndex = 0;\r\n        this.elapsed = 0;\r\n        this.count = 0;\r\n    }\r\n\r\n    reverse() {\r\n        this.done = false;\r\n        this.frameIndex = 0;\r\n        this.elapsed = 0;\r\n        this.count = 0;\r\n        this.frameList = this.frameList.slice().reverse();\r\n    }\r\n\r\n    destroy() {\r\n        this.frameList = null;\r\n    }\r\n}","const Key = 'canvas2d.uid';\r\n\r\nvar counter = 0;\r\nvar cachedColor: { [key: string]: string } = {};\r\n\r\nexport type Color = string | number;\r\n\r\nexport function uid(target: any) {\r\n    if (typeof target[Key] === 'undefined') {\r\n        Object.defineProperty(target, Key, { value: counter++ });\r\n    }\r\n    return target[Key];\r\n}\r\n\r\nexport function addArrayItem(array: any[], item: any) {\r\n    if (array.indexOf(item) === -1) {\r\n        array.push(item);\r\n    }\r\n}\r\n\r\nexport function removeArrayItem(array: any[], item: any) {\r\n    let index = array.indexOf(item);\r\n    if (index > -1) {\r\n        array.splice(index, 1);\r\n    }\r\n}\r\n\r\nexport function convertColor(color: string | number): string {\r\n    if (typeof color === 'string') {\r\n        return color;\r\n    }\r\n    if (cachedColor[color]) {\r\n        return cachedColor[color];\r\n    }\r\n    if (typeof color === 'number') {\r\n        let result = color.toString(16);\r\n        if (result.length < 3) {\r\n            while (result.length < 3) {\r\n                result = '0' + result;\r\n            }\r\n        }\r\n        else if (result.length > 3 && result.length < 6) {\r\n            while (result.length < 6) {\r\n                result = '0' + result;\r\n            }\r\n        }\r\n        if (result.length !== 3 && result.length !== 6) {\r\n            throw new Error(`canvas2d: Invalid hex color \"0x${result}\".`);\r\n        }\r\n        result = cachedColor[color] = '#' + result;\r\n        return result;\r\n    }\r\n}\r\n\r\nexport function hexToRgb(hex: string) {\r\n    // Expand shorthand form (e.g. \"03F\") to full form (e.g. \"0033FF\")\r\n    var shorthandRegex = /^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i;\r\n    hex = hex.replace(shorthandRegex, function (m, r, g, b) {\r\n        return r + r + g + g + b + b;\r\n    });\r\n\r\n    var result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\r\n    return result ? {\r\n        r: parseInt(result[1], 16),\r\n        g: parseInt(result[2], 16),\r\n        b: parseInt(result[3], 16)\r\n    } : null;\r\n}\r\n\r\nexport function rgbToHex(r: number, g: number, b: number) {\r\n    return \"#\" + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);\r\n}\r\n\r\n","import { Action } from './Action';\r\nimport { addArrayItem, removeArrayItem } from '../Util';\r\n\r\nexport interface IActionListener {\r\n    all(callback: Function): IActionListener;\r\n    any(callback: Function): IActionListener;\r\n}\r\n\r\nexport class ActionListener implements IActionListener {\r\n\r\n    private _resolved: boolean = false;\r\n    private _callbacks: { any?: Array<Function>; all?: Array<Function> } = {};\r\n    private _actions: Array<Action>\r\n\r\n    constructor(actions: Array<Action>) {\r\n        this._actions = actions;\r\n    }\r\n\r\n    all(callback: Function): ActionListener {\r\n        if (this._resolved) {\r\n            callback();\r\n        }\r\n        else {\r\n            if (!this._callbacks.all) {\r\n                this._callbacks.all = [];\r\n            }\r\n            addArrayItem(this._callbacks.all, callback);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    any(callback: Function): ActionListener {\r\n        if (this._resolved) {\r\n            callback();\r\n        }\r\n        else {\r\n            if (!this._callbacks.any) {\r\n                this._callbacks.any = [];\r\n            }\r\n            addArrayItem(this._callbacks.any, callback);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    _step(): void {\r\n        var allDone: boolean = true;\r\n        var anyDone: boolean = false;\r\n\r\n        for (let i = 0, action: Action; action = this._actions[i]; i++) {\r\n            if (action.isDone()) {\r\n                anyDone = true;\r\n            }\r\n            else {\r\n                allDone = false;\r\n            }\r\n        }\r\n\r\n        if (anyDone && this._callbacks.any) {\r\n            for (let i = 0, callback: Function; callback = this._callbacks.any[i]; i++) {\r\n                callback();\r\n            }\r\n            this._callbacks.any = null;\r\n        }\r\n\r\n        if (allDone && this._callbacks.all) {\r\n            for (let i = 0, callback: Function; callback = this._callbacks.all[i]; i++) {\r\n                callback();\r\n            }\r\n            Action.removeListener(this);\r\n            this._resolved = true;\r\n        }\r\n    }\r\n}","import { Tween, EasingFunc } from '../Tween';\r\nimport { BaseAction } from './BaseAction';\r\n\r\nexport type TransToProps = {\r\n    [name: string]: number | { dest: number; easing: EasingFunc; }\r\n}\r\n\r\nexport type TransByProps = {\r\n    [name: string]: number | { value: number; easing: EasingFunc; }\r\n}\r\n\r\nexport type TransOption = { name: string; dest: number; easing: EasingFunc; };\r\n\r\nexport class Transition extends BaseAction {\r\n\r\n    public static defaultEasingFunc = Tween.easeInOutQuad;\r\n\r\n    public static setDefaultEasingFunc(func: EasingFunc) {\r\n        this.defaultEasingFunc = func;\r\n    }\r\n\r\n    protected elapsed: number = 0;\r\n    protected duration: number;\r\n\r\n    protected isTransitionBy: boolean;\r\n\r\n    protected options: TransOption[];\r\n    protected beginValue: { [name: string]: number };\r\n    protected deltaValue: { [name: string]: number };\r\n\r\n    constructor(options: any, duration: number, isTransitionBy?: boolean) {\r\n        super();\r\n\r\n        this.options = [];\r\n        this.deltaValue = {};\r\n        this.duration = duration;\r\n        this.isTransitionBy = isTransitionBy;\r\n\r\n        if (isTransitionBy) {\r\n            this._initAsTransitionBy(options);\r\n        }\r\n        else {\r\n            this._initAsTransitionTo(options);\r\n        }\r\n    }\r\n\r\n    private _initAsTransitionTo(options: TransToProps) {\r\n        for (let name in options) {\r\n            let info = options[name];\r\n            let easing: EasingFunc;\r\n            let dest: number;\r\n\r\n            if (typeof info === 'number') {\r\n                dest = info;\r\n            }\r\n            else {\r\n                easing = info.easing;\r\n                dest = info.dest;\r\n            }\r\n\r\n            this.options.push({ name, dest, easing });\r\n        }\r\n    }\r\n\r\n    private _initAsTransitionBy(options: TransByProps) {\r\n        let deltaValue = this.deltaValue;\r\n\r\n        for (let name in options) {\r\n            let info = options[name];\r\n            let easing: EasingFunc;\r\n            let dest: number;\r\n\r\n            if (typeof info === 'number') {\r\n                deltaValue[name] = info;\r\n            }\r\n            else {\r\n                easing = info.easing;\r\n                deltaValue[name] = info.value;\r\n            }\r\n\r\n            this.options.push({ name, dest, easing });\r\n        }\r\n    }\r\n\r\n    private _initBeginValue(target: any) {\r\n        let beginValue = this.beginValue = {};\r\n        let deltaValue = this.deltaValue;\r\n\r\n        if (this.isTransitionBy) {\r\n            for (let i = 0, option: TransOption; option = this.options[i]; i++) {\r\n                beginValue[option.name] = target[option.name];\r\n                option.dest = target[option.name] + deltaValue[option.name];\r\n            }\r\n        }\r\n        else {\r\n            for (let i = 0, option: TransOption; option = this.options[i]; i++) {\r\n                beginValue[option.name] = target[option.name];\r\n                deltaValue[option.name] = option.dest - target[option.name];\r\n            }\r\n        }\r\n    }\r\n\r\n    step(deltaTime: number, target: any): void {\r\n        this.elapsed += deltaTime;\r\n\r\n        if (this.beginValue == null) {\r\n            this._initBeginValue(target);\r\n        }\r\n\r\n        if (this.elapsed >= this.duration) {\r\n            return this.end(target);\r\n        }\r\n\r\n        var percent = this.elapsed / this.duration;\r\n        var beginValue = this.beginValue;\r\n        var deltaValue = this.deltaValue;\r\n\r\n        for (let i = 0, option: TransOption; option = this.options[i]; i++) {\r\n            let { name, dest, easing } = option;\r\n            easing = easing || Transition.defaultEasingFunc;\r\n            target[name] = beginValue[name] + (easing(percent) * deltaValue[name]);\r\n        }\r\n    }\r\n\r\n    end(target: any): void {\r\n        for (let i = 0, option: TransOption; option = this.options[i]; i++) {\r\n            target[option.name] = option.dest;\r\n        }\r\n        this.done = true;\r\n    }\r\n\r\n    destroy() {\r\n        this.beginValue = null;\r\n        this.deltaValue = null;\r\n        this.options = null;\r\n    }\r\n\r\n    reset() {\r\n        this.done = false;\r\n        this.elapsed = 0;\r\n    }\r\n\r\n    reverse() {\r\n        this.done = false;\r\n        this.elapsed = 0;\r\n\r\n        const { options, beginValue, deltaValue } = this;\r\n\r\n        for (let i = 0, option: TransOption; option = options[i]; i++) {\r\n            let dest = beginValue[option.name];\r\n            beginValue[option.name] = option.dest;\r\n            deltaValue[option.name] = -deltaValue[option.name];\r\n            option.dest = dest;\r\n        }\r\n    }\r\n}","﻿import { Texture } from '../Texture';\r\nimport { Delay } from './Delay';\r\nimport { Callback } from './Callback';\r\nimport { Animation } from './Animation';\r\nimport { Tween, EasingFunc } from '../Tween';\r\nimport { IActionListener, ActionListener } from './ActionListener';\r\nimport { TransByProps, TransToProps, Transition } from './Transition';\r\nimport { addArrayItem, removeArrayItem } from '../Util';\r\nimport { BaseAction } from './BaseAction';\r\n\r\nexport enum ActionType {\r\n    TO,\r\n    BY,\r\n    ANIM,\r\n    WAIT,\r\n    CALLBACK,\r\n}\r\n\r\nexport type TransToAction = {\r\n    type: ActionType.TO;\r\n    options: TransToProps;\r\n    duration: number;\r\n};\r\n\r\nexport type TransByAction = {\r\n    type: ActionType.BY;\r\n    options: TransByProps;\r\n    duration: number;\r\n};\r\n\r\nexport type AnimationAction = {\r\n    type: ActionType.ANIM;\r\n    frameList: Array<Texture | string>;\r\n    frameRate: number;\r\n    repetitions?: number;\r\n}\r\n\r\nexport type WaitAction = {\r\n    type: ActionType.WAIT;\r\n    duration: number;\r\n}\r\n\r\nexport type CallbackAction = {\r\n    type: ActionType.CALLBACK;\r\n    callback: Function;\r\n}\r\n\r\nexport type ActionQueue = Array<TransToAction | TransByAction | AnimationAction | WaitAction | CallbackAction>;\r\n\r\nexport enum ActionRepeatMode {\r\n    NONE,\r\n    REPEAT,\r\n    REVERSE_REPEAT,\r\n}\r\n\r\nexport class Action {\r\n\r\n    private static _actionList: Array<Action> = [];\r\n    private static _listenerList: Array<IActionListener> = [];\r\n    private static _scheduleCostTime: number = 0;\r\n    public static get scheduleCostTime() {\r\n        return this._scheduleCostTime;\r\n    }\r\n\r\n    /**\r\n     * Stop action by target\r\n     */\r\n    public static stop(target: any, tag?: string) {\r\n        let list = Action._actionList.slice();\r\n        for (let i = 0, action: Action; action = list[i]; i++) {\r\n            if (action.target === target) {\r\n                if (tag == null || action.tag == tag) {\r\n                    action.stop();\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Listen a action list, when all actions are done then publish to listener\r\n     */\r\n    public static listen(actions: Array<Action>): IActionListener {\r\n        var listener = new ActionListener(actions);\r\n        Action._listenerList.push(listener);\r\n        return listener;\r\n    }\r\n\r\n    public static removeListener(listener: IActionListener) {\r\n        removeArrayItem(this._listenerList, this);\r\n    }\r\n\r\n    public static schedule(deltaTime: number): void {\r\n        var startTime = Date.now();\r\n        var actionList = Action._actionList.slice();\r\n        var listenerList = Action._listenerList.slice() as ActionListener[];\r\n\r\n        for (let i = 0, action: Action; action = actionList[i]; i++) {\r\n            action._step(deltaTime);\r\n\r\n            if (action._done) {\r\n                removeArrayItem(Action._actionList, action);\r\n            }\r\n        }\r\n\r\n        for (let i = 0, listener: ActionListener; listener = listenerList[i]; i++) {\r\n            listener._step();\r\n        }\r\n\r\n        Action._scheduleCostTime = Date.now() - startTime;\r\n    }\r\n\r\n    protected _queue: Array<BaseAction> = [];\r\n    protected _currentIndex: number = 0;\r\n    protected _done: boolean = false;\r\n    protected _repeatMode: ActionRepeatMode = ActionRepeatMode.NONE;\r\n\r\n    /**\r\n     * Action running state\r\n     */\r\n    public isRunning: boolean = false;\r\n    public target: any;\r\n    public tag: string;\r\n\r\n    constructor(target: any, tag?: string) {\r\n        this.target = target;\r\n        this.tag = tag;\r\n    }\r\n\r\n    isDone() {\r\n        return this._done;\r\n    }\r\n\r\n    setRepeatMode(mode: ActionRepeatMode) {\r\n        this._repeatMode = mode;\r\n        return this;\r\n    }\r\n\r\n    set repeatMode(mode: ActionRepeatMode) {\r\n        this._repeatMode = mode;\r\n    }\r\n\r\n    get repeatMode() {\r\n        return this._repeatMode;\r\n    }\r\n\r\n    queue(actions: ActionQueue) {\r\n        for (let i = 0, action: ActionQueue[0]; action = actions[i]; i++) {\r\n            switch (action.type) {\r\n                case ActionType.ANIM:\r\n                    this.animate(action.frameList, action.frameRate, action.repetitions);\r\n                    break;\r\n                case ActionType.BY:\r\n                    this.by(action.options, action.duration);\r\n                    break;\r\n                case ActionType.TO:\r\n                    this.to(action.options, action.duration);\r\n                    break;\r\n                case ActionType.WAIT:\r\n                    this.wait(action.duration);\r\n                    break;\r\n                case ActionType.CALLBACK:\r\n                    this.then(action.callback);\r\n                    break;\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Add a callback, it will exec after previous action is done.\r\n     */\r\n    then(callback: Function): Action {\r\n        this._queue.push(new Callback(callback));\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Add a delay action.\r\n     */\r\n    wait(time: number): Action {\r\n        this._queue.push(new Delay(time));\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Add a animation action\r\n     */\r\n    animate(frameList: Array<Texture | string>, frameRate: number, repetitions?: number): Action {\r\n        var anim = new Animation(frameList, frameRate, repetitions);\r\n        this._queue.push(anim);\r\n        anim.step(anim.interval, this.target);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * TransitionTo action\r\n     */\r\n    to(attrs: TransToProps, duration: number): Action {\r\n        this._queue.push(new Transition(attrs, duration));\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * TransitionBy action\r\n     */\r\n    by(attrs: TransByProps, duration: number): Action {\r\n        this._queue.push(new Transition(attrs, duration, true));\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Start the action\r\n     */\r\n    start(): Action {\r\n        if (!this.isRunning) {\r\n            addArrayItem(Action._actionList, this);\r\n            this.isRunning = true;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Stop the action\r\n     */\r\n    stop() {\r\n        for (let i = 0, action: BaseAction; action = this._queue[i]; i++) {\r\n            action.destroy();\r\n        }\r\n\r\n        this._done = true;\r\n        this.isRunning = false;\r\n        this._queue.length = 0;\r\n\r\n        removeArrayItem(Action._actionList, this);\r\n    }\r\n\r\n    clear() {\r\n        for (let i = 0, action: BaseAction; action = this._queue[i]; i++) {\r\n            action.destroy();\r\n        }\r\n\r\n        this._done = false;\r\n        this.isRunning = false;\r\n        this._queue.length = 0;\r\n        this._currentIndex = 0;\r\n        this._repeatMode = ActionRepeatMode.NONE;\r\n\r\n        removeArrayItem(Action._actionList, this);\r\n    }\r\n\r\n    protected _step(deltaTime: number): void {\r\n        if (!this._queue.length || this._currentIndex >= this._queue.length) {\r\n            return;\r\n        }\r\n\r\n        var action = this._queue[this._currentIndex];\r\n\r\n        action.step(deltaTime, this.target);\r\n\r\n        if (action.done) {\r\n            this._currentIndex += 1;\r\n\r\n            if (this._currentIndex >= this._queue.length) {\r\n                this._onAllActionDone();\r\n            }\r\n            else if (action.immediate) {\r\n                this._step(deltaTime);\r\n            }\r\n        }\r\n    }\r\n\r\n    protected _onAllActionDone() {\r\n        switch (this._repeatMode) {\r\n            case ActionRepeatMode.REPEAT:\r\n                for (let i = 0, action: BaseAction; action = this._queue[i]; i++) {\r\n                    action.reset();\r\n                }\r\n                this._currentIndex = 0;\r\n                break;\r\n            case ActionRepeatMode.REVERSE_REPEAT:\r\n                for (let i = 0, action: BaseAction; action = this._queue[i]; i++) {\r\n                    action.reverse();\r\n                }\r\n                this._currentIndex = 0;\r\n                break;\r\n            default:\r\n                this._done = true;\r\n                this.isRunning = false;\r\n                this.target = null;\r\n                for (let i = 0, action: BaseAction; action = this._queue[i]; i++) {\r\n                    action.destroy();\r\n                }\r\n                this._queue.length = 0;\r\n                break;\r\n        }\r\n    }\r\n}","import { uid, addArrayItem, removeArrayItem } from './Util';\r\n\r\nexport type EventListener = (...args: any[]) => any;\r\n\r\nexport class EventEmitter {\r\n\r\n    private static _eventCache: {\r\n        [id: number]: {\r\n            [type: string]: {\r\n                listener: EventListener;\r\n                once?: boolean;\r\n            }[]\r\n        }\r\n    } = {};\r\n\r\n    addListener(type: string, listener: EventListener) {\r\n        if (typeof listener !== 'function') {\r\n            return this;\r\n        }\r\n        let id = uid(this);\r\n        if (!EventEmitter._eventCache[id]) {\r\n            EventEmitter._eventCache[id] = {};\r\n        }\r\n        if (!EventEmitter._eventCache[id][type]) {\r\n            EventEmitter._eventCache[id][type] = [];\r\n        }\r\n        let events = EventEmitter._eventCache[id][type];\r\n        for (let i = 0, ev; ev = events[i]; i++) {\r\n            if (ev.listener === listener && !ev.once) {\r\n                return this;\r\n            }\r\n        }\r\n        events.push({ listener });\r\n        return this;\r\n    }\r\n\r\n    on(type: string, listener: EventListener) {\r\n        return this.addListener(type, listener);\r\n    }\r\n\r\n    once(type: string, listener: EventListener) {\r\n        if (typeof listener !== 'function') {\r\n            return this;\r\n        }\r\n        let id = uid(this);\r\n        if (!EventEmitter._eventCache[id]) {\r\n            EventEmitter._eventCache[id] = {};\r\n        }\r\n        if (!EventEmitter._eventCache[id][type]) {\r\n            EventEmitter._eventCache[id][type] = [];\r\n        }\r\n        let events = EventEmitter._eventCache[id][type];\r\n        for (let i = 0, ev; ev = events[i]; i++) {\r\n            if (ev.listener === listener && ev.once) {\r\n                return this;\r\n            }\r\n        }\r\n        events.push({ listener, once: true });\r\n        return this;\r\n    }\r\n\r\n    removeListener(type: string, listener: EventListener) {\r\n        let cache = EventEmitter._eventCache[uid(this)];\r\n\r\n        if (cache && cache[type]) {\r\n            let events = cache[type];\r\n            let temp = events.slice();\r\n            for (let i = 0, l = temp.length; i < l; i++) {\r\n                let ev = temp[i];\r\n                if (ev.listener === listener) {\r\n                    removeArrayItem(events, ev);\r\n                }\r\n            }\r\n            if (!events.length) {\r\n                delete cache[type];\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    removeAllListeners(type?: string) {\r\n        let id = uid(this);\r\n        let cache = EventEmitter._eventCache[id];\r\n\r\n        if (cache) {\r\n            if (type == null) {\r\n                EventEmitter._eventCache[id] = null;\r\n            }\r\n            else {\r\n                delete cache[type];\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    hasListener(type: string) {\r\n        let id = uid(this);\r\n        let eventCache = EventEmitter._eventCache;\r\n        if (!eventCache[id] || !eventCache[id][type] || !eventCache[id][type].length) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    emit(type: string, ...args: any[]) {\r\n        let id = uid(this);\r\n        let cache = EventEmitter._eventCache[id];\r\n\r\n        if (cache && cache[type]) {\r\n            let events = cache[type];\r\n            let temp = events.slice();\r\n            for (let i = 0, l = temp.length; i < l; i++) {\r\n                let ev = temp[i];\r\n                if (ev) {\r\n                    if (typeof ev.listener === 'function') {\r\n                        ev.listener.apply(this, args);\r\n                    }\r\n                    if (ev.once) {\r\n                        removeArrayItem(events, ev);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n}","var instance: ReleasePool;\r\n\r\nexport class ReleasePool {\r\n\r\n    private _objs: Object[] = [];\r\n    private _timerId: number;\r\n\r\n    add(obj: Object) {\r\n        this._objs.push(obj);\r\n        if (this._timerId != null) {\r\n            return;\r\n        }\r\n        this._timerId = setTimeout(() => this._release(), 0);\r\n    }\r\n\r\n    private _release() {\r\n        for (let i = 0, obj; obj = this._objs[i]; i++) {\r\n            for (let key in obj) {\r\n                delete obj[key]\r\n            }\r\n        }\r\n        this._timerId = null;\r\n        this._objs.length = 0;\r\n    }\r\n\r\n    static get instance() {\r\n        if (!instance) {\r\n            instance = new ReleasePool();\r\n        }\r\n        return instance;\r\n    }\r\n}","import { EventHelper, UIEvent } from '../UIEvent';\r\nimport { Color, convertColor, uid } from '../Util';\r\nimport { Action } from '../action/Action';\r\nimport { Texture } from '../Texture';\r\nimport { EventEmitter } from '../EventEmitter';\r\nimport { ReleasePool } from '../ReleasePool';\r\nimport { Stage } from '../Stage';\r\nimport { SpriteProps } from '../createSprite';\r\n// import { CanvasFrameBuffer } from '../framebuffer/CanvasFrameBuffer';\r\n\r\nexport const RAD_PER_DEG: number = Math.PI / 180;\r\n\r\nexport enum AlignType {\r\n    TOP,\r\n    RIGHT,\r\n    BOTTOM,\r\n    LEFT,\r\n    CENTER\r\n}\r\n\r\nexport enum BlendMode {\r\n    SOURCE_IN,\r\n    SOURCE_OVER,\r\n    SOURCE_ATOP,\r\n    SOURCE_OUT,\r\n    DESTINATION_OVER,\r\n    DESTINATION_IN,\r\n    DESTINATION_OUT,\r\n    DESTINATION_ATOP,\r\n    LIGHTER,\r\n    COPY,\r\n    XOR,\r\n}\r\n\r\nexport const BlendModeStrings = {\r\n    [BlendMode.SOURCE_IN]: \"source-in\",\r\n    [BlendMode.SOURCE_OVER]: \"source-over\",\r\n    [BlendMode.SOURCE_ATOP]: \"source-atop\",\r\n    [BlendMode.SOURCE_OUT]: \"source-out\",\r\n    [BlendMode.DESTINATION_OVER]: \"destination-over\",\r\n    [BlendMode.DESTINATION_IN]: \"destination-in\",\r\n    [BlendMode.DESTINATION_OUT]: \"destination-out\",\r\n    [BlendMode.DESTINATION_ATOP]: \"destination-atop\",\r\n    [BlendMode.LIGHTER]: \"lighter\",\r\n    [BlendMode.COPY]: \"copy\",\r\n    [BlendMode.XOR]: \"xor\",\r\n}\r\n\r\n\r\nexport class Sprite<T extends ISprite> extends EventEmitter {\r\n\r\n    protected _props: T & SpriteProps; // Define for tsx\r\n\r\n    protected _width: number = 0;\r\n    protected _height: number = 0;\r\n    protected _originX: number = 0.5;\r\n    protected _originY: number = 0.5;\r\n    protected _rotation: number = 0;\r\n    protected _rotationInRadians: number = 0;\r\n    protected _texture: Texture;\r\n    protected _alignX: AlignType;\r\n    protected _alignY: AlignType;\r\n    protected _parent: Sprite<{}>;\r\n    protected _stage: Stage;\r\n\r\n    protected _top: number;\r\n    protected _right: number;\r\n    protected _bottom: number;\r\n    protected _left: number;\r\n\r\n    protected _percentWidth: number;\r\n    protected _percentHeight: number;\r\n\r\n    protected _originPixelX: number = 0;\r\n    protected _originPixelY: number = 0;\r\n\r\n    protected _grid: number[];\r\n\r\n    // protected _canvasFrameBuffer: CanvasFrameBuffer;\r\n\r\n    id: number;\r\n\r\n    x: number = 0;\r\n    y: number = 0;\r\n    scaleX: number = 1;\r\n    scaleY: number = 1;\r\n    radius: number = 0;\r\n    opacity: number = 1;\r\n    sourceX: number = 0;\r\n    sourceY: number = 0;\r\n    sourceWidth: number;\r\n    sourceHeight: number;\r\n    autoResize: boolean = true;\r\n    flippedX: boolean = false;\r\n    flippedY: boolean = false;\r\n    visible: boolean = true;\r\n    clipOverflow: boolean = false;\r\n    bgColor: Color;\r\n    borderColor: Color;\r\n    borderWidth: number;\r\n    children: Sprite<{}>[];\r\n    blendMode: BlendMode;\r\n\r\n    touchEnabled: boolean = true;\r\n    mouseEnabled: boolean = true;\r\n\r\n    onClick: ISprite[\"onClick\"];\r\n    onMouseBegin: ISprite[\"onMouseBegin\"];\r\n    onMouseMoved: ISprite[\"onMouseMoved\"];\r\n    onMouseEnded: ISprite[\"onMouseEnded\"];\r\n    onTouchBegin: ISprite[\"onTouchBegin\"];\r\n    onTouchMoved: ISprite[\"onTouchMoved\"];\r\n    onTouchEnded: ISprite[\"onTouchEnded\"];\r\n\r\n    constructor(props?: T & SpriteProps) {\r\n        super();\r\n        this.id = uid(this);\r\n        // this._canvasFrameBuffer = CanvasFrameBuffer.create(this.id);\r\n        this._init(props);\r\n    }\r\n\r\n    protected _init(props?: T & SpriteProps) {\r\n        if (props) {\r\n            this.setProps(props);\r\n        }\r\n    }\r\n\r\n    setProps(props: T & SpriteProps) {\r\n        for (let key in props) {\r\n            this[key as any] = props[key];\r\n        }\r\n    }\r\n\r\n    // get canvasFrameBuffer() {\r\n    //     return this._canvasFrameBuffer;\r\n    // }\r\n\r\n    get rotationInRadians() {\r\n        return this._rotationInRadians;\r\n    }\r\n\r\n    get originPixelX() {\r\n        return this._originPixelX;\r\n    }\r\n\r\n    get originPixelY() {\r\n        return this._originPixelY;\r\n    }\r\n\r\n    set width(value: number) {\r\n        if (this._width === value) {\r\n            return;\r\n        }\r\n\r\n        this._width = value;\r\n        this._originPixelX = this._width * this._originX;\r\n\r\n        if (this.left != null || this.right != null) {\r\n            this._reCalcX();\r\n        }\r\n        else {\r\n            this._adjustAlignX();\r\n        }\r\n\r\n        this._reLayoutChildrenOnWidthChanged();\r\n        this._onChildResize();\r\n    }\r\n\r\n    get width(): number {\r\n        return this._width;\r\n    }\r\n\r\n    set height(value: number) {\r\n        if (this._height === value) {\r\n            return;\r\n        }\r\n\r\n        this._height = value;\r\n        this._originPixelY = this._height * this._originY;\r\n\r\n        if (this.top != null || this.bottom != null) {\r\n            this._reCalcY();\r\n        }\r\n        else {\r\n            this._adjustAlignY();\r\n        }\r\n\r\n        this._reLayoutChildrenOnHeightChanged();\r\n        this._onChildResize();\r\n    }\r\n\r\n    get height(): number {\r\n        return this._height;\r\n    }\r\n\r\n    set originX(value: number) {\r\n        if (this._originX === value) {\r\n            return;\r\n        }\r\n\r\n        this._originX = value;\r\n        this._originPixelX = this._originX * this._width;\r\n        if (this.left != null || this.right != null) {\r\n            this._reCalcX();\r\n        }\r\n        else {\r\n            this._adjustAlignX();\r\n        }\r\n    }\r\n\r\n    get originX(): number {\r\n        return this._originX;\r\n    }\r\n\r\n    set originY(value: number) {\r\n        if (this._originY === value) {\r\n            return;\r\n        }\r\n\r\n        this._originY = value;\r\n        this._originPixelY = this._originY * this._height;\r\n        if (this.top != null || this.bottom != null) {\r\n            this._reCalcY();\r\n        }\r\n        else {\r\n            this._adjustAlignY();\r\n        }\r\n    }\r\n\r\n    get originY(): number {\r\n        return this._originY;\r\n    }\r\n\r\n    get top() {\r\n        return this._top;\r\n    }\r\n\r\n    set top(top: number) {\r\n        this.autoResize = false;\r\n        this._top = top;\r\n        this._resizeHeight();\r\n    }\r\n\r\n    get right() {\r\n        return this._right;\r\n    }\r\n\r\n    set right(right: number) {\r\n        this.autoResize = false;\r\n        this._right = right;\r\n        this._resizeWidth();\r\n    }\r\n\r\n    get bottom() {\r\n        return this._bottom;\r\n    }\r\n\r\n    set bottom(bottom: number) {\r\n        this.autoResize = false;\r\n        this._bottom = bottom;\r\n        this._resizeHeight();\r\n    }\r\n\r\n    get left() {\r\n        return this._left;\r\n    }\r\n\r\n    set left(left: number) {\r\n        this.autoResize = false;\r\n        this._left = left;\r\n        this._resizeWidth();\r\n    }\r\n\r\n    get percentWidth() {\r\n        return this._percentWidth;\r\n    }\r\n\r\n    set percentWidth(percentWidth: number) {\r\n        this.autoResize = false;\r\n        this._percentWidth = percentWidth;\r\n        this._resizeWidth();\r\n    }\r\n\r\n    get percentHeight() {\r\n        return this._percentHeight;\r\n    }\r\n\r\n    set percentHeight(percentHeight: number) {\r\n        this.autoResize = false;\r\n        this._percentHeight = percentHeight;\r\n        this._resizeHeight();\r\n    }\r\n\r\n    get grid() {\r\n        return this._grid;\r\n    }\r\n\r\n    set grid(grid: number[]) {\r\n        this._grid = grid;\r\n        this.autoResize = false;\r\n    }\r\n\r\n    set rotation(value: number) {\r\n        if (this._rotation === value) {\r\n            return;\r\n        }\r\n\r\n        this._rotation = value;\r\n        this._rotationInRadians = this._rotation * RAD_PER_DEG;\r\n    }\r\n\r\n    get rotation(): number {\r\n        return this._rotation;\r\n    }\r\n\r\n    set texture(value: Texture | string) {\r\n        let texture: Texture;\r\n\r\n        if (typeof value === 'string') {\r\n            texture = Texture.create(value);\r\n        }\r\n        else {\r\n            texture = value;\r\n        }\r\n        if (texture === this._texture) {\r\n            return;\r\n        }\r\n\r\n        this._texture = texture;\r\n\r\n        if (!this.autoResize) {\r\n            return;\r\n        }\r\n\r\n        if (texture) {\r\n            if (texture.ready) {\r\n                this.width = texture.width;\r\n                this.height = texture.height;\r\n            }\r\n            else {\r\n                texture.onReady((size) => {\r\n                    if (this.autoResize || (this.width === 0 && this.height === 0)) {\r\n                        this.width = size.width;\r\n                        this.height = size.height;\r\n                    }\r\n                });\r\n            }\r\n        }\r\n        else {\r\n            this.width = 0;\r\n            this.height = 0;\r\n        }\r\n    }\r\n\r\n    get texture() {\r\n        return this._texture;\r\n    }\r\n\r\n    set parent(sprite: Sprite<{}>) {\r\n        if (sprite === this._parent) {\r\n            return;\r\n        }\r\n\r\n        this._parent = sprite;\r\n    }\r\n\r\n    get parent() {\r\n        return this._parent;\r\n    }\r\n\r\n    get stage() {\r\n        return this._stage;\r\n    }\r\n\r\n    set stage(stage: Stage) {\r\n        if (stage == null) {\r\n            this.emit(UIEvent.REMOVED_FROM_STAGE);\r\n            this._stage = stage;\r\n        }\r\n        else {\r\n            this._stage = stage;\r\n            this.emit(UIEvent.ADD_TO_STAGE);\r\n        }\r\n        if (this.children) {\r\n            for (let i = 0, child: Sprite<{}>; child = this.children[i]; i++) {\r\n                child.stage = stage;\r\n            }\r\n        }\r\n    }\r\n\r\n    set alignX(value: AlignType) {\r\n        if (this._alignX === value || value === AlignType.BOTTOM || value === AlignType.TOP) {\r\n            return;\r\n        }\r\n        this._alignX = value;\r\n        this._adjustAlignX();\r\n    }\r\n\r\n    get alignX() {\r\n        return this._alignX;\r\n    }\r\n\r\n    set alignY(value: AlignType) {\r\n        if (this._alignY === value || value === AlignType.LEFT || value === AlignType.RIGHT) {\r\n            return;\r\n        }\r\n        this._alignY = value;\r\n        this._adjustAlignY();\r\n    }\r\n\r\n    get alignY() {\r\n        return this._alignY;\r\n    }\r\n\r\n    protected _onChildResize() {\r\n        if (this.parent) {\r\n            this.parent._onChildResize();\r\n        }\r\n    }\r\n\r\n    protected _update(deltaTime: number): void {\r\n        this.emit(UIEvent.FRAME, deltaTime);\r\n        this.update(deltaTime);\r\n\r\n        if (this.children && this.children.length) {\r\n            let list = this.children.slice();\r\n            for (let i = 0, child: Sprite<{}>; child = list[i]; i++) {\r\n                child._update(deltaTime);\r\n            }\r\n        }\r\n    }\r\n\r\n    protected _reLayoutChildrenOnWidthChanged() {\r\n        if (!this.children || !this.children.length) {\r\n            return;\r\n        }\r\n        for (let i = 0, child: Sprite<{}>; child = this.children[i]; i++) {\r\n            child._resizeWidth();\r\n            child._adjustAlignX();\r\n        }\r\n    }\r\n\r\n    protected _reLayoutChildrenOnHeightChanged() {\r\n        if (!this.children || !this.children.length) {\r\n            return;\r\n        }\r\n        for (let i = 0, child: Sprite<{}>; child = this.children[i]; i++) {\r\n            child._resizeHeight();\r\n            child._adjustAlignY();\r\n        }\r\n    }\r\n\r\n    protected _resizeWidth() {\r\n        if (this.parent == null) {\r\n            return;\r\n        }\r\n        const { parent, percentWidth, right, left } = this;\r\n\r\n        if (left != null && right != null) {\r\n            this.width = parent.width - left - right;\r\n        }\r\n        else if (percentWidth != null) {\r\n            this.width = parent.width * percentWidth;\r\n        }\r\n\r\n        this._reCalcX();\r\n    }\r\n\r\n    protected _reCalcX() {\r\n        const { left, right, parent, width, _originPixelX } = this;\r\n        if (left != null) {\r\n            this.x = left + _originPixelX;\r\n        }\r\n        else if (right != null && parent != null) {\r\n            this.x = parent.width - (width + right - _originPixelX);\r\n        }\r\n    }\r\n\r\n    protected _resizeHeight() {\r\n        if (this.parent == null) {\r\n            return;\r\n        }\r\n        const { parent, percentHeight, top, bottom } = this;\r\n        if (top != null && bottom != null) {\r\n            this.height = parent.height - top - bottom;\r\n            this.y = top + this._originPixelY;\r\n            return;\r\n        }\r\n\r\n        if (percentHeight != null) {\r\n            this.height = parent.height * percentHeight;\r\n        }\r\n\r\n        this._reCalcY();\r\n    }\r\n\r\n    protected _reCalcY() {\r\n        const { top, bottom, parent, height, _originPixelY } = this;\r\n        if (top != null) {\r\n            this.y = top + _originPixelY;\r\n        }\r\n        else if (bottom != null && parent != null) {\r\n            this.y = parent.height - (height + bottom - _originPixelY);\r\n        }\r\n    }\r\n\r\n    protected _adjustAlignX() {\r\n        if (!this.parent || this._alignX == null || this.left != null || this.right != null) {\r\n            return false;\r\n        }\r\n\r\n        let x: number;\r\n        let ox = this._originPixelX;\r\n\r\n        switch (this._alignX) {\r\n            case AlignType.LEFT:\r\n                x = ox;\r\n                break;\r\n            case AlignType.RIGHT:\r\n                x = this.parent.width - (this.width - ox);\r\n                break;\r\n            case AlignType.CENTER:\r\n                x = this.parent.width * 0.5 + ox - this.width * 0.5;\r\n                break;\r\n        }\r\n\r\n        if (x != null) {\r\n            this.x = x;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    protected _adjustAlignY() {\r\n        if (!this.parent || this._alignY == null || this.top != null || this.bottom != null) {\r\n            return false;\r\n        }\r\n\r\n        let y: number;\r\n        let oy = this._originPixelY;\r\n\r\n        switch (this._alignY) {\r\n            case AlignType.TOP:\r\n                y = oy;\r\n                break;\r\n            case AlignType.BOTTOM:\r\n                y = this.parent.height - (this.height - oy);\r\n                break;\r\n            case AlignType.CENTER:\r\n                y = this.parent.height * 0.5 + oy - this.height * 0.5;\r\n                break;\r\n        }\r\n\r\n        if (y != null) {\r\n            this.y = y;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    protected _visit(context: CanvasRenderingContext2D): void {\r\n        if (!this.visible || this.opacity === 0) {\r\n            return;\r\n        }\r\n\r\n        var sx: number = this.scaleX;\r\n        var sy: number = this.scaleY;\r\n\r\n        context.save();\r\n\r\n        if (this.blendMode != null) {\r\n            context.globalCompositeOperation = BlendModeStrings[this.blendMode];\r\n        }\r\n        if (this.x !== 0 || this.y !== 0) {\r\n            context.translate(this.x, this.y);\r\n        }\r\n        if (this.opacity !== 1) {\r\n            context.globalAlpha = this.opacity;\r\n        }\r\n        if (this.flippedX) {\r\n            sx = -sx;\r\n        }\r\n        if (this.flippedY) {\r\n            sy = -sy;\r\n        }\r\n        if (sx !== 1 || sy !== 1) {\r\n            context.scale(sx, sy);\r\n        }\r\n\r\n        if (this.rotation % 360 !== 0) {\r\n            context.rotate(this._rotationInRadians);\r\n        }\r\n\r\n        if ((this._width !== 0 && this._height !== 0) || this.radius > 0) {\r\n            this.draw(context);\r\n        }\r\n\r\n        this._visitChildren(context);\r\n\r\n        context.restore();\r\n    }\r\n\r\n    protected _visitChildren(context: CanvasRenderingContext2D): void {\r\n        if (!this.children || !this.children.length) {\r\n            return;\r\n        }\r\n        if (this._originPixelX !== 0 || this._originPixelY !== 0) {\r\n            context.translate(-this._originPixelX, -this._originPixelY);\r\n        }\r\n\r\n        for (let i = 0, child: Sprite<{}>; child = this.children[i]; i++) {\r\n            child._visit(context);\r\n        }\r\n    }\r\n\r\n    protected _clip(context: CanvasRenderingContext2D) {\r\n        if (!this.clipOverflow) {\r\n            return;\r\n        }\r\n\r\n        context.beginPath();\r\n        if (this.radius > 0) {\r\n            context.arc(0, 0, this.radius, 0, Math.PI * 2, true);\r\n        }\r\n        else {\r\n            context.rect(-this._originPixelX, -this._originPixelY, this._width, this._height);\r\n        }\r\n        context.closePath();\r\n        context.clip();\r\n    }\r\n\r\n    protected _drawBgColor(context: CanvasRenderingContext2D): void {\r\n        if (this.bgColor == null) {\r\n            return;\r\n        }\r\n\r\n        context.fillStyle = convertColor(this.bgColor);\r\n        context.beginPath();\r\n        if (this.radius > 0) {\r\n            context.arc(0, 0, this.radius, 0, Math.PI * 2, true);\r\n        }\r\n        else {\r\n            context.rect(-this._originPixelX, -this._originPixelY, this._width, this._height);\r\n        }\r\n        context.closePath();\r\n        context.fill();\r\n    }\r\n\r\n    protected _drawBorder(context: CanvasRenderingContext2D): void {\r\n        if (this.borderColor != null) {\r\n            context.lineWidth = this.borderWidth || 1;\r\n            context.strokeStyle = convertColor(this.borderColor || 0x000);\r\n            context.beginPath();\r\n            if (this.radius > 0) {\r\n                context.arc(0, 0, this.radius, 0, Math.PI * 2, true);\r\n            }\r\n            else {\r\n                context.rect(-this._originPixelX, -this._originPixelY, this._width, this._height);\r\n            }\r\n            context.closePath();\r\n            context.stroke();\r\n        }\r\n    }\r\n\r\n    protected draw(context: CanvasRenderingContext2D): void {\r\n        this._clip(context);\r\n        this._drawBgColor(context);\r\n        this._drawBorder(context);\r\n\r\n        let texture = this._texture;\r\n        if (!texture || !texture.ready || texture.width === 0 || texture.height === 0) {\r\n            return;\r\n        }\r\n\r\n        let sx: number = this.sourceX;\r\n        let sy: number = this.sourceY;\r\n        let sw: number = this.sourceWidth == null ? texture.width : this.sourceWidth;\r\n        let sh: number = this.sourceHeight == null ? texture.height : this.sourceHeight;\r\n        let w = this.width;\r\n        let h = this.height;\r\n        let ox = this._originPixelX;\r\n        let oy = this._originPixelY;\r\n        let grid = this.grid;\r\n\r\n        if (!Array.isArray(grid)) {\r\n            context.drawImage(texture.source, sx, sy, sw, sh, -ox, -oy, w, h);\r\n        }\r\n        else {\r\n            let gridSource = (<Texture>this.texture).createGridSource(w, h, sx, sy, sw, sh, grid);\r\n            context.drawImage(gridSource, -ox, -oy, w, h);\r\n        }\r\n    }\r\n\r\n    addChild(target: Sprite<{}>, position?: number): void {\r\n        if (target.parent) {\r\n            throw new Error(\"canvas2d.Sprite.addChild(): Child has been added.\");\r\n        }\r\n\r\n        if (!this.children) {\r\n            this.children = [];\r\n        }\r\n\r\n        var children: Sprite<{}>[] = this.children;\r\n\r\n        if (children.indexOf(target) < 0) {\r\n            if (position > -1 && position < children.length) {\r\n                children.splice(position, 0, target);\r\n            }\r\n            else {\r\n                children.push(target);\r\n            }\r\n            target.parent = this;\r\n            if (this.stage) {\r\n                target.stage = this.stage;\r\n            }\r\n            target._resizeWidth();\r\n            target._resizeHeight();\r\n            target._adjustAlignX();\r\n            target._adjustAlignY();\r\n        }\r\n    }\r\n\r\n    addChildren(...children: Sprite<{}>[]) {\r\n        for (let i = 0, child: Sprite<{}>; child = children[i]; i++) {\r\n            this.addChild(child);\r\n        }\r\n    }\r\n\r\n    removeChild(target: Sprite<{}>): void {\r\n        if (!this.children || !this.children.length) {\r\n            return;\r\n        }\r\n        var index = this.children.indexOf(target);\r\n        if (index > -1) {\r\n            this.children.splice(index, 1);\r\n            target.parent = null;\r\n            target.stage = null;\r\n        }\r\n    }\r\n\r\n    removeChildren(...children: Sprite<{}>[]) {\r\n        for (let i = 0, child: Sprite<{}>; child = children[i]; i++) {\r\n            this.removeChild(child);\r\n        }\r\n    }\r\n\r\n    removeAllChildren(recusive?: boolean): void {\r\n        if (!this.children || !this.children.length) {\r\n            return;\r\n        }\r\n\r\n        while (this.children.length) {\r\n            var sprite: Sprite<{}> = this.children[0];\r\n\r\n            if (recusive) {\r\n                sprite.removeAllChildren(true);\r\n                Action.stop(sprite);\r\n            }\r\n            this.removeChild(sprite);\r\n        }\r\n\r\n        this.children = null;\r\n    }\r\n\r\n    replaceChild(oldChild: Sprite<{}>, ...newChildren: Sprite<{}>[]) {\r\n        if (!this.children || !this.children.length) {\r\n            return;\r\n        }\r\n        let index = this.children.indexOf(oldChild);\r\n        if (index < 0) {\r\n            return;\r\n        }\r\n        this.removeChild(oldChild);\r\n        // this.addChild(newChild, index);\r\n        for (let i = 0, child: Sprite<{}>; child = newChildren[i]; i++) {\r\n            this.addChild(child, index++);\r\n        }\r\n    }\r\n\r\n    contains(target: Sprite<{}>) {\r\n        let children = this.children;\r\n        if (!children || !children.length) {\r\n            return false;\r\n        }\r\n        if (children.indexOf(target) > -1) {\r\n            return true;\r\n        }\r\n        for (let i = 0, child: Sprite<{}>; child = children[i]; i++) {\r\n            if (child.contains(target)) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    release(recusive?: boolean) {\r\n        Action.stop(this);\r\n\r\n        if (recusive && this.children) {\r\n            while (this.children.length) {\r\n                this.children[0].release(recusive);\r\n            }\r\n        }\r\n        else {\r\n            this.removeAllChildren();\r\n        }\r\n\r\n        if (this.parent) {\r\n            this.parent.removeChild(this);\r\n        }\r\n\r\n        // CanvasFrameBuffer.remove(this.id);\r\n        ReleasePool.instance.add(this);\r\n        this.removeAllListeners();\r\n    }\r\n\r\n    update(deltaTime: number): any {\r\n\r\n    }\r\n}\r\n\r\nexport interface ISprite {\r\n    x?: number;\r\n    y?: number;\r\n    width?: number;\r\n    height?: number;\r\n    scaleX?: number;\r\n    scaleY?: number;\r\n    originX?: number;\r\n    originY?: number;\r\n    bgColor?: Color;\r\n    radius?: number;\r\n    borderWidth?: number;\r\n    borderColor?: Color;\r\n    texture?: Texture | string;\r\n    rotation?: number;\r\n    opacity?: number;\r\n    visible?: boolean;\r\n    alignX?: AlignType,\r\n    alignY?: AlignType,\r\n    flippedX?: boolean;\r\n    flippedY?: boolean;\r\n    clipOverflow?: boolean;\r\n    top?: number;\r\n    right?: number;\r\n    bottom?: number;\r\n    left?: number;\r\n    percentWidth?: number;\r\n    percentHeight?: number;\r\n    grid?: number[];\r\n\r\n    /**\r\n     * Position X of the clipping rect on texture\r\n     */\r\n    sourceX?: number;\r\n\r\n    /**\r\n     * Position Y of the clipping rect on texture\r\n     */\r\n    sourceY?: number;\r\n\r\n    /**\r\n     * Width of the clipping rect on texture\r\n     */\r\n    sourceWidth?: number;\r\n\r\n    /**\r\n     * Height of the clipping rect on texture\r\n     */\r\n    sourceHeight?: number;\r\n\r\n    blendMode?: BlendMode;\r\n\r\n    /**\r\n     * Auto resize by the texture\r\n     */\r\n    autoResize?: boolean;\r\n\r\n    touchEnabled?: boolean;\r\n    mouseEnabled?: boolean;\r\n\r\n    /**\r\n     * Sprite would call this method each frame\r\n     * @param  deltaTime  Duration between now and last frame\r\n     */\r\n    update?(deltaTime: number): any;\r\n\r\n    /**\r\n     * Click event handler\r\n     */\r\n    onClick?(e: EventHelper, event: MouseEvent): any;\r\n\r\n    /**\r\n     * Mouse begin event handler\r\n     */\r\n    onMouseBegin?(e: EventHelper, event: MouseEvent): any;\r\n\r\n    /**\r\n     * Mouse moved event handler\r\n     */\r\n    onMouseMoved?(e: EventHelper, event: MouseEvent): any;\r\n\r\n    /**\r\n     * Mouse ended event handler\r\n     */\r\n    onMouseEnded?(e: EventHelper, event: MouseEvent): any;\r\n\r\n    /**\r\n     * Touch begin event handler\r\n     */\r\n    onTouchBegin?(touches: EventHelper[], event: TouchEvent): any;\r\n\r\n    /**\r\n     * Touch moved event handler\r\n     */\r\n    onTouchMoved?(touches: EventHelper[], event: TouchEvent): any;\r\n\r\n    /**\r\n     * Touch ended event hadndler\r\n     */\r\n    onTouchEnded?(touches: EventHelper[], event: TouchEvent): any;\r\n}\r\n","﻿import { Rect } from './Texture';\r\nimport { Stage, Orientation } from './Stage';\r\nimport { Sprite } from './sprite/Sprite';\r\nimport { addArrayItem } from './Util';\r\n\r\nexport type EventHelper = {\r\n    identifier?: number;\r\n    beginX: number;\r\n    beginY: number;\r\n    localX?: number;\r\n    localY?: number;\r\n    stageX?: number;\r\n    stageY?: number;\r\n    _moved?: boolean;\r\n    beginTarget?: Sprite<{}>;\r\n    target?: Sprite<{}>;\r\n    cancelBubble: boolean;\r\n    stopPropagation();\r\n}\r\n\r\nconst onClick = \"onClick\";\r\n\r\nconst onTouchBegin = \"onTouchBegin\";\r\nconst onTouchMoved = \"onTouchMoved\";\r\nconst onTouchEnded = \"onTouchEnded\";\r\n\r\nconst onMouseBegin = \"onMouseBegin\";\r\nconst onMouseMoved = \"onMouseMoved\";\r\nconst onMouseEnded = \"onMouseEnded\";\r\n\r\nexport class UIEvent {\r\n\r\n    public static supportTouch: boolean = \"ontouchend\" in window;\r\n\r\n    public static TOUCH_BEGIN = \"touchbegin\";\r\n    public static TOUCH_MOVED = \"touchmoved\";\r\n    public static TOUCH_ENDED = \"touchended\";\r\n\r\n    public static MOUSE_BEGIN = \"mousebegin\";\r\n    public static MOUSE_MOVED = \"mousemoved\";\r\n    public static MOUSE_ENDED = \"mouseended\";\r\n\r\n    public static CLICK = \"click\";\r\n\r\n    public static ADD_TO_STAGE = \"addtostage\";\r\n    public static REMOVED_FROM_STAGE = \"removedfromstage\";\r\n    public static FRAME = \"frame\";\r\n\r\n    private _registered: boolean;\r\n    private _touchHelperMap: { [index: number]: EventHelper } = {};\r\n    private _mouseBeginHelper: EventHelper;\r\n    private _mouseMovedHelper: EventHelper;\r\n\r\n    private _eventQueue: Event[] = [];\r\n\r\n    stage: Stage;\r\n    element: HTMLElement;\r\n\r\n    constructor(stage: Stage) {\r\n        this.stage = stage;\r\n        this.element = stage.canvas;\r\n    }\r\n\r\n    register() {\r\n        if (this._registered) {\r\n            return;\r\n        }\r\n\r\n        var { stage, element } = this;\r\n\r\n        if (UIEvent.supportTouch) {\r\n            element.addEventListener(\"touchstart\", this._touchBeginHandler, false);\r\n            element.addEventListener(\"touchmove\", this._touchMovedHandler, false);\r\n            element.addEventListener(\"touchend\", this._touchEndedHandler, false);\r\n        }\r\n\r\n        element.addEventListener(\"mousedown\", this._mouseBeginHandler, false);\r\n        element.addEventListener(\"mousemove\", this._mouseMovedHandler, false);\r\n        element.addEventListener(\"mouseup\", this._mouseEndedHandler, false);\r\n\r\n        this._touchHelperMap = {};\r\n        this._registered = true;\r\n    }\r\n\r\n    unregister(): void {\r\n        if (!this._registered) {\r\n            return;\r\n        }\r\n        var element = this.element;\r\n\r\n        element.removeEventListener(\"touchstart\", this._touchBeginHandler, false);\r\n        element.removeEventListener(\"touchmove\", this._touchMovedHandler, false);\r\n        element.removeEventListener(\"touchend\", this._touchEndedHandler, false);\r\n\r\n\r\n        element.removeEventListener(\"mousedown\", this._mouseBeginHandler, false);\r\n        element.removeEventListener(\"mousemove\", this._mouseMovedHandler, false);\r\n        element.removeEventListener(\"mouseup\", this._mouseEndedHandler, false);\r\n\r\n        this._mouseBeginHelper = this._mouseMovedHelper = null;\r\n        this._registered = false;\r\n    }\r\n\r\n    release(): void {\r\n        this.unregister();\r\n        this._mouseBeginHandler = this._mouseMovedHandler = this._mouseEndedHandler = null;\r\n        this._touchBeginHandler = this._touchMovedHandler = this._touchEndedHandler = null;\r\n        this._touchHelperMap = null;\r\n        this.element = this.stage = null;\r\n    }\r\n\r\n    _handleEvent() {\r\n        let queue = this._eventQueue;\r\n        if (queue.length <= 0 || !this.stage.isRunning) {\r\n            return;\r\n        }\r\n\r\n        try {\r\n            for (let i = 0, event: any; event = queue[i]; i++) {\r\n                switch (event.type) {\r\n                    case 'touchstart':\r\n                        this._handleTouchBegin(event);\r\n                        break;\r\n                    case 'touchmove':\r\n                        this._handleTouchMoved(event);\r\n                        break;\r\n                    case 'touchend':\r\n                        this._handleTouchEnded(event);\r\n                        break;\r\n                    case 'mousedown':\r\n                        this._handleMouseBegin(event);\r\n                        break;\r\n                    case 'mousemove':\r\n                        this._handleMouseMoved(event);\r\n                        break;\r\n                    case 'mouseup':\r\n                        this._handleMouseEnded(event);\r\n                        break;\r\n                }\r\n            }\r\n        } catch (e) {\r\n\r\n        }\r\n\r\n        queue.length = 0;\r\n    }\r\n\r\n    private _transformLocation(event) {\r\n        var clientRect = this.element.getBoundingClientRect();\r\n        var scaleX = this.stage.scaleX;\r\n        var scaleY = this.stage.scaleY;\r\n        var isRotated = this.stage.isPortrait && this.stage.orientation !== Orientation.PORTRAIT;\r\n        var x: number;\r\n        var y: number;\r\n\r\n        if (isRotated) {\r\n            if (this.stage.orientation === Orientation.LANDSCAPE2) {\r\n                x = this.stage.width - (event.clientY - clientRect.top) / scaleX;\r\n                y = (event.clientX - clientRect.left) / scaleY;\r\n            }\r\n            else {\r\n                x = (event.clientY - clientRect.top) / scaleX;\r\n                y = this.stage.height - (event.clientX - clientRect.left) / scaleY;\r\n            }\r\n        }\r\n        else {\r\n            x = (event.clientX - clientRect.left) / scaleX;\r\n            y = (event.clientY - clientRect.top) / scaleY;\r\n        }\r\n        return { x, y };\r\n    }\r\n\r\n    private _transformTouches(touches, justGet?: boolean): EventHelper[] {\r\n        var helpers: EventHelper[] = [];\r\n        var clientRect = this.element.getBoundingClientRect();\r\n        var scaleX = this.stage.scaleX;\r\n        var scaleY = this.stage.scaleY;\r\n        var isRotated = this.stage.isPortrait && this.stage.orientation !== Orientation.PORTRAIT;\r\n        var touchHelperMap = this._touchHelperMap;\r\n\r\n        for (var i: number = 0, x: number, y: number, id: number, helper, touch; touch = touches[i]; i++) {\r\n            id = touch.identifier;\r\n            var x: number;\r\n            var y: number;\r\n\r\n            if (isRotated) {\r\n                if (this.stage.orientation === Orientation.LANDSCAPE2) {\r\n                    x = this.stage.width - (touch.clientY - clientRect.top) / scaleX;\r\n                    y = (touch.clientX - clientRect.left) / scaleY;\r\n                }\r\n                else {\r\n                    x = (touch.clientY - clientRect.top) / scaleX;\r\n                    y = this.stage.height - (touch.clientX - clientRect.left) / scaleY;\r\n                }\r\n            }\r\n            else {\r\n                x = (touch.clientX - clientRect.left) / scaleX;\r\n                y = (touch.clientY - clientRect.top) / scaleY;\r\n            }\r\n\r\n            helper = touchHelperMap[id];\r\n\r\n            if (!helper) {\r\n                helper = touchHelperMap[id] = {\r\n                    identifier: id,\r\n                    beginX: x,\r\n                    beginY: y,\r\n                    cancelBubble: false,\r\n                    stopPropagation() {\r\n                        this.cancelBubble = true;\r\n                    }\r\n                };\r\n            }\r\n            else if (!justGet) {\r\n                helper._moved = x - helper.beginX !== 0 || y - helper.beginY !== 0;\r\n            }\r\n            helper.cancelBubble = false;\r\n            helper.stageX = x;\r\n            helper.stageY = y;\r\n\r\n            helpers.push(helper);\r\n        }\r\n\r\n        return helpers;\r\n    }\r\n\r\n    private _touchBeginHandler = (event: TouchEvent) => {\r\n        var stage = this.stage;\r\n\r\n        if (!stage.isRunning || !stage.touchEnabled) {\r\n            return;\r\n        }\r\n\r\n        if (this._eventQueue.indexOf(event) < 0) {\r\n            this._eventQueue.push(event);\r\n        }\r\n        event.preventDefault();\r\n    }\r\n\r\n    private _handleTouchBegin(event: TouchEvent) {\r\n        var stage = this.stage;\r\n        var helpers = this._transformTouches(event.changedTouches);\r\n\r\n        this._dispatchTouch(stage.sprite, 0, 0, helpers.slice(), event, onTouchBegin, UIEvent.TOUCH_BEGIN);\r\n\r\n        for (let i = 0, touch: EventHelper; touch = helpers[i]; i++) {\r\n            touch.beginTarget = touch.target;\r\n        }\r\n\r\n        stage.emit(UIEvent.TOUCH_BEGIN, helpers, event);\r\n    }\r\n\r\n    private _touchMovedHandler = (event: TouchEvent) => {\r\n        var stage = this.stage;\r\n\r\n        if (!stage.isRunning || !stage.touchEnabled) {\r\n            return;\r\n        }\r\n\r\n        if (this._eventQueue.indexOf(event) < 0) {\r\n            this._eventQueue.push(event);\r\n        }\r\n        event.preventDefault();\r\n    }\r\n\r\n    private _handleTouchMoved(event: TouchEvent) {\r\n        var stage = this.stage;\r\n        var helpers = this._transformTouches(event.changedTouches);\r\n\r\n        this._dispatchTouch(stage.sprite, 0, 0, helpers, event, onTouchMoved, UIEvent.TOUCH_MOVED);\r\n\r\n        stage.emit(UIEvent.TOUCH_MOVED, helpers, event);\r\n    }\r\n\r\n    private _touchEndedHandler = (event: TouchEvent) => {\r\n        var stage = this.stage;\r\n\r\n        if (stage.isRunning && stage.touchEnabled) {\r\n\r\n            if (this._eventQueue.indexOf(event) < 0) {\r\n                this._eventQueue.push(event);\r\n            }\r\n        }\r\n    }\r\n\r\n    private _handleTouchEnded(event: TouchEvent) {\r\n        var stage = this.stage;\r\n        var helpers = this._transformTouches(event.changedTouches, true);\r\n\r\n        this._dispatchTouch(stage.sprite, 0, 0, helpers.slice(), event, onTouchEnded, UIEvent.TOUCH_ENDED, true);\r\n\r\n        for (let i = 0, helper: EventHelper; helper = helpers[i]; i++) {\r\n            if (!helper._moved || isMovedSmallRange(helper)) {\r\n                stage.emit(UIEvent.CLICK, helper, event);\r\n            }\r\n            helper.target = null;\r\n            helper.beginTarget = null;\r\n            this._touchHelperMap[helper.identifier] = null;\r\n        }\r\n\r\n        stage.emit(UIEvent.TOUCH_ENDED, helpers, event);\r\n        helpers = null;\r\n    }\r\n\r\n    private _mouseBeginHandler = (event: MouseEvent) => {\r\n        var stage = this.stage;\r\n        if (!stage.isRunning || !stage.mouseEnabled) {\r\n            return;\r\n        }\r\n\r\n        if (this._eventQueue.indexOf(event) < 0) {\r\n            this._eventQueue.push(event);\r\n        }\r\n        event.preventDefault();\r\n    }\r\n\r\n    private _handleMouseBegin(event: MouseEvent) {\r\n        var stage = this.stage;\r\n        var location = this._transformLocation(event);\r\n        var helper: EventHelper = {\r\n            beginX: location.x,\r\n            beginY: location.y,\r\n            stageX: location.x,\r\n            stageY: location.y,\r\n            cancelBubble: false,\r\n            stopPropagation() {\r\n                this.cancelBubble = true;\r\n            }\r\n        };\r\n\r\n        this._dispatchMouse(stage.sprite, 0, 0, helper, event, onMouseBegin, UIEvent.MOUSE_BEGIN);\r\n\r\n        if (helper.target) {\r\n            helper.beginTarget = helper.target;\r\n            this._mouseBeginHelper = helper;\r\n        }\r\n\r\n        stage.emit(UIEvent.MOUSE_BEGIN, helper, event);\r\n    }\r\n\r\n    private _mouseMovedHandler = (event: MouseEvent) => {\r\n        var stage = this.stage;\r\n        if (!stage.isRunning || !stage.mouseEnabled) {\r\n            return;\r\n        }\r\n\r\n        if (this._eventQueue.indexOf(event) < 0) {\r\n            this._eventQueue.push(event);\r\n        }\r\n\r\n        event.preventDefault();\r\n    }\r\n\r\n    private _handleMouseMoved(event: MouseEvent) {\r\n        var stage = this.stage;\r\n        var location = this._transformLocation(event);\r\n        var mouseBeginHelper = this._mouseBeginHelper;\r\n\r\n        if (mouseBeginHelper) {\r\n            mouseBeginHelper.stageX = location.x;\r\n            mouseBeginHelper.stageY = location.y;\r\n            mouseBeginHelper._moved = mouseBeginHelper.beginX - location.x !== 0 || mouseBeginHelper.beginY - location.y !== 0;\r\n            mouseBeginHelper.cancelBubble = false;\r\n            this._dispatchMouse(stage.sprite, 0, 0, mouseBeginHelper, event, onMouseMoved, UIEvent.MOUSE_MOVED);\r\n            stage.emit(UIEvent.MOUSE_MOVED, mouseBeginHelper, event);\r\n        }\r\n        else {\r\n            let mouseMovedHelper = this._mouseMovedHelper = {\r\n                beginX: null,\r\n                beginY: null,\r\n                stageX: location.x,\r\n                stageY: location.y,\r\n                cancelBubble: false,\r\n                stopPropagation() {\r\n                    this.cancelBubble = true;\r\n                }\r\n            };\r\n            this._dispatchMouse(stage.sprite, 0, 0, mouseMovedHelper, event, onMouseMoved, UIEvent.MOUSE_MOVED);\r\n            stage.emit(UIEvent.MOUSE_MOVED, mouseMovedHelper, event);\r\n        }\r\n    }\r\n\r\n    private _mouseEndedHandler = (event: MouseEvent) => {\r\n        var stage = this.stage;\r\n        if (stage.isRunning && stage.mouseEnabled) {\r\n\r\n            if (this._eventQueue.indexOf(event) < 0) {\r\n                this._eventQueue.push(event);\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    private _handleMouseEnded(event: MouseEvent) {\r\n        var stage = this.stage;\r\n        var location = this._transformLocation(event)\r\n        var helper = this._mouseBeginHelper || this._mouseMovedHelper;\r\n        var target;\r\n\r\n        helper.stageX = location.x;\r\n        helper.stageY = location.y;\r\n        target = helper.target;\r\n\r\n        var triggerClick = !helper._moved || isMovedSmallRange(helper);\r\n        this._dispatchMouse(stage.sprite, 0, 0, helper, event, onMouseEnded, UIEvent.MOUSE_ENDED, triggerClick);\r\n        if (!helper._moved || isMovedSmallRange(helper)) {\r\n            stage.emit(UIEvent.CLICK, helper, event);\r\n        }\r\n        stage.emit(UIEvent.MOUSE_ENDED, helper, event);\r\n        helper.target = helper.beginTarget = null;\r\n        this._mouseBeginHelper = this._mouseMovedHelper = null;\r\n    }\r\n\r\n    private _dispatchTouch(\r\n        sprite: Sprite<{}>,\r\n        offsetX: number,\r\n        offsetY: number,\r\n        helpers: EventHelper[],\r\n        event: TouchEvent,\r\n        methodName: string,\r\n        eventName: string,\r\n        needTriggerClick?: boolean\r\n    ): any {\r\n        if (!sprite.touchEnabled || !sprite.visible) {\r\n            return;\r\n        }\r\n\r\n        offsetX += sprite.x - (sprite as any)._originPixelX;\r\n        offsetY += sprite.y - (sprite as any)._originPixelY;\r\n\r\n        if (sprite.clipOverflow) {\r\n            return this._detectTouchOnClipArea(sprite, offsetX, offsetY, helpers, event, methodName, eventName, needTriggerClick);\r\n        }\r\n\r\n        var children = sprite.children;\r\n        var tmpHelpers: EventHelper[] = helpers.slice();\r\n        var triggerreds: EventHelper[] = [];\r\n        var result: EventHelper[];\r\n\r\n        if (children && children.length) {\r\n            let index = children.length;\r\n\r\n            while (--index >= 0) {\r\n                result = this._dispatchTouch(children[index], offsetX, offsetY, tmpHelpers, event, methodName, eventName, needTriggerClick);\r\n                if (result && result.length) {\r\n                    triggerreds.push(...result);\r\n\r\n                    // Remove triggerred touch helper, it won't pass to other child sprites\r\n                    let t = [];\r\n                    for (let j = 0, e: EventHelper; e = tmpHelpers[j]; j++) {\r\n                        if (result.indexOf(e) === -1) {\r\n                            t.push(e);\r\n                        }\r\n                    }\r\n                    tmpHelpers = t;\r\n\r\n                    // All triggerred then exit the loop\r\n                    if (!tmpHelpers.length) {\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        let hits: EventHelper[] = [];\r\n        let count = 0;\r\n\r\n        for (let k = 0, helper: EventHelper; helper = triggerreds[k]; k++) {\r\n            if (!helper.cancelBubble) {\r\n                hits.push(helper);\r\n            }\r\n        }\r\n\r\n        if (tmpHelpers.length) {\r\n            let rect: Rect = {\r\n                x: offsetX,\r\n                y: offsetY,\r\n                width: sprite.width,\r\n                height: sprite.height\r\n            };\r\n            let circle = {\r\n                x: offsetX,\r\n                y: offsetY,\r\n                radius: sprite.radius\r\n            };\r\n\r\n            for (let i = 0, helper: EventHelper; helper = tmpHelpers[i]; i++) {\r\n                if (isRectContainsPoint(rect, helper) || isCircleContainsPoint(circle, helper)) {\r\n                    if (!helper.target) {\r\n                        helper.target = sprite;\r\n                    }\r\n                    helper.localX = helper.stageX - rect.x;\r\n                    helper.localY = helper.stageY - rect.y;\r\n\r\n                    // Add for current sprite hit list\r\n                    hits.push(helper);\r\n                    count++;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (hits.length) {\r\n            // var hasMethod: boolean = hasImplements(sprite, methodName);\r\n            // var hasClickHandler: boolean = hasImplements(sprite, onClick);\r\n\r\n            triggerreds.push(...hits.slice(hits.length - count, count));\r\n\r\n            sprite.emit(eventName, hits, event);\r\n            sprite[methodName] && sprite[methodName](hits, event);\r\n\r\n            // Click event would just trigger by only a touch\r\n            if (needTriggerClick && hits.length === 1 && (!hits[0]._moved || isMovedSmallRange(hits[0]))) {\r\n                sprite.emit(UIEvent.CLICK, hits[0], event);\r\n                sprite[onClick] && sprite[onClick](hits[0], event as any);\r\n                // addArrayItem(triggerreds, hits[0]);\r\n            }\r\n        }\r\n        return triggerreds;\r\n    }\r\n\r\n    private _detectTouchOnClipArea(\r\n        sprite: Sprite<{}>,\r\n        offsetX: number,\r\n        offsetY: number,\r\n        helpers: EventHelper[],\r\n        event: TouchEvent,\r\n        methodName: string,\r\n        eventName: string,\r\n        needTriggerClick?: boolean\r\n    ) {\r\n        var hits: EventHelper[] = [];\r\n        var rect: Rect = {\r\n            x: offsetX,\r\n            y: offsetY,\r\n            width: sprite.width,\r\n            height: sprite.height\r\n        };\r\n        var circle = {\r\n            x: offsetX,\r\n            y: offsetY,\r\n            radius: sprite.radius\r\n        };\r\n        var count = 0;\r\n\r\n        for (let i = 0, helper: EventHelper; helper = helpers[i]; i++) {\r\n            if (isRectContainsPoint(rect, helper) || isCircleContainsPoint(circle, helper)) {\r\n                helper.localX = helper.stageX - offsetX;\r\n                helper.localY = helper.stageY - offsetY;\r\n\r\n                // Add for current sprite hit list\r\n                hits.push(helper);\r\n                count++;\r\n            }\r\n        }\r\n\r\n        if (hits.length) {\r\n            let children = sprite.children;\r\n            let triggerreds = [];\r\n            if (children && children.length) {\r\n                let index = children.length;\r\n                let result;\r\n                let tmpHelpers = hits.slice();\r\n\r\n                while (--index >= 0) {\r\n                    result = this._dispatchTouch(children[index], offsetX, offsetY, tmpHelpers, event, methodName, eventName, needTriggerClick);\r\n                    if (result && result.length) {\r\n                        triggerreds.push(...result);\r\n\r\n                        // Remove triggerred touch helper, it won't pass to other child sprites\r\n                        let t = [];\r\n                        for (let j = 0, e: EventHelper; e = tmpHelpers[j]; j++) {\r\n                            if (result.indexOf(e) === -1) {\r\n                                t.push(e);\r\n                            }\r\n                        }\r\n                        tmpHelpers = t;\r\n\r\n                        // All triggerred then exit the loop\r\n                        if (!tmpHelpers.length) {\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            let bubbleHits: EventHelper[] = [];\r\n            for (let k = 0, helper: EventHelper; helper = hits[k]; k++) {\r\n                if (!helper.cancelBubble) {\r\n                    bubbleHits.push(helper);\r\n                }\r\n            }\r\n\r\n            if (bubbleHits.length) {\r\n                for (let i = 0, e: EventHelper; e = bubbleHits[i]; i++) {\r\n                    if (!e.target) {\r\n                        e.target = sprite;\r\n                    }\r\n                }\r\n                sprite.emit(eventName, bubbleHits, event);\r\n                sprite[methodName] && sprite[methodName](bubbleHits, event);\r\n\r\n                // Click event would just trigger by only a touch\r\n                if (needTriggerClick && bubbleHits.length === 1 && (!bubbleHits[0]._moved || isMovedSmallRange(bubbleHits[0]))) {\r\n                    sprite.emit(UIEvent.CLICK, bubbleHits[0], event);\r\n                    sprite[onClick] && sprite[onClick](bubbleHits[0], event as any);\r\n                }\r\n            }\r\n\r\n            return hits;\r\n        }\r\n    }\r\n\r\n    private _dispatchMouse(\r\n        sprite: Sprite<{}>,\r\n        offsetX: number,\r\n        offsetY: number,\r\n        helper: EventHelper,\r\n        event: MouseEvent,\r\n        methodName: string,\r\n        eventName: string,\r\n        needTriggerClick?: boolean\r\n    ): boolean {\r\n        if (!sprite.mouseEnabled || !sprite.visible) {\r\n            return false;\r\n        }\r\n\r\n        offsetX += sprite.x - (sprite as any)._originPixelX;\r\n        offsetY += sprite.y - (sprite as any)._originPixelY;\r\n\r\n        if (sprite.clipOverflow) {\r\n            return this._detectMouseOnClipArea(sprite, offsetX, offsetY, helper, event, methodName, eventName, needTriggerClick);\r\n        }\r\n\r\n        var children = sprite.children;\r\n        var triggerred = false;\r\n\r\n        if (children && children.length) {\r\n            var index = children.length;\r\n\r\n            while (--index >= 0) {\r\n                triggerred = this._dispatchMouse(children[index], offsetX, offsetY, helper, event, methodName, eventName, needTriggerClick);\r\n                if (triggerred) {\r\n                    break;\r\n                }\r\n            }\r\n\r\n            // if (helper.cancelBubble) {\r\n            //     return true;\r\n            // }\r\n        }\r\n\r\n        var rect: Rect = {\r\n            x: offsetX,\r\n            y: offsetY,\r\n            width: sprite.width,\r\n            height: sprite.height\r\n        };\r\n        var circle = {\r\n            x: offsetX,\r\n            y: offsetY,\r\n            radius: sprite.radius\r\n        };\r\n\r\n        if (triggerred || isRectContainsPoint(rect, helper) || isCircleContainsPoint(circle, helper)) {\r\n            if (!helper.target) {\r\n                helper.target = sprite;\r\n            }\r\n            helper.localX = helper.stageX - rect.x;\r\n            helper.localY = helper.stageY - rect.y;\r\n\r\n            sprite.emit(eventName, helper, event);\r\n            sprite[methodName] && sprite[methodName](helper, event);\r\n            if (needTriggerClick) {\r\n                sprite.emit(UIEvent.CLICK, helper, event);\r\n                sprite[onClick] && sprite[onClick](helper, event);\r\n            }\r\n\r\n            return true;\r\n        }\r\n    }\r\n\r\n    private _detectMouseOnClipArea(\r\n        sprite: Sprite<{}>,\r\n        offsetX: number,\r\n        offsetY: number,\r\n        helper: EventHelper,\r\n        event: MouseEvent,\r\n        methodName: string,\r\n        eventName: string,\r\n        needTriggerClick?: boolean\r\n    ): boolean {\r\n        var rect: Rect = {\r\n            x: offsetX,\r\n            y: offsetY,\r\n            width: sprite.width,\r\n            height: sprite.height\r\n        };\r\n        var circle = {\r\n            x: offsetX,\r\n            y: offsetY,\r\n            radius: sprite.radius\r\n        };\r\n\r\n        if (isRectContainsPoint(rect, helper) || isCircleContainsPoint(circle, helper)) {\r\n            var children = sprite.children;\r\n            var triggerred = false;\r\n\r\n            if (children && children.length) {\r\n                var index = children.length;\r\n\r\n                while (--index >= 0) {\r\n                    triggerred = this._dispatchMouse(children[index], offsetX, offsetY, helper, event, methodName, eventName, needTriggerClick);\r\n                    if (triggerred) {\r\n                        break;\r\n                    }\r\n                }\r\n\r\n                // if (helper.cancelBubble) {\r\n                //     return true;\r\n                // }\r\n            }\r\n\r\n            if (!helper.target) {\r\n                helper.target = sprite;\r\n            }\r\n            helper.localX = helper.stageX - rect.x;\r\n            helper.localY = helper.stageY - rect.y;\r\n\r\n            sprite.emit(eventName, helper, event);\r\n            sprite[methodName] && sprite[methodName](helper, event);\r\n            if (needTriggerClick) {\r\n                sprite.emit(UIEvent.CLICK, helper, event);\r\n                sprite[onClick] && sprite[onClick](helper, event);\r\n            }\r\n\r\n            return true;\r\n        }\r\n    }\r\n}\r\n\r\nfunction isRectContainsPoint(rect: Rect, p: EventHelper) {\r\n    return rect.x <= p.stageX && rect.x + rect.width >= p.stageX &&\r\n        rect.y <= p.stageY && rect.y + rect.height >= p.stageY;\r\n}\r\n\r\nfunction isCircleContainsPoint(circle: { x: number; y: number; radius: number }, p: EventHelper) {\r\n    var dx = p.stageX - circle.x;\r\n    var dy = p.stageY - circle.y;\r\n    return Math.sqrt(dx * dx + dy * dy) <= circle.radius;\r\n}\r\n\r\nfunction isMovedSmallRange(e: EventHelper) {\r\n    if (e.beginX == null && e.beginY == null) {\r\n        return false;\r\n    }\r\n    let x = Math.abs(e.beginX - e.stageX);\r\n    let y = Math.abs(e.beginY - e.stageY);\r\n\r\n    return x <= 5 && y <= 5;\r\n}\r\n\r\nfunction hasImplements(sprite: Sprite<{}>, methodName: string) {\r\n    return sprite[methodName] !== Sprite.prototype[methodName] && typeof sprite[methodName] === 'function';\r\n}","﻿import { UIEvent } from './UIEvent';\r\nimport { Sprite } from './sprite/Sprite';\r\nimport { Action } from './action/Action';\r\nimport { EventEmitter } from './EventEmitter';\r\n// import { CanvasRenderer } from './renderer/canvas/CanvasRenderer';\r\n// import { WebGLRenderer } from './renderer/webgl/WebGLRenderer';\r\n\r\nexport enum ScaleMode {\r\n    SHOW_ALL,\r\n    NO_BORDER,\r\n    FIX_WIDTH,\r\n    FIX_HEIGHT,\r\n    EXACTFIT,\r\n}\r\n\r\nexport enum Orientation {\r\n    LANDSCAPE,\r\n    PORTRAIT,\r\n    LANDSCAPE2,\r\n}\r\n\r\nexport type VisibleRect = {\r\n    left: number;\r\n    right: number;\r\n    top: number;\r\n    bottom: number;\r\n};\r\n\r\nexport class Stage extends EventEmitter {\r\n    // private _renderer: CanvasRenderer | WebGLRenderer;\r\n    // private _renderer: CanvasRenderer;\r\n\r\n    private _elapsedTime: number = 0;\r\n    private _frameCount: number = 0;\r\n    private _computeCostTime: number = 0;\r\n    private _renderCostTime: number = 0;\r\n    private _currFPS: number = 30;\r\n    private _fps: number = 30;\r\n    private _frameRate: number = 1000 / this._fps;\r\n    private _isRunning: boolean;\r\n    private _width: number = 0;\r\n    private _height: number = 0;\r\n    private _sprite: Sprite<{}>;\r\n    private _visibleRect: VisibleRect;\r\n    private _scaleX: number;\r\n    private _scaleY: number;\r\n    private _isPortrait: boolean;\r\n    private _scaleMode: ScaleMode;\r\n    private _autoAdjustCanvasSize: boolean;\r\n    private _orientation: Orientation;\r\n    private _canvas: HTMLCanvasElement;\r\n    private _renderContext: CanvasRenderingContext2D;\r\n    private _bufferCanvas: HTMLCanvasElement;\r\n    private _bufferContext: CanvasRenderingContext2D;\r\n    private _useExternalTimer: boolean;\r\n    private _lastUpdateTime: number;\r\n    private _timerId: number;\r\n    private _uiEvent: UIEvent;\r\n\r\n    touchEnabled: boolean;\r\n    mouseEnabled: boolean;\r\n\r\n    get currFPS() {\r\n        return this._currFPS;\r\n    }\r\n\r\n    get computeCostTime() {\r\n        return this._computeCostTime;\r\n    }\r\n\r\n    get renderCostTime() {\r\n        return this._renderCostTime;\r\n    }\r\n\r\n    get fps(): number {\r\n        return this._fps;\r\n    }\r\n\r\n    set fps(value: number) {\r\n        this._frameRate = 1000 / value;\r\n        this._fps = value;\r\n    }\r\n\r\n    get isRunning(): boolean {\r\n        return this._isRunning;\r\n    }\r\n\r\n    get width(): number {\r\n        return this._width;\r\n    }\r\n\r\n    get height(): number {\r\n        return this._height;\r\n    }\r\n\r\n    get canvas(): HTMLCanvasElement {\r\n        return this._canvas;\r\n    }\r\n\r\n    get context(): CanvasRenderingContext2D {\r\n        return this._renderContext;\r\n    }\r\n\r\n    get sprite(): Sprite<{}> {\r\n        return this._sprite;\r\n    }\r\n\r\n    get visibleRect(): VisibleRect {\r\n        return this._visibleRect;\r\n    }\r\n\r\n    get scaleX(): number {\r\n        return this._scaleX;\r\n    }\r\n\r\n    get scaleY(): number {\r\n        return this._scaleY;\r\n    }\r\n\r\n    get isPortrait() {\r\n        return this._isPortrait;\r\n    }\r\n\r\n    get scaleMode(): ScaleMode {\r\n        return this._scaleMode;\r\n    }\r\n\r\n    set scaleMode(value: ScaleMode) {\r\n        if (value === this._scaleMode) {\r\n            return;\r\n        }\r\n\r\n        this._scaleMode = value;\r\n        this.adjustCanvasSize();\r\n    }\r\n\r\n    get autoAdjustCanvasSize() {\r\n        return this._autoAdjustCanvasSize;\r\n    }\r\n\r\n    set autoAdjustCanvasSize(value: boolean) {\r\n        if (value && !this._autoAdjustCanvasSize) {\r\n            this._autoAdjustCanvasSize = true;\r\n            this.adjustCanvasSize();\r\n            window.addEventListener(\"resize\", this.adjustCanvasSize);\r\n        }\r\n        else if (!value && this._autoAdjustCanvasSize) {\r\n            this._autoAdjustCanvasSize = false;\r\n            window.removeEventListener(\"resize\", this.adjustCanvasSize);\r\n        }\r\n    }\r\n\r\n    get orientation() {\r\n        return this._orientation;\r\n    }\r\n\r\n    set orientation(orientation: Orientation) {\r\n        if (this._orientation != orientation) {\r\n            this._orientation = orientation;\r\n            this.adjustCanvasSize();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param  canvas     Canvas element\r\n     * @param  width      Resolution design width\r\n     * @param  height     Resolution design height\r\n     * @param  scaleMode  Adjust resolution design scale mode \r\n     */\r\n    constructor(\r\n        canvas: HTMLCanvasElement,\r\n        width: number,\r\n        height: number,\r\n        scaleMode: ScaleMode,\r\n        autoAdjustCanvasSize?: boolean,\r\n        orientation = Orientation.PORTRAIT\r\n    ) {\r\n        super();\r\n\r\n        this._sprite = new Sprite({\r\n            // x: width * 0.5,\r\n            // y: height * 0.5,\r\n            originX: 0,\r\n            originY: 0,\r\n            width: width,\r\n            height: height\r\n        });\r\n        this._sprite.stage = this;\r\n        this._scaleMode = scaleMode;\r\n\r\n        this._canvas = canvas;\r\n\r\n        // this._renderer = new WebGLRenderer();\r\n        // this._renderer = new CanvasRenderer();\r\n        // this._renderer.init(canvas);\r\n        // this.setSize(width, height);\r\n\r\n        this._renderContext = canvas.getContext('2d');\r\n        this._bufferCanvas = document.createElement(\"canvas\");\r\n        this._bufferContext = this._bufferCanvas.getContext(\"2d\");\r\n\r\n        this._width = this._bufferCanvas.width = width;\r\n        this._height = this._bufferCanvas.height = height;\r\n\r\n        this._scaleX = this._scaleY = 1;\r\n        this._isPortrait = false;\r\n        this._visibleRect = { left: 0, right: width, top: 0, bottom: height };\r\n        this._orientation = orientation;\r\n        this.autoAdjustCanvasSize = autoAdjustCanvasSize;\r\n        this._uiEvent = new UIEvent(this);\r\n    }\r\n\r\n    setSize(width: number, height: number) {\r\n        this._width = this._bufferCanvas.width = width;\r\n        this._height = this._bufferCanvas.height = height;\r\n\r\n        // this._width = width;\r\n        // this._height = height;\r\n        // this._renderer.setSize(width, height);\r\n\r\n        if (this._autoAdjustCanvasSize) {\r\n            this.adjustCanvasSize();\r\n        }\r\n\r\n        this._sprite.width = width;\r\n        this._sprite.height = height;\r\n    }\r\n\r\n    adjustCanvasSize = () => {\r\n        var canvas = this._canvas;\r\n        var stageWidth = this._width;\r\n        var stageHeight = this._height;\r\n        var scaleMode = this._scaleMode;\r\n        var visibleRect = this._visibleRect;\r\n        var orientation = this._orientation;\r\n\r\n        if (!canvas || !canvas.parentElement) {\r\n            return;\r\n        }\r\n\r\n        var parentElement = canvas.parentElement;\r\n        var style = canvas.style;\r\n        var container = {\r\n            width: parentElement.clientWidth || parentElement.offsetWidth,\r\n            height: parentElement.clientHeight || parentElement.offsetHeight\r\n        };\r\n        var isPortrait = container.width < container.height;\r\n\r\n        if (orientation !== Orientation.PORTRAIT && isPortrait) {\r\n            let tmpHeight = container.height;\r\n            container.height = container.width;\r\n            container.width = tmpHeight;\r\n        }\r\n\r\n        var sx: number = container.width / stageWidth;\r\n        var sy: number = container.height / stageHeight;\r\n        var deltaWidth: number = 0;\r\n        var deltaHeight: number = 0;\r\n        var scaleX: number;\r\n        var scaleY: number;\r\n        var width: number;\r\n        var height: number;\r\n\r\n        switch (scaleMode) {\r\n            case ScaleMode.SHOW_ALL:\r\n                if (sx < sy) {\r\n                    scaleX = scaleY = sx;\r\n                    width = container.width;\r\n                    height = scaleX * stageHeight;\r\n                }\r\n                else {\r\n                    scaleX = scaleY = sy;\r\n                    width = scaleX * stageWidth;\r\n                    height = container.height;\r\n                }\r\n                break;\r\n            case ScaleMode.NO_BORDER:\r\n                scaleX = scaleY = sx > sy ? sx : sy;\r\n                width = stageWidth * scaleX;\r\n                height = stageHeight * scaleX;\r\n                deltaWidth = (stageWidth - container.width / scaleX) * 0.5 | 0;\r\n                deltaHeight = (stageHeight - container.height / scaleX) * 0.5 | 0;\r\n                break;\r\n            case ScaleMode.FIX_WIDTH:\r\n                scaleX = scaleY = sx;\r\n                width = container.width;\r\n                height = container.height * scaleX;\r\n                deltaHeight = (stageHeight - container.height / scaleX) * 0.5 | 0;\r\n                break;\r\n            case ScaleMode.FIX_HEIGHT:\r\n                scaleX = scaleY = sy;\r\n                width = scaleX * container.width;\r\n                height = container.height;\r\n                deltaWidth = (stageWidth - container.width / scaleX) * 0.5 | 0;\r\n                break;\r\n            case ScaleMode.EXACTFIT:\r\n                scaleX = sx;\r\n                scaleY = sy;\r\n                width = container.width;\r\n                height = container.height;\r\n                break;\r\n            default:\r\n                throw new Error(`Unknow stage scale mode \"${scaleMode}\"`);\r\n        }\r\n\r\n        style.width = width + 'px';\r\n        style.height = height + 'px';\r\n        style.position = 'absolute';\r\n\r\n        if (canvas.width != this.width || canvas.height != this.height) {\r\n            canvas.width = this.width;\r\n            canvas.height = this.height;\r\n        }\r\n\r\n        visibleRect.left = deltaWidth;\r\n        visibleRect.right = stageWidth - deltaWidth;\r\n        visibleRect.top = deltaHeight;\r\n        visibleRect.bottom = stageHeight - deltaHeight;\r\n\r\n        if (orientation !== Orientation.PORTRAIT && isPortrait) {\r\n            let rotate = orientation === Orientation.LANDSCAPE2 ? -90 : 90;\r\n            style.top = '50%';\r\n            style.left = '50%';\r\n            style.transform = style.webkitTransform = `translate(-50%, -50%) rotate(${rotate}deg)`;\r\n        }\r\n        else {\r\n            style.transform = '';\r\n            style.top = ((container.height - height) * 0.5) + 'px';\r\n            style.left = ((container.width - width) * 0.5) + 'px';\r\n        }\r\n\r\n        this._scaleX = scaleX;\r\n        this._scaleY = scaleY;\r\n        this._isPortrait = isPortrait;\r\n    }\r\n\r\n    start(useExternalTimer?: boolean): void {\r\n        if (this._isRunning) {\r\n            return;\r\n        }\r\n\r\n        this._useExternalTimer = !!useExternalTimer;\r\n\r\n        if (!useExternalTimer) {\r\n            this._lastUpdateTime = Date.now();\r\n            this._startTimer();\r\n        }\r\n\r\n        this._uiEvent.register();\r\n        this._isRunning = true;\r\n    }\r\n\r\n    step(deltaTime: number): void {\r\n        var startComputeTime = Date.now();\r\n\r\n        this._uiEvent._handleEvent();\r\n\r\n        this._frameCount += 1;\r\n        this._elapsedTime += deltaTime;\r\n        if (this._elapsedTime > 1) {\r\n            this._elapsedTime -= 1;\r\n            this._currFPS = this._frameCount;\r\n            this._frameCount = 0;\r\n        }\r\n\r\n        (this._sprite as any)._update(deltaTime);\r\n        this._computeCostTime = Date.now() - startComputeTime;\r\n    }\r\n\r\n    stop(unregisterUIEvent?: boolean): void {\r\n        if (!this._isRunning) {\r\n            return;\r\n        }\r\n\r\n        if (unregisterUIEvent) {\r\n            this._uiEvent.unregister();\r\n        }\r\n\r\n        this._isRunning = false;\r\n        clearTimeout(this._timerId);\r\n    }\r\n\r\n    render() {\r\n        if (!this._isRunning) {\r\n            return;\r\n        }\r\n\r\n        var startRenderTime = Date.now();\r\n\r\n        // this._renderer.render(this._sprite);\r\n\r\n        var { width, height } = this._canvas;\r\n\r\n        this._bufferContext.clearRect(0, 0, width, height);\r\n        (this._sprite as any)._visit(this._bufferContext);\r\n\r\n        this._renderContext.clearRect(0, 0, width, height);\r\n        this._renderContext.drawImage(this._bufferCanvas, 0, 0, width, height);\r\n\r\n        this._renderCostTime = Date.now() - startRenderTime;\r\n    }\r\n\r\n    /**\r\n     * Add sprite to the stage\r\n     */\r\n    addChild(child: Sprite<{}>, position?: number): void {\r\n        this._sprite.addChild(child, position);\r\n    }\r\n\r\n    /**\r\n     * Remove sprite from the stage\r\n     */\r\n    removeChild(child: Sprite<{}>): void {\r\n        this._sprite.removeChild(child);\r\n    }\r\n\r\n    /**\r\n     * Remove all sprites from the stage\r\n     * @param  recusive  Recusize remove all the children\r\n     */\r\n    removeAllChildren(recusive?: boolean): void {\r\n        this._sprite.removeAllChildren(recusive);\r\n    }\r\n\r\n    release() {\r\n        this.stop(true);\r\n        this._uiEvent.release();\r\n        this._sprite.release(true);\r\n        this._sprite = this._uiEvent = this._canvas =\r\n            // this._renderContext = this._bufferCanvas = this._bufferContext  = \r\n            null;\r\n    }\r\n\r\n    private _startTimer() {\r\n        this._timerId = setTimeout(() => {\r\n            if (this._useExternalTimer) {\r\n                return;\r\n            }\r\n\r\n            var deltaTime: number = this._getDeltaTime();\r\n            Action.schedule(deltaTime);\r\n            this.step(deltaTime);\r\n            this.render();\r\n            this._startTimer();\r\n        }, this._frameRate);\r\n    }\r\n\r\n    private _getDeltaTime() {\r\n        var now = Date.now();\r\n        var delta = now - this._lastUpdateTime;\r\n\r\n        this._lastUpdateTime = now;\r\n        return delta / 1000;\r\n    }\r\n}","import { ITextLabel, FontStyle, FontWeight } from './sprite/TextLabel';\r\nimport { Color } from './Util';\r\n\r\nvar canvas = document.createElement('canvas');\r\nvar ctx = canvas.getContext('2d');\r\n\r\nvar measuredCache: { [key: string]: MeasuredSize } = {};\r\nvar measuredWidthCache: { [key: string]: number } = {};\r\nvar cacheCount = 0;\r\n\r\nfunction getCacheKey(\r\n    textFlow: TextFlow[],\r\n    width: number,\r\n    fontName: string,\r\n    fontSize: number,\r\n    fontWeight: FontWeight,\r\n    fontStyle: FontStyle,\r\n    lineHeight: number,\r\n    wordWrap: boolean,\r\n    autoResizeWidth: boolean,\r\n) {\r\n    return [JSON.stringify(textFlow), width, fontName, fontSize, fontStyle, lineHeight, wordWrap, autoResizeWidth].join(':');\r\n}\r\n\r\nexport type TextFlow = {\r\n    text: string;\r\n    fontStyle?: FontStyle;\r\n    fontName?: string;\r\n    fontWeight?: FontWeight;\r\n    fontColor?: Color;\r\n    fontSize?: number;\r\n    strokeWidth?: number;\r\n    strokeColor?: Color;\r\n}\r\n\r\nexport type TextFragment = TextFlow & {\r\n    width: number;\r\n}\r\n\r\nexport type MeasuredSize = {\r\n    width: number;\r\n    height: number;\r\n    lines: {\r\n        width: number;\r\n        fragments: TextFragment[];\r\n    }[];\r\n};\r\n\r\nexport function measureTextWidth(text: string, fontName, fontSize, fontWeight, fontStyle) {\r\n    let key = [text, fontName, fontSize, fontWeight, fontStyle].join(':');\r\n    if (measuredWidthCache[key] != null) {\r\n        return measuredWidthCache[key];\r\n    }\r\n    ctx.font = fontStyle + ' ' + fontWeight + ' ' + fontSize + 'px ' + fontName;\r\n    let width = ctx.measureText(text).width;\r\n    measuredWidthCache[key] = width;\r\n    return width;\r\n}\r\n\r\nexport function measureText(\r\n    textFlow: TextFlow[],\r\n    width: number,\r\n    fontName: string,\r\n    fontStyle: FontStyle,\r\n    fontWeight: FontWeight,\r\n    fontSize: number,\r\n    lineHeight: number,\r\n    wordWrap: boolean,\r\n    autoResizeWidth: boolean,\r\n): MeasuredSize {\r\n    let cacheKey = getCacheKey(textFlow, width, fontName, fontSize, fontWeight, fontStyle, lineHeight, wordWrap, autoResizeWidth);\r\n    let cached = measuredCache[cacheKey];\r\n    if (cached) {\r\n        return cached;\r\n    }\r\n\r\n    let measuredSize: MeasuredSize = {\r\n        width: width,\r\n        height: 0,\r\n        lines: [],\r\n    };\r\n    let remainWidth = width;\r\n    let lineFragments: TextFragment[] = [];\r\n    let lineWidth = 0;\r\n    let textMetrics: TextMetrics;\r\n\r\n    for (let i = 0, flow: TextFlow; flow = textFlow[i]; i++) {\r\n        let text: string = flow.text;\r\n        let props: TextFlow = {\r\n            fontSize,\r\n            fontStyle,\r\n            fontName,\r\n            fontWeight,\r\n            ...flow,\r\n        }\r\n\r\n        ctx.font = props.fontStyle + ' ' + props.fontWeight + ' ' + props.fontSize + 'px ' + props.fontName;\r\n\r\n        if (!wordWrap) {\r\n            textMetrics = ctx.measureText(text);\r\n            lineFragments.push({\r\n                ...props,\r\n                text: text,\r\n                width: textMetrics.width,\r\n            });\r\n            lineWidth += textMetrics.width;\r\n            continue;\r\n        }\r\n\r\n        let currentPos = 0;\r\n        let lastMeasuredWidth = 0;\r\n        let currentLine = \"\";\r\n        let tryLine: string;\r\n\r\n        while (currentPos < text.length) {\r\n            // console.log(\"remain width\", remainWidth)\r\n            let breaker = nextBreak(text, currentPos, remainWidth, props.fontSize, autoResizeWidth, width);\r\n\r\n            if (breaker.words) {\r\n                tryLine = currentLine + breaker.words;\r\n                textMetrics = ctx.measureText(tryLine);\r\n\r\n                if (autoResizeWidth && !breaker.required) {\r\n                    currentLine = tryLine;\r\n                    lastMeasuredWidth = textMetrics.width;\r\n                }\r\n                else if (!autoResizeWidth && textMetrics.width + lineWidth > width) {\r\n                    if (breaker.words.length > 1 && textMetrics.width + lineWidth - props.fontSize <= width) {\r\n                        // console.log(breaker.words, textMetrics.width, lineWidth, props.fontSize, width, remainWidth);\r\n                        tryLine = currentLine + breaker.words.slice(0, breaker.words.length - 1);\r\n                        breaker.words = breaker.words.slice(breaker.words.length - 1);\r\n                        if (breaker.required) {\r\n                            breaker.pos -= 2;\r\n                        }\r\n                        else {\r\n                            breaker.pos -= 1;\r\n                        }\r\n\r\n                        lineFragments.push({\r\n                            ...props,\r\n                            text: tryLine.trim(),\r\n                            width: textMetrics.width - fontSize,\r\n                        });\r\n                        measuredSize.lines.push({\r\n                            width: lineWidth + textMetrics.width - fontSize,\r\n                            fragments: lineFragments,\r\n                        });\r\n                    }\r\n                    else {\r\n                        // console.log(breaker.words, textMetrics.width, lineWidth, props.fontSize, width, remainWidth, currentLine);\r\n                        lineFragments.push({\r\n                            ...props,\r\n                            text: currentLine.trim(),\r\n                            width: lastMeasuredWidth,\r\n                        });\r\n                        measuredSize.lines.push({\r\n                            fragments: lineFragments,\r\n                            width: lineWidth + lastMeasuredWidth\r\n                        });\r\n                    }\r\n\r\n                    measuredSize.height += lineHeight;\r\n\r\n                    lineFragments = [];\r\n                    lineWidth = 0;\r\n                    currentLine = breaker.words;\r\n                    lastMeasuredWidth = ctx.measureText(currentLine.trim()).width;\r\n                    remainWidth = width - lastMeasuredWidth;\r\n\r\n                    if (breaker.required) {\r\n                        measuredSize.lines.push({\r\n                            width: lastMeasuredWidth,\r\n                            fragments: [{\r\n                                ...props,\r\n                                text: currentLine.trim(),\r\n                                width: lastMeasuredWidth,\r\n                            }],\r\n                        });\r\n                        measuredSize.height += lineHeight;\r\n                        currentLine = \"\";\r\n                        lastMeasuredWidth = 0;\r\n                    }\r\n                }\r\n                else if (breaker.required) {\r\n                    lineFragments.push({\r\n                        ...props,\r\n                        text: tryLine.trim(),\r\n                        width: textMetrics.width,\r\n                    });\r\n                    measuredSize.lines.push({\r\n                        width: lineWidth + textMetrics.width,\r\n                        fragments: lineFragments,\r\n                    });\r\n                    measuredSize.height += lineHeight;\r\n\r\n                    lineFragments = [];\r\n                    lineWidth = 0;\r\n                    remainWidth = width;\r\n                    lastMeasuredWidth = 0;\r\n                    currentLine = \"\";\r\n                }\r\n                else {\r\n                    currentLine = tryLine;\r\n                    lastMeasuredWidth = textMetrics.width;\r\n                    remainWidth = width - lastMeasuredWidth;\r\n                }\r\n            }\r\n            else if (breaker.required) {\r\n                currentLine = currentLine.trim();\r\n                if (currentLine.length) {\r\n                    lineFragments.push({\r\n                        ...props,\r\n                        text: currentLine,\r\n                        width: lastMeasuredWidth,\r\n                    });\r\n                }\r\n                measuredSize.lines.push({\r\n                    width: lineWidth + lastMeasuredWidth,\r\n                    fragments: lineFragments,\r\n                });\r\n                measuredSize.height += lineHeight;\r\n                lineFragments = [];\r\n                lineWidth = 0;\r\n                currentLine = \"\";\r\n                lastMeasuredWidth = 0;\r\n                remainWidth = width;\r\n            }\r\n\r\n            currentPos = breaker.pos;\r\n        }\r\n\r\n        currentLine = currentLine.trim();\r\n        if (currentLine.length) {\r\n            lineFragments.push({\r\n                ...props,\r\n                text: currentLine,\r\n                width: lastMeasuredWidth,\r\n            });\r\n            lineWidth += lastMeasuredWidth;\r\n            remainWidth = width - lineWidth;\r\n        }\r\n    }\r\n\r\n    if (lineFragments.length) {\r\n        measuredSize.lines.push({\r\n            width: lineWidth,\r\n            fragments: lineFragments,\r\n        });\r\n        measuredSize.height += lineHeight;\r\n    }\r\n\r\n    if (autoResizeWidth) {\r\n        let max = 0;\r\n        for (let i = 0, l = measuredSize.lines.length; i < l; i++) {\r\n            let line = measuredSize.lines[i];\r\n            if (line.width > max) {\r\n                max = line.width;\r\n            }\r\n        }\r\n        measuredSize.width = max;\r\n    }\r\n\r\n    if (cacheCount > 200) {\r\n        measuredCache = {};\r\n        cacheCount = 0;\r\n    }\r\n    measuredSize.width = Math.round(measuredSize.width);\r\n    measuredSize.height = Math.round(measuredSize.height);\r\n    measuredCache[cacheKey] = measuredSize;\r\n    cacheCount += 1;\r\n    return measuredSize;\r\n}\r\n\r\ntype Breaker = {\r\n    pos: number;\r\n    words: string;\r\n    required: boolean;\r\n}\r\n\r\nfunction nextBreak(text: string, currPos: number, width: number, fontSize: number, autoResizeWidth: boolean, maxWidth: number): Breaker {\r\n    if (!autoResizeWidth && width < fontSize) {\r\n        return {\r\n            pos: currPos,\r\n            words: \"\",\r\n            required: true,\r\n        };\r\n    }\r\n\r\n    let nextWords: string;\r\n    let required: boolean;\r\n    let breakPos: number;\r\n    let pos: number;\r\n    let num: number;\r\n\r\n    if (autoResizeWidth) {\r\n        num = text.length - currPos;\r\n    }\r\n    else {\r\n        num = Math.min(text.length - currPos, Math.floor(width / fontSize));\r\n        if (num > 0) {\r\n            var nt = text.slice(currPos);\r\n            var arr = nt.match(/[\\u4e00-\\u9fa5]|[\\u3002|\\uff1f|\\uff01|\\uff0c|\\u3001|\\uff1b|\\uff1a|\\u201c|\\u201d|\\u2018|\\u2019|\\uff08|\\uff09|\\u300a|\\u300b|\\u3008|\\u3009|\\u3010|\\u3011|\\u300e|\\u300f|\\u300c|\\u300d|\\ufe43|\\ufe44|\\u3014|\\u3015|\\u2026|\\u2014|\\uff5e|\\ufe4f|\\uffe5]+|[a-zA-Z0-9]+|\\S/g);\r\n            if (arr) {\r\n                var i = 0;\r\n                var n = 0;\r\n                while (i < arr.length) {\r\n                    var w = arr[i];\r\n                    var p = nt.indexOf(w);\r\n                    var l = p + w.length;\r\n                    if (l > num && !(i === 0 && maxWidth / fontSize < l)) {\r\n                        break;\r\n                    }\r\n                    n = l;\r\n                    i++;\r\n                }\r\n                if (n == 0) {\r\n                    return {\r\n                        pos: currPos,\r\n                        words: \"\",\r\n                        required: true,\r\n                    }\r\n                }\r\n                num = n;\r\n            }\r\n        }\r\n    }\r\n\r\n    // num = autoResizeWidth ? text.length - currPos : Math.min(text.length - currPos, Math.floor(width / fontSize));\r\n    nextWords = text.slice(currPos, currPos + num);\r\n    breakPos = nextWords.indexOf('\\n');\r\n    required = breakPos > -1;\r\n\r\n    if (required) {\r\n        nextWords = nextWords.slice(0, breakPos);\r\n        pos = currPos + breakPos + 1;\r\n    }\r\n    else {\r\n        pos = currPos + num;\r\n    }\r\n\r\n    return {\r\n        pos,\r\n        words: nextWords,\r\n        required: required\r\n    };\r\n}\r\n","﻿import { convertColor, Color } from '../Util';\r\nimport { Sprite, ISprite, AlignType } from './Sprite';\r\nimport { measureTextWidth } from '../measureText';\r\nimport {\r\n    TextFlow, TextFragment, measureText\r\n} from '../measureText';\r\nimport { CanvasSource } from '../CanvasSource';\r\n\r\nexport type FontWeight = \"lighter\" | \"normal\" | \"bold\" | \"bolder\";\r\nexport type FontStyle = \"oblique\" | \"normal\" | \"italic\";\r\nexport type TextAlign = \"left\" | \"right\" | \"center\" | \"start\" | \"end\";\r\n\r\nconst DefaultFontSize = 24;\r\n\r\nexport type ITextLabel = ISprite & {\r\n    text?: string;\r\n    fontName?: string;\r\n    textAlign?: TextAlign;\r\n    fontColor?: Color;\r\n    fontSize?: number;\r\n    lineHeight?: number;\r\n    fontStyle?: FontStyle;\r\n    fontWeight?: FontWeight;\r\n    strokeColor?: Color;\r\n    strokeWidth?: number;\r\n    wordWrap?: boolean;\r\n    textFlow?: TextFlow[];\r\n    autoResizeWidth?: boolean;\r\n}\r\n\r\nexport class TextLabel extends Sprite<ITextLabel> {\r\n\r\n    protected _canvasSource: CanvasSource;\r\n    protected _wordWrap: boolean = true;\r\n    protected _fontName: string = 'sans-serif';\r\n    protected _lineHeight: number;\r\n    protected _fontSize: number = DefaultFontSize;\r\n    protected _fontWeight: FontWeight = 'normal';\r\n    protected _fontStyle: FontStyle = 'normal';\r\n    protected _textAlign: TextAlign = 'center';\r\n    protected _strokeColor: Color;\r\n    protected _strokeWidth: number;\r\n    protected _fontColor: Color = 0x000;\r\n    protected _textFlow: Array<TextFlow>;\r\n    protected _autoResizeWidth: boolean = false;\r\n\r\n    protected _textLines: { fragments: TextFragment[]; width: number }[];\r\n    protected _text: string;\r\n    protected _isSetByTextFlow: boolean;\r\n    protected _fragmentsPos: { x: number; y: number }[];\r\n\r\n    constructor(props?: ITextLabel) {\r\n        super();\r\n\r\n        props && this.setProps(props);\r\n    }\r\n\r\n    get fragmentsPos() {\r\n        return this._fragmentsPos;\r\n    }\r\n\r\n    get textLines() {\r\n        return this._textLines;\r\n    }\r\n\r\n    set textAlign(value: TextAlign) {\r\n        if (this._textAlign !== value) {\r\n            this._textAlign = value;\r\n            this._updateFragmentsPos();\r\n        }\r\n    }\r\n\r\n    get textAlign() {\r\n        return this._textAlign;\r\n    }\r\n\r\n    set strokeColor(value: Color) {\r\n        if (this._strokeColor !== value) {\r\n            this._strokeColor = value;\r\n            this._updateCanvasSource();\r\n        }\r\n    }\r\n\r\n    get strokeColor() {\r\n        return this._strokeColor;\r\n    }\r\n\r\n    set strokeWidth(value: number) {\r\n        if (this._strokeWidth != value) {\r\n            this._strokeWidth = value;\r\n            this._updateCanvasSource();\r\n        }\r\n    }\r\n\r\n    get strokeWidth() {\r\n        return this._strokeWidth;\r\n    }\r\n\r\n    set fontColor(value: Color) {\r\n        if (this._fontColor !== value) {\r\n            this._fontColor = value;\r\n            this._updateCanvasSource();\r\n        }\r\n    }\r\n\r\n    get fontColor() {\r\n        return this._fontColor;\r\n    }\r\n\r\n    set autoResizeWidth(value: boolean) {\r\n        if (this._autoResizeWidth != value) {\r\n            this._autoResizeWidth = value;\r\n            this._reMeasureText();\r\n        }\r\n    }\r\n\r\n    get autoResizeWidth() {\r\n        return this._autoResizeWidth;\r\n    }\r\n\r\n    set width(value: number) {\r\n        if (this._width === value) {\r\n            return;\r\n        }\r\n\r\n        this._width = value;\r\n        this._originPixelX = this._width * this._originX;\r\n\r\n        if (this.left != null || this.right != null) {\r\n            this._reCalcX();\r\n        }\r\n        else {\r\n            this._adjustAlignX();\r\n        }\r\n\r\n        if (!this._autoResizeWidth) {\r\n            this._reMeasureText();\r\n        }\r\n\r\n        this._onChildResize();\r\n    }\r\n\r\n    get width() {\r\n        return this._width;\r\n    }\r\n\r\n    set height(value: number) {\r\n        if (this._height === value) {\r\n            return;\r\n        }\r\n\r\n        this._height = value;\r\n        this._originPixelY = this._height * this._originY;\r\n\r\n        if (this.top != null || this.bottom != null) {\r\n            this._reCalcY();\r\n        }\r\n        else {\r\n            this._adjustAlignY();\r\n        }\r\n\r\n        this._onChildResize();\r\n    }\r\n\r\n    get height() {\r\n        return this._height;\r\n    }\r\n\r\n    set fontSize(value: number) {\r\n        if (this._fontSize != value) {\r\n            this._fontSize = value;\r\n            if (this._lineHeight == null) {\r\n                this._lineHeight = value;\r\n            }\r\n            this._reMeasureText();\r\n        }\r\n    }\r\n\r\n    get fontSize() {\r\n        return this._fontSize;\r\n    }\r\n\r\n    set fontName(value: string) {\r\n        if (this._fontName != value) {\r\n            this._fontName = value;\r\n            this._reMeasureText();\r\n        }\r\n    }\r\n\r\n    get fontName() {\r\n        return this._fontName;\r\n    }\r\n\r\n    set fontStyle(value: FontStyle) {\r\n        if (this._fontStyle != value) {\r\n            this._fontStyle = value;\r\n            this._reMeasureText();\r\n        }\r\n    }\r\n\r\n    get fontStyle() {\r\n        return this._fontStyle;\r\n    }\r\n\r\n    set fontWeight(value: FontWeight) {\r\n        if (this._fontWeight != value) {\r\n            this._fontWeight = value;\r\n            this._reMeasureText();\r\n        }\r\n    }\r\n\r\n    get fontWeight() {\r\n        return this._fontWeight;\r\n    }\r\n\r\n    get lineHeight() {\r\n        return this._lineHeight == null ? this._fontSize : this._lineHeight;\r\n    }\r\n\r\n    set lineHeight(value: number) {\r\n        if (this._lineHeight != value) {\r\n            this._lineHeight = value;\r\n            this._reMeasureText();\r\n        }\r\n    }\r\n\r\n    set wordWrap(value: boolean) {\r\n        if (this._wordWrap !== value) {\r\n            this._wordWrap = value;\r\n            this._reMeasureText();\r\n        }\r\n    }\r\n\r\n    get wordWrap() {\r\n        return this._wordWrap;\r\n    }\r\n\r\n    set text(content: string) {\r\n        if (this._text !== content) {\r\n            this._text = content;\r\n            this._isSetByTextFlow = false;\r\n            if (!content) {\r\n                this._textFlow = null;\r\n                this._textLines = null;\r\n            }\r\n            else {\r\n                this._textFlow = [{ text: this._text }];\r\n                this._reMeasureText();\r\n            }\r\n        }\r\n    }\r\n\r\n    get text(): string {\r\n        return this._text;\r\n    }\r\n\r\n    set textFlow(value: Array<TextFlow>) {\r\n        if (this._textFlow != value) {\r\n            this._textFlow = value;\r\n            this._isSetByTextFlow = true;\r\n            if (!value || !value.length) {\r\n                this._textLines = null;\r\n            }\r\n            else {\r\n                this._reMeasureText();\r\n            }\r\n        }\r\n    }\r\n\r\n    get textFlow() {\r\n        return this._textFlow;\r\n    }\r\n\r\n    private _reMeasureText(): void {\r\n        if (!this._textFlow || !this._textFlow.length || (this.width <= 0 && !this._autoResizeWidth)) {\r\n            return;\r\n        }\r\n        if (!this._isSetByTextFlow && !this._wordWrap) {\r\n            let width = measureTextWidth(this._text, this.fontName, this.fontSize, this.fontWeight, this.fontStyle);\r\n            // fragment.fontStyle + ' ' + fragment.fontWeight + ' ' + fragment.fontSize + 'px ' + fragment.fontName;\r\n            this._textLines = [{\r\n                width: width,\r\n                fragments: [{\r\n                    text: this._text,\r\n                    width: width,\r\n                    fontStyle: this.fontStyle,\r\n                    fontSize: this.fontSize,\r\n                    fontWeight: this.fontWeight,\r\n                    fontName: this.fontName,\r\n                }]\r\n            }];\r\n            if (this.autoResizeWidth) {\r\n                this.width = width;\r\n            }\r\n            this.height = this.lineHeight;\r\n        }\r\n        else {\r\n            let result = measureText(\r\n                this._textFlow,\r\n                this.width,\r\n                this.fontName,\r\n                this.fontStyle,\r\n                this.fontWeight,\r\n                this.fontSize,\r\n                this.lineHeight,\r\n                this.wordWrap,\r\n                this._autoResizeWidth\r\n            );\r\n            this._textLines = result.lines;\r\n            if (this._autoResizeWidth) {\r\n                this.width = result.width;\r\n            }\r\n            this.height = result.height;\r\n        }\r\n\r\n        this._updateFragmentsPos();\r\n    }\r\n\r\n    protected _updateFragmentsPos() {\r\n        if (!this._textLines || !this._textLines.length) {\r\n            if (this._canvasSource) {\r\n                this._canvasSource.clear();\r\n            }\r\n            return;\r\n        }\r\n\r\n        if (!this._canvasSource) {\r\n            this._canvasSource = CanvasSource.create();\r\n        }\r\n        let { textAlign, lineHeight, _originPixelX, _originPixelY, width, height, _canvasSource, fontSize } = this;\r\n        let context = _canvasSource.context;\r\n        let y = lineHeight * 1.5;\r\n\r\n        width += fontSize * 2;\r\n        height += lineHeight * 2;\r\n\r\n        _canvasSource.setSize(width, height);\r\n\r\n        context.save();\r\n        context.textAlign = \"left\";\r\n        context.textBaseline = 'middle';\r\n        context.lineJoin = 'round';\r\n\r\n        this._fragmentsPos = [];\r\n        for (let i = 0, l = this._textLines.length; i < l; i++) {\r\n            let line = this._textLines[i];\r\n            let x = 0;\r\n            if (textAlign === \"center\") {\r\n                x += (width - line.width) * 0.5;\r\n            }\r\n            else if (textAlign === \"right\") {\r\n                x += width - line.width;\r\n            }\r\n            else {\r\n                x = fontSize;\r\n            }\r\n\r\n            for (let j = 0, fragment: TextFragment; fragment = line.fragments[j]; j++) {\r\n                this._fragmentsPos.push({ x, y });\r\n\r\n                let fontColor = fragment.fontColor != null ? fragment.fontColor : this.fontColor;\r\n                let strokeColor = \"strokeColor\" in fragment ? fragment.strokeColor : this.strokeColor;\r\n                let strokeWidth = \"strokeWidth\" in fragment ? fragment.strokeWidth : this.strokeWidth;\r\n                context.font = fragment.fontStyle + ' ' + fragment.fontWeight + ' ' + fragment.fontSize + 'px ' + fragment.fontName;\r\n                context.fillStyle = convertColor(fontColor);\r\n\r\n                if (strokeColor != null) {\r\n                    context.strokeStyle = convertColor(strokeColor || 0x000);\r\n                    context.lineWidth = (strokeWidth || 1) * 2;\r\n                    context.strokeText(fragment.text, x, y);\r\n                }\r\n                context.fillText(fragment.text, x, y);\r\n                x += fragment.width;\r\n            }\r\n\r\n            y += lineHeight;\r\n        }\r\n\r\n        context.restore();\r\n    }\r\n\r\n    protected _updateCanvasSource() {\r\n        if (!this._canvasSource) {\r\n            return;\r\n        }\r\n        const { textAlign, lineHeight, _originPixelX, _originPixelY, width, _canvasSource, _fragmentsPos } = this;\r\n\r\n        let index = 0;\r\n        let context = _canvasSource.context;\r\n\r\n        _canvasSource.clear();\r\n\r\n        context.save();\r\n        context.textAlign = \"left\";\r\n        context.textBaseline = 'middle';\r\n        context.lineJoin = 'round';\r\n        for (let i = 0, l = this._textLines.length; i < l; i++) {\r\n            let line = this._textLines[i];\r\n\r\n            for (let j = 0, fragment: TextFragment; fragment = line.fragments[j]; j++) {\r\n                if (fragment.text) {\r\n                    let fontColor = fragment.fontColor != null ? fragment.fontColor : this.fontColor;\r\n                    let strokeColor = \"strokeColor\" in fragment ? fragment.strokeColor : this.strokeColor;\r\n                    let strokeWidth = \"strokeWidth\" in fragment ? fragment.strokeWidth : this.strokeWidth;\r\n\r\n                    let pos = _fragmentsPos[index];\r\n\r\n                    context.font = fragment.fontStyle + ' ' + fragment.fontWeight + ' ' + fragment.fontSize + 'px ' + fragment.fontName;\r\n                    context.fillStyle = convertColor(fontColor);\r\n\r\n                    if (strokeColor != null) {\r\n                        context.strokeStyle = convertColor(strokeColor || 0x000);\r\n                        context.lineWidth = (strokeWidth || 1) * 2;\r\n                        context.strokeText(fragment.text, pos.x, pos.y);\r\n                    }\r\n                    context.fillText(fragment.text, pos.x, pos.y);\r\n                }\r\n                index += 1;\r\n            }\r\n        }\r\n        context.restore();\r\n    }\r\n\r\n    // protected _updateFragmentsPos() {\r\n    //     const { textAlign, lineHeight, _originPixelX, _originPixelY, width } = this;\r\n    //     let y = -_originPixelY + lineHeight * 0.5;\r\n    //     // let y = lineHeight * 0.5;\r\n\r\n    //     this._fragmentsPos = [];\r\n    //     for (let i = 0, l = this._textLines.length; i < l; i++) {\r\n    //         let line = this._textLines[i];\r\n    //         let x: number = -_originPixelX;\r\n    //         // let x = 0;\r\n    //         if (textAlign === \"center\") {\r\n    //             x += (width - line.width) * 0.5;\r\n    //         }\r\n    //         else if (textAlign === \"right\") {\r\n    //             x += width - line.width;\r\n    //         }\r\n\r\n    //         for (let j = 0, fragment: TextFragment; fragment = line.fragments[j]; j++) {\r\n    //             this._fragmentsPos.push({ x, y });\r\n\r\n    //             x += fragment.width;\r\n    //         }\r\n\r\n    //         y += lineHeight;\r\n    //     }\r\n    // }\r\n\r\n    addChild(target: any): void {\r\n        if (Array.isArray(target)) {\r\n            this.text += target.join(\"\");\r\n        }\r\n        else {\r\n            this.text += String(target);\r\n        }\r\n    }\r\n\r\n    addChildren(...children: any[]) {\r\n        this.text += children.join(\"\");\r\n    }\r\n\r\n    protected draw(context: CanvasRenderingContext2D) {\r\n        super.draw(context);\r\n\r\n        let { _textLines, _canvasSource } = this;\r\n        if (!_textLines || !_canvasSource) {\r\n            return;\r\n        }\r\n\r\n        let { _originPixelX, _originPixelY, lineHeight, _fontSize } = this;\r\n        context.drawImage(_canvasSource.canvas, 0, 0, _canvasSource.width, _canvasSource.height, -_originPixelX - _fontSize, -_originPixelY - lineHeight, _canvasSource.width, _canvasSource.height);\r\n    }\r\n\r\n    // protected draw(context: CanvasRenderingContext2D): void {\r\n    //     super.draw(context);\r\n\r\n    //     if (!this._textLines || this._textLines.length === 0) {\r\n    //         return;\r\n    //     }\r\n\r\n    //     // const { textAlign, lineHeight, _originPixelX, _originPixelY, width } = this;\r\n\r\n    //     // let y = -_originPixelY + lineHeight * 0.5;\r\n    //     let index = 0;\r\n\r\n    //     context.save();\r\n    //     context.textAlign = \"left\";\r\n    //     context.textBaseline = 'middle';\r\n    //     context.lineJoin = 'round';\r\n    //     for (let i = 0, l = this._textLines.length; i < l; i++) {\r\n    //         let line = this._textLines[i];\r\n    //         // let x: number = -_originPixelX;\r\n    //         // if (textAlign === \"center\") {\r\n    //         //     x += (width - line.width) * 0.5;\r\n    //         // }\r\n    //         // else if (textAlign === \"right\") {\r\n    //         //     x += width - line.width;\r\n    //         // }\r\n\r\n    //         for (let j = 0, fragment: TextFragment; fragment = line.fragments[j]; j++) {\r\n    //             if (fragment.text) {\r\n    //                 let fontColor = fragment.fontColor != null ? fragment.fontColor : this.fontColor;\r\n    //                 let strokeColor = \"strokeColor\" in fragment ? fragment.strokeColor : this.strokeColor;\r\n    //                 let strokeWidth = \"strokeWidth\" in fragment ? fragment.strokeWidth : this.strokeWidth;\r\n\r\n    //                 let pos = this._fragmentsPos[index];\r\n\r\n    //                 // context.save();\r\n    //                 context.font = fragment.fontStyle + ' ' + fragment.fontWeight + ' ' + fragment.fontSize + 'px ' + fragment.fontName;\r\n    //                 context.fillStyle = convertColor(fontColor);\r\n    //                 // context.textAlign = textAlign;\r\n    //                 // context.textAlign = \"left\";\r\n    //                 // context.textBaseline = 'middle';\r\n    //                 // context.lineJoin = 'round';\r\n\r\n    //                 if (strokeColor != null) {\r\n    //                     context.strokeStyle = convertColor(strokeColor || 0x000);\r\n    //                     context.lineWidth = (strokeWidth || 1) * 2;\r\n    //                     // context.strokeText(fragment.text, x, y);\r\n    //                     context.strokeText(fragment.text, pos.x, pos.y);\r\n    //                 }\r\n    //                 context.fillText(fragment.text, pos.x, pos.y);\r\n    //                 // context.restore();\r\n    //             }\r\n    //             index += 1;\r\n    //             // x += fragment.width;\r\n    //         }\r\n\r\n    //         // y += lineHeight;\r\n    //     }\r\n    //     context.restore();\r\n    // }\r\n\r\n    release(recusive?: boolean) {\r\n        if (this._canvasSource) {\r\n            this._canvasSource.recycle();\r\n            this._canvasSource = null;\r\n        }\r\n        super.release(recusive);\r\n    }\r\n}\r\n","import { Texture } from '../Texture';\r\nimport { Sprite, ISprite } from './Sprite';\r\nimport { TextAlign } from './TextLabel';\r\nimport { CanvasSource } from '../CanvasSource';\r\n\r\nexport type IBMFontLabel = ISprite & {\r\n    textureMap: { [word: string]: Texture | string };\r\n    text?: string;\r\n    textAlign?: TextAlign;\r\n    wordWrap?: boolean;\r\n    wordSpace?: number;\r\n    lineHeight: number;\r\n    fontSize: number;\r\n    autoResizeHeight?: boolean;\r\n}\r\n\r\nexport class BMFontLabel extends Sprite<IBMFontLabel> {\r\n\r\n    protected _lineHeight: number = 5;\r\n    protected _wordSpace: number = 0;\r\n    protected _fontSize: number = 0;\r\n    protected _textAlign: TextAlign = \"center\";\r\n    protected _wordWrap: boolean = true;\r\n    protected _text: string = \"\";\r\n    protected _textureMap: { [word: string]: Texture };\r\n\r\n    protected _bmfontLines: { width: number; fragments: Texture[] }[];\r\n    protected _fragmentsPos: { x: number; y: number; height: number }[];\r\n    protected _autoResizeHeight: boolean = true;\r\n    protected _isAllTexturesReady: boolean;\r\n\r\n    protected _canvasSource: CanvasSource;\r\n\r\n    constructor(props?: IBMFontLabel) {\r\n        super();\r\n        props && this.setProps(props);\r\n    }\r\n\r\n    get fragmentsPos() {\r\n        return this._fragmentsPos;\r\n    }\r\n\r\n    get bmfontLines() {\r\n        return this._bmfontLines;\r\n    }\r\n\r\n    get autoResizeHeight() {\r\n        return this._autoResizeHeight;\r\n    }\r\n\r\n    set autoResizeHeight(value: boolean) {\r\n        if (this._autoResizeHeight !== value) {\r\n            this._autoResizeHeight = value;\r\n            if (value && this._bmfontLines && this._bmfontLines.length) {\r\n                this.height = this._bmfontLines.length * this.lineHeight;\r\n            }\r\n        }\r\n    }\r\n\r\n    set text(text: string) {\r\n        if (text === this._text) {\r\n            return;\r\n        }\r\n        this._text = text;\r\n        this._reMeasureText();\r\n    }\r\n    get text() {\r\n        return this._text;\r\n    }\r\n\r\n    get textureMap() {\r\n        return this._textureMap;\r\n    }\r\n\r\n    set textureMap(textureMap: { [word: string]: Texture | string }) {\r\n        if (textureMap != null) {\r\n            let _textureMap: { [word: string]: Texture } = {};\r\n            let unReadyCount = 0;\r\n            let onReady = () => {\r\n                if (this._isAllTexturesReady = --unReadyCount === 0) {\r\n                    this._reMeasureText();\r\n                }\r\n            };\r\n            for (let word in textureMap) {\r\n                let wordTexture = textureMap[word];\r\n                if (typeof wordTexture === 'string') {\r\n                    unReadyCount += 1;\r\n                    wordTexture = _textureMap[word] = Texture.create(wordTexture);\r\n                    wordTexture.onReady(onReady);\r\n                }\r\n                else {\r\n                    _textureMap[word] = wordTexture;\r\n                }\r\n            }\r\n\r\n            this._textureMap = _textureMap;\r\n            if (this._isAllTexturesReady = unReadyCount === 0) {\r\n                this._reMeasureText();\r\n            }\r\n        }\r\n    }\r\n\r\n    get textAlign() {\r\n        return this._textAlign;\r\n    }\r\n\r\n    set textAlign(value: TextAlign) {\r\n        if (this._textAlign != value) {\r\n            this._textAlign = value;\r\n            this._updateFragmentsPos();\r\n        }\r\n    }\r\n\r\n    get lineHeight() {\r\n        return this._lineHeight;\r\n    }\r\n\r\n    set lineHeight(value: number) {\r\n        if (this._lineHeight != value) {\r\n            this._lineHeight = value;\r\n            if (this._autoResizeHeight && this._bmfontLines && this._bmfontLines.length) {\r\n                this.height = this._bmfontLines.length * value;\r\n            }\r\n            this._updateFragmentsPos();\r\n        }\r\n    }\r\n\r\n    get wordSpace() {\r\n        return this._wordSpace;\r\n    }\r\n\r\n    set wordSpace(value: number) {\r\n        if (this._wordSpace !== value) {\r\n            this._wordSpace = value;\r\n            this._reMeasureText();\r\n        }\r\n    }\r\n\r\n    set wordWrap(value: boolean) {\r\n        if (this._wordWrap !== value) {\r\n            this._wordWrap = value;\r\n            this._reMeasureText();\r\n        }\r\n    }\r\n\r\n    get wordWrap() {\r\n        return this._wordWrap;\r\n    }\r\n\r\n    get fontSize() {\r\n        return this._fontSize;\r\n    }\r\n\r\n    set fontSize(value: number) {\r\n        if (this._fontSize !== value) {\r\n            this._fontSize = value;\r\n            this._reMeasureText();\r\n        }\r\n    }\r\n\r\n    get width() {\r\n        return this._width;\r\n    }\r\n\r\n    set width(value: number) {\r\n        if (this._width === value) {\r\n            return;\r\n        }\r\n\r\n        this._width = value;\r\n        this._originPixelX = this._width * this._originX;\r\n\r\n        if (this.left != null || this.right != null) {\r\n            this._reCalcX();\r\n        }\r\n        else {\r\n            this._adjustAlignX();\r\n        }\r\n\r\n        this._reMeasureText();\r\n    }\r\n\r\n    get height() {\r\n        return this._height;\r\n    }\r\n\r\n    set height(value: number) {\r\n        if (this._height === value) {\r\n            return;\r\n        }\r\n        this._height = value;\r\n        this._originPixelY = this._height * this._originY;\r\n\r\n        if (this.top != null || this.bottom != null) {\r\n            this._reCalcY();\r\n        }\r\n        else {\r\n            this._adjustAlignY();\r\n        }\r\n    }\r\n\r\n    protected _reMeasureText() {\r\n        if (!this.textureMap || !this._text || !this._isAllTexturesReady || this.width <= 0) {\r\n            this._bmfontLines = null;\r\n            if (this._canvasSource) {\r\n                this._canvasSource.clear();\r\n            }\r\n            return;\r\n        }\r\n\r\n        const { _textureMap, text, width, lineHeight, fontSize, wordWrap, wordSpace } = this;\r\n\r\n        let _bmfontLines = this._bmfontLines = [];\r\n\r\n        var words = this._text.split('');\r\n        var currLine = _bmfontLines[0] = { width: 0, fragments: [] };\r\n\r\n        for (let i = 0, l = words.length; i < l; i++) {\r\n            let word = words[i];\r\n            let texture: Texture;\r\n            if (word === \" \") {\r\n                texture = null;\r\n            }\r\n            else {\r\n                texture = _textureMap[word];\r\n                if (!texture) {\r\n                    console.error(`canvas2d.BMFontLabel: Texture of the word \"${word}\" not found.`, this);\r\n                    texture = null;\r\n                }\r\n                if (!texture.ready) {\r\n                    console.error(`canvas2d.BMFontLabel: Texture of the word \"${word}\" is not ready to use.`, this);\r\n                    texture = null;\r\n                }\r\n            }\r\n\r\n            if (!wordWrap || currLine.width + fontSize <= width) {\r\n                currLine.width += fontSize;\r\n                currLine.fragments.push(texture);\r\n\r\n                if (currLine.width + wordSpace >= width) {\r\n                    currLine = _bmfontLines[_bmfontLines.length] = {\r\n                        width: 0, fragments: []\r\n                    };\r\n                }\r\n            }\r\n            else {\r\n                currLine = _bmfontLines[_bmfontLines.length] = {\r\n                    width: fontSize, fragments: [texture]\r\n                };\r\n            }\r\n        }\r\n\r\n        if (this._autoResizeHeight) {\r\n            this.height = _bmfontLines.length * lineHeight;\r\n        }\r\n\r\n        this._updateFragmentsPos();\r\n    }\r\n\r\n    protected _updateFragmentsPos() {\r\n        if (!this._bmfontLines || !this._bmfontLines.length) {\r\n            if (this._canvasSource) {\r\n                this._canvasSource.clear();\r\n            }\r\n            return;\r\n        }\r\n\r\n        if (!this._canvasSource) {\r\n            this._canvasSource = CanvasSource.create();\r\n        }\r\n\r\n        let { _originPixelX, _originPixelY, _textAlign, _bmfontLines, width, height, fontSize, lineHeight, wordSpace, _canvasSource } = this;\r\n        let _fragmentsPos: { x: number; y: number; height: number }[] = this._fragmentsPos = [];\r\n        let context = _canvasSource.context;\r\n        let y = 0;\r\n\r\n        _canvasSource.setSize(width, height);\r\n\r\n        for (let i = 0, l = _bmfontLines.length; i < l; i++) {\r\n            let line = _bmfontLines[i];\r\n            let x: number;\r\n\r\n            if (_textAlign === \"right\") {\r\n                x = width - line.width;\r\n            }\r\n            else if (_textAlign == \"center\") {\r\n                x = (width - line.width) * 0.5;\r\n            }\r\n            else {\r\n                x = 0;\r\n            }\r\n\r\n            for (let j = 0, n = line.fragments.length; j < n; j++) {\r\n                let word = line.fragments[j];\r\n                let ty = y;\r\n                let h = 0;\r\n                if (word) {\r\n                    h = fontSize / word.width * word.height;\r\n                    let p = (lineHeight - h) * 0.5;\r\n                    ty = y + p;\r\n                    context.drawImage(word.source, 0, 0, word.width, word.height, x, ty, fontSize, h);\r\n                }\r\n                _fragmentsPos.push({ x, y: ty, height: h });\r\n                x += fontSize + wordSpace;\r\n            }\r\n\r\n            y += lineHeight;\r\n        }\r\n    }\r\n\r\n    // protected _updateFragmentsPos() {\r\n    //     if (!this._bmfontLines) {\r\n    //         return;\r\n    //     }\r\n\r\n    //     let { _originPixelX, _originPixelY, _textAlign, _bmfontLines, width, fontSize, lineHeight, wordSpace } = this;\r\n    //     let _fragmentsPos: { x: number; y: number; height: number }[] = this._fragmentsPos = [];\r\n    //     let y: number = -_originPixelY;\r\n    //     // let y = 0;\r\n\r\n    //     for (let i = 0, l = _bmfontLines.length; i < l; i++) {\r\n    //         let line = _bmfontLines[i];\r\n    //         let x: number;\r\n\r\n    //         if (_textAlign === \"right\") {\r\n    //             x = width - line.width - _originPixelX;\r\n    //             // x = width - line.width;\r\n    //         }\r\n    //         else if (_textAlign == \"center\") {\r\n    //             x = (width - line.width) * 0.5 - _originPixelX;\r\n    //             // x = (width - line.width) * 0.5;\r\n    //         }\r\n    //         else {\r\n    //             x = -_originPixelX;\r\n    //             // x = 0;\r\n    //         }\r\n\r\n    //         for (let j = 0, n = line.fragments.length; j < n; j++) {\r\n    //             let word = line.fragments[j];\r\n    //             let ty = y;\r\n    //             let h = 0;\r\n    //             if (word) {\r\n    //                 h = fontSize / word.width * word.height;\r\n    //                 let p = (lineHeight - h) * 0.5;\r\n    //                 ty = y + p;\r\n    //             }\r\n    //             _fragmentsPos.push({ x, y: ty, height: h });\r\n    //             x += fontSize + wordSpace;\r\n    //         }\r\n\r\n    //         y += lineHeight;\r\n    //     }\r\n    // }\r\n    protected draw(context: CanvasRenderingContext2D) {\r\n        super.draw(context);\r\n\r\n        let { _bmfontLines, _canvasSource } = this;\r\n        if (!_bmfontLines || !_canvasSource) {\r\n            return;\r\n        }\r\n\r\n        let { _originPixelX, _originPixelY } = this;\r\n        context.drawImage(_canvasSource.canvas, 0, 0, _canvasSource.width, _canvasSource.height, -_originPixelX, -_originPixelY, _canvasSource.width, _canvasSource.height);\r\n    }\r\n\r\n    // protected draw(context: CanvasRenderingContext2D) {\r\n    //     super.draw(context);\r\n\r\n    //     if (!this._bmfontLines) {\r\n    //         return;\r\n    //     }\r\n\r\n    //     const { _originPixelX, _originPixelY, _textAlign, fontSize, lineHeight, wordSpace, width } = this;\r\n\r\n    //     // let y: number = -_originPixelY;\r\n    //     let _fragmentsPos = this._fragmentsPos;\r\n    //     let index = 0;\r\n\r\n    //     for (let i = 0, l = this._bmfontLines.length; i < l; i++) {\r\n    //         let line = this._bmfontLines[i];\r\n    //         // let x: number;\r\n\r\n    //         // if (_textAlign === \"right\") {\r\n    //         //     x = width - line.width - _originPixelX;\r\n    //         // }\r\n    //         // else if (_textAlign == \"center\") {\r\n    //         //     x = (width - line.width) * 0.5 - _originPixelX;\r\n    //         // }\r\n    //         // else {\r\n    //         //     x = -_originPixelX;\r\n    //         // }\r\n\r\n    //         for (let j = 0, n = line.fragments.length; j < n; j++) {\r\n    //             let word = line.fragments[j];\r\n    //             if (word) {\r\n    //                 // let h = fontSize / word.width * word.height;\r\n    //                 // let p = (lineHeight - h) * 0.5;\r\n    //                 // context.drawImage(word.source, 0, 0, word.width, word.height, x, y + p, fontSize, h);\r\n    //                 let pos = _fragmentsPos[index];\r\n    //                 context.drawImage(word.source, 0, 0, word.width, word.height, pos.x, pos.y, fontSize, pos.height);\r\n    //             }\r\n    //             // x += fontSize + wordSpace;\r\n    //             index += 1;\r\n    //         }\r\n\r\n    //         // y += lineHeight;\r\n    //     }\r\n    // }\r\n\r\n    addChild(target: any) {\r\n        this._text = (this._text || \"\") + target;\r\n    }\r\n\r\n    addChildren(...children: any[]) {\r\n        this._text = (this._text || \"\") + children.join(\"\");\r\n    }\r\n\r\n    release(recusive?: boolean) {\r\n        if (this._canvasSource) {\r\n            this._canvasSource.recycle();\r\n            this._canvasSource = null;\r\n        }\r\n        super.release(recusive);\r\n    }\r\n}\r\n","import { Sprite, ISprite } from './sprite/Sprite';\r\nimport { TextLabel, ITextLabel } from './sprite/TextLabel';\r\nimport { BMFontLabel, IBMFontLabel } from './sprite/BMFontLabel';\r\nimport { Stage, ScaleMode, Orientation } from './Stage';\r\nimport { Texture } from './Texture';\r\nimport { Action, ActionQueue, ActionRepeatMode } from './action/Action';\r\n\r\nexport interface Ref<T> {\r\n    ref?(instance: T): any;\r\n}\r\nexport type ActionProps = { actions?: { queue: ActionQueue; repeatMode?: ActionRepeatMode; }[] };\r\n\r\nexport type SpriteProps = ISprite & Ref<Sprite<{}>> & ActionProps;\r\nexport type TextProps = ITextLabel & Ref<TextLabel> & ActionProps;\r\nexport type BMFontProps = IBMFontLabel & Ref<BMFontLabel> & ActionProps;\r\nexport type SpriteClass<T, U> = new (attrs?: T & ISprite) => U;\r\nexport type StageProps = {\r\n    width: number;\r\n    height: number;\r\n    canvas: HTMLCanvasElement;\r\n    scaleMode: ScaleMode;\r\n    autoAdjustCanvasSize?: boolean;\r\n    orientation?: Orientation;\r\n    touchEnabled?: boolean;\r\n    mouseEnabled?: boolean;\r\n    useExternalTimer?: boolean;\r\n} & Ref<Stage>;\r\n\r\nexport function createSprite<T, U>(type: \"sprite\", props: SpriteProps, ...children: any[]): Sprite<{}>;\r\nexport function createSprite<T, U>(type: \"text\", props: TextProps, ...children: any[]): TextLabel;\r\nexport function createSprite<T, U>(type: \"bmfont\", props: BMFontProps, ...children: any[]): BMFontLabel;\r\nexport function createSprite<T, U>(type: \"stage\", props: StageProps, ...children: any[]): Stage;\r\nexport function createSprite<T, U>(type: SpriteClass<T, U>, props: T & SpriteProps, ...children: any[]): U;\r\nexport function createSprite<T, U>(type: any, props: any, ...children: any[]): any {\r\n    props = props || {};\r\n\r\n    let sprite: any;\r\n    let { ref, actions, ...options } = props;\r\n\r\n    if (typeof type === 'function') {\r\n        sprite = new type(options) as Sprite<{}>;\r\n        addChildren(sprite, children);\r\n    }\r\n    else {\r\n        switch (type) {\r\n            case \"sprite\":\r\n                sprite = new Sprite(options);\r\n                addChildren(sprite, children);\r\n                break;\r\n            case \"text\":\r\n                sprite = createLabel<TextLabel>(type, TextLabel, options, children);\r\n                break;\r\n            case \"bmfont\":\r\n                sprite = createLabel<BMFontLabel>(type, BMFontLabel, options, children);\r\n                break;\r\n            case 'stage':\r\n                sprite = createStage(options, children);\r\n                break;\r\n        }\r\n    }\r\n\r\n    if (sprite == null) {\r\n        console.error(`canvas2d.createSprite(): Unknown sprite type`, type);\r\n    }\r\n    else if (actions && actions.length) {\r\n        for (let i = 0, detail: ActionProps['actions'][0]; detail = actions[i]; i++) {\r\n            let instance = new Action(sprite).queue(detail.queue);\r\n            if (detail.repeatMode != null) {\r\n                instance.setRepeatMode(detail.repeatMode);\r\n            }\r\n            instance.start();\r\n        }\r\n    }\r\n\r\n    if (ref) {\r\n        ref.call(undefined, sprite);\r\n    }\r\n\r\n    return sprite;\r\n}\r\n\r\nfunction createLabel<T>(tag: string, ctor: any, props: any, children: any[]): T {\r\n    let label = new ctor(props);\r\n    if (children.length) {\r\n        label.text = children.join('');\r\n    }\r\n    return label;\r\n}\r\n\r\nfunction createStage(props: StageProps, children: Sprite<{}>[]) {\r\n    let { canvas, width, height, scaleMode, autoAdjustCanvasSize, useExternalTimer, touchEnabled, mouseEnabled, orientation } = props;\r\n    let stage = new Stage(canvas, width, height, scaleMode, autoAdjustCanvasSize, orientation);\r\n\r\n    stage.touchEnabled = touchEnabled;\r\n    stage.mouseEnabled = mouseEnabled;\r\n    stage.start(useExternalTimer);\r\n\r\n    if (children.length) {\r\n        for (let i = 0, l = children.length; i < l; i++) {\r\n            let child = children[i];\r\n            if (child) {\r\n                stage.addChild(child);\r\n            }\r\n        }\r\n    }\r\n\r\n    return stage;\r\n}\r\n\r\nfunction addChildren(sprite: Sprite<{}>, children: any[]) {\r\n    if (!children.length) {\r\n        return;\r\n    }\r\n    for (let i = 0, l = children.length; i < l; i++) {\r\n        let child = children[i];\r\n        if (!child) {\r\n            continue;\r\n        }\r\n        if (Array.isArray(child)) {\r\n            addChildren(sprite, child);\r\n        }\r\n        else {\r\n            sprite.addChild(child);\r\n        }\r\n    }\r\n}\r\n","import { EventEmitter } from '../EventEmitter';\r\n\r\nexport class HTMLAudio extends EventEmitter {\r\n\r\n    static enabled: boolean = false;\r\n\r\n    private _audioNode: HTMLAudioElement;\r\n    private _isLoading: boolean;\r\n\r\n    src: string;\r\n    loop: boolean = false;\r\n    muted: boolean = false;\r\n    loaded: boolean = false;\r\n    volume: number = 1;\r\n    playing: boolean = false;\r\n    autoplay: boolean = false;\r\n    duration: number = 0;\r\n    currentTime: number = 0;\r\n\r\n    constructor(src: string) {\r\n        super();\r\n\r\n        this.src = src;\r\n        this._handleEvent = this._handleEvent.bind(this);\r\n    }\r\n\r\n    load() {\r\n        if (this.loaded || this._isLoading) {\r\n            return;\r\n        }\r\n\r\n        let audioNode = this._audioNode = new Audio();\r\n        audioNode.addEventListener('canplaythrough', this._handleEvent, false);\r\n        audioNode.addEventListener('ended', this._handleEvent, false);\r\n        audioNode.addEventListener('error', this._handleEvent, false);\r\n\r\n        audioNode.preload = \"auto\";\r\n        audioNode['autobuffer'] = true;\r\n        audioNode.setAttribute('src', this.src);\r\n        audioNode.volume = this.volume;\r\n        audioNode.load();\r\n    }\r\n\r\n    play() {\r\n        if (!HTMLAudio.enabled) {\r\n            return;\r\n        }\r\n        if (this.playing) {\r\n            this.stop();\r\n        }\r\n\r\n        if (this.loaded) {\r\n            this._play();\r\n        }\r\n        else if (!this._isLoading) {\r\n            this.autoplay = true;\r\n            this.load();\r\n        }\r\n    }\r\n\r\n    pause() {\r\n        if (this.playing) {\r\n            this._audioNode.pause();\r\n            this.currentTime = this._audioNode.currentTime;\r\n            this.playing = false;\r\n        }\r\n    }\r\n\r\n    resume() {\r\n        if (!this.playing && HTMLAudio.enabled) {\r\n            this.play();\r\n        }\r\n    }\r\n\r\n    stop() {\r\n        if (this.playing) {\r\n            this._audioNode.pause();\r\n            this._audioNode.currentTime = this.currentTime = 0;\r\n            this.playing = false;\r\n        }\r\n    }\r\n\r\n    setMute(muted: boolean) {\r\n        if (this.muted != muted) {\r\n            this.muted = muted;\r\n            if (this._audioNode) {\r\n                this._audioNode.volume = muted ? 0 : this.volume;\r\n            }\r\n        }\r\n    }\r\n\r\n    setVolume(volume: number) {\r\n        if (this.volume != volume) {\r\n            this.volume = volume;\r\n            if (this._audioNode) {\r\n                this._audioNode.volume = volume;\r\n            }\r\n        }\r\n    }\r\n\r\n    clone() {\r\n        let cloned = new HTMLAudio(this.src);\r\n\r\n        if (this.loaded) {\r\n            cloned._audioNode = <HTMLAudioElement>this._audioNode.cloneNode(true);\r\n            cloned.loaded = true;\r\n            cloned.duration = this.duration;\r\n        }\r\n\r\n        return cloned;\r\n    }\r\n\r\n    private _handleEvent(e: Event) {\r\n        let type = e.type;\r\n\r\n        switch (type) {\r\n            case 'canplaythrough':\r\n                e.target.removeEventListener('canplaythrough', this._handleEvent, false);\r\n\r\n                this.loaded = true;\r\n                this.duration = this._audioNode.duration;\r\n                this.emit('load');\r\n\r\n                if (this.autoplay) {\r\n                    this.play();\r\n                }\r\n                break;\r\n            case 'ended':\r\n                this.playing = false;\r\n                this.currentTime = 0;\r\n                this.emit('ended');\r\n\r\n                if (this.loop) {\r\n                    this.play();\r\n                }\r\n                break;\r\n        }\r\n    }\r\n\r\n    private _play() {\r\n        if (!this.playing) {\r\n            this._audioNode.volume = this.muted ? 0 : this.volume;\r\n            this._audioNode.play();\r\n            this.playing = true;\r\n        }\r\n    }\r\n}","import { EventEmitter } from '../EventEmitter';\r\n\r\nvar AudioCtx = window['AudioContext'] || window['webkitAudioContext'];\r\nvar context: AudioContext = AudioCtx ? new AudioCtx() : null;\r\n\r\nexport class WebAudio extends EventEmitter {\r\n\r\n    static isSupported: boolean = AudioCtx != null;\r\n\r\n    private static _initialized: boolean = false;\r\n    private static _enabled: boolean = false;\r\n\r\n    static set enabled(enabled: boolean) {\r\n        if (enabled && this.isSupported && !this._initialized) {\r\n            let source = context.createBufferSource();\r\n            source.buffer = context.createBuffer(1, 1, 22050);\r\n            source.connect(context.destination);\r\n            source.start ? source.start(0, 0, 0) : source['noteOn'](0, 0, 0);\r\n            this._initialized = true;\r\n        }\r\n        this._enabled = enabled;\r\n    }\r\n    static get enabled() {\r\n        return this._enabled;\r\n    }\r\n\r\n    private _gainNode: GainNode;\r\n    private _audioNode: AudioBufferSourceNode;\r\n    private _buffer: AudioBuffer;\r\n    private _startTime: number = 0;\r\n    private _isLoading: boolean;\r\n\r\n    src: string;\r\n    loop: boolean = false;\r\n    muted: boolean = false;\r\n    loaded: boolean = false;\r\n    volume: number = 1;\r\n    playing: boolean = false;\r\n    autoplay: boolean = false;\r\n    duration: number = 0;\r\n    currentTime: number = 0;\r\n\r\n    constructor(src: string) {\r\n        super();\r\n\r\n        this.src = src;\r\n        this._handleEvent = this._handleEvent.bind(this);\r\n        this._gainNode = context.createGain ? context.createGain() : context['createGainNode']();\r\n        this._gainNode.connect(context.destination);\r\n    }\r\n\r\n    load() {\r\n        if (this._isLoading || this.loaded) {\r\n            return;\r\n        }\r\n\r\n        let request = new XMLHttpRequest();\r\n        request.onprogress = request.onload = request.onerror = this._handleEvent;\r\n        request.open('GET', this.src, true);\r\n        request.responseType = 'arraybuffer';\r\n        request.send();\r\n\r\n        this._isLoading = true;\r\n    }\r\n\r\n    play() {\r\n        if (!WebAudio.enabled) {\r\n            return;\r\n        }\r\n\r\n        if (this.playing) {\r\n            this.stop();\r\n        }\r\n\r\n        if (this.loaded) {\r\n            this._play();\r\n        }\r\n        else if (!this._buffer) {\r\n            this.autoplay = true;\r\n            this.load();\r\n        }\r\n    }\r\n\r\n    pause() {\r\n        if (this.playing) {\r\n            this._audioNode.stop();\r\n            this.currentTime += context.currentTime - this._startTime;\r\n            this.playing = false;\r\n        }\r\n    }\r\n\r\n    resume() {\r\n        if (!this.playing && WebAudio.enabled) {\r\n            this._play();\r\n        }\r\n    }\r\n\r\n    stop() {\r\n        if (this.playing) {\r\n            this._audioNode.stop(0);\r\n            this._audioNode.disconnect();\r\n            this.currentTime = 0;\r\n            this.playing = false;\r\n        }\r\n    }\r\n\r\n    setMute(muted: boolean) {\r\n        if (this.muted != muted) {\r\n            this.muted = muted;\r\n            this._gainNode.gain.value = muted ? 0 : this.volume;\r\n        }\r\n    }\r\n\r\n    setVolume(volume: number) {\r\n        if (this.volume != volume) {\r\n            this.volume = volume;\r\n            this._gainNode.gain.value = volume;\r\n        }\r\n    }\r\n\r\n    clone() {\r\n        let cloned = new WebAudio(this.src);\r\n\r\n        if (this._isLoading) {\r\n            cloned._isLoading = true;\r\n            let onLoadEnded = () => {\r\n                cloned._onDecodeCompleted(this._buffer);\r\n                this.removeListener(\"load\", onLoadEnded);\r\n            };\r\n            this.on('load', onLoadEnded);\r\n        }\r\n        else if (this.loaded) {\r\n            cloned._onDecodeCompleted(this._buffer);\r\n        }\r\n\r\n        return cloned;\r\n    }\r\n\r\n    private _handleEvent(e: Event) {\r\n        let type = e.type;\r\n        switch (type) {\r\n            case 'load':\r\n                let request: XMLHttpRequest = <any>e.target;\r\n                request.onload = request.onprogress = request.onerror = null;\r\n                context.decodeAudioData(request.response, (buffer) => this._onDecodeCompleted(buffer), () => this.emit('error'));\r\n                request = null;\r\n                break;\r\n            case 'ended':\r\n                if (this.playing) {\r\n                    // play ended, not paused\r\n                    this.currentTime = 0;\r\n                    this.playing = false;\r\n                    this.emit('ended');\r\n                    if (this.loop) {\r\n                        this.play();\r\n                    }\r\n                }\r\n                break;\r\n            default:\r\n                this.emit(type, e);\r\n                break;\r\n        }\r\n    }\r\n\r\n    private _onDecodeCompleted(buffer: AudioBuffer) {\r\n        this._buffer = buffer;\r\n        this._isLoading = false;\r\n        this.loaded = true;\r\n        this.duration = buffer.duration;\r\n        this.emit('load');\r\n        if (this.autoplay) {\r\n            this.play();\r\n        }\r\n    }\r\n\r\n    private _play() {\r\n        this._clearAudioNode();\r\n\r\n        let audioNode = context.createBufferSource();\r\n\r\n        if (!audioNode.start) {\r\n            audioNode.start = audioNode['noteOn'];\r\n            audioNode.stop = audioNode['noteOff'];\r\n        }\r\n\r\n        this._gainNode.gain.value = this.muted ? 0 : this.volume;\r\n\r\n        audioNode.buffer = this._buffer;\r\n        audioNode.onended = this._handleEvent;\r\n        audioNode.connect(this._gainNode);\r\n        audioNode.start(0, this.currentTime);\r\n\r\n        this._audioNode = audioNode;\r\n        this._startTime = context.currentTime;\r\n        this.playing = true;\r\n    }\r\n\r\n    private _clearAudioNode() {\r\n        let audioNode = this._audioNode;\r\n\r\n        if (audioNode) {\r\n            audioNode.onended = null;\r\n            audioNode.disconnect(0);\r\n            this._audioNode = null;\r\n        }\r\n    }\r\n}","﻿import { uid, removeArrayItem } from '../Util';\r\nimport { HTMLAudio } from './HTMLAudio';\r\nimport { WebAudio } from './WebAudio';\r\n\r\nexport class SoundManager {\r\n\r\n    private _ext: \".mp3\" | \".mp4\" | \".wav\" | \".ogg\" = \".mp3\";\r\n    private _enabled: boolean;\r\n    private _pausedAudios: { [id: number]: WebAudio | HTMLAudio };\r\n    private _audioCache: { [index: string]: Array<WebAudio | HTMLAudio> } = {};\r\n    private _supportedType = {\r\n        mp3: false,\r\n        mp4: false,\r\n        wav: false,\r\n        ogg: false\r\n    };\r\n\r\n    get enabled() {\r\n        return this._enabled;\r\n    }\r\n\r\n    set enabled(value: boolean) {\r\n        if (value == this._enabled) {\r\n            return;\r\n        }\r\n        this._setEnabled(value);\r\n    }\r\n\r\n    get supportedType(): { mp3: boolean; mp4: boolean; wav: boolean; ogg: boolean; } {\r\n        return { ...this._supportedType };\r\n    }\r\n\r\n    get ext() {\r\n        return this._ext;\r\n    }\r\n\r\n    set ext(ext) {\r\n        this._ext = ext;\r\n    }\r\n\r\n    constructor() {\r\n        this._detectSupportedType();\r\n    }\r\n\r\n    getAudio(name: string): WebAudio | HTMLAudio;\r\n    getAudio(name: string, returnAll: boolean): Array<WebAudio | HTMLAudio>;\r\n    getAudio(name: string, returnAll?: boolean): any {\r\n        var list = this._audioCache[name];\r\n\r\n        if (!list || !list.length) {\r\n            return returnAll ? [] : null;\r\n        }\r\n\r\n        var i: number = 0;\r\n        var all: Array<WebAudio | HTMLAudio> = [];\r\n        var audio: WebAudio | HTMLAudio;\r\n\r\n        for (; audio = list[i]; i++) {\r\n            if (!audio.playing) {\r\n                if (!returnAll) {\r\n                    return audio;\r\n                }\r\n                all.push(audio);\r\n            }\r\n        }\r\n\r\n        return returnAll ? all : all[0];\r\n    }\r\n\r\n    load(baseUri: string, name: string, onComplete: (loaded: boolean) => any, channels = 1, version?: string) {\r\n        var src = baseUri + name + this._ext + (version == null ? '' : `?v=${version}`);\r\n        var audio = WebAudio.isSupported ? new WebAudio(src) : new HTMLAudio(src);\r\n\r\n        audio.on('load', () => {\r\n            if (onComplete) {\r\n                onComplete(true);\r\n            }\r\n\r\n            var cloned;\r\n            while (--channels > 0) {\r\n                cloned = audio.clone();\r\n                this._audioCache[name].push(cloned);\r\n            }\r\n        });\r\n        audio.on('error', (e: ErrorEvent) => {\r\n            console.warn(\"canvas2d.Sound.load() Error: \" + src + \" could not be loaded.\");\r\n            removeArrayItem(this._audioCache[name], audio);\r\n            if (onComplete) {\r\n                onComplete(false);\r\n            }\r\n        });\r\n\r\n        if (!this._audioCache[name]) {\r\n            this._audioCache[name] = [];\r\n        }\r\n        this._audioCache[name].push(audio);\r\n\r\n        audio.load();\r\n    }\r\n\r\n    /**\r\n     * Load multiple sound resources\r\n     */\r\n    loadList(baseUri: string, resources: { name: string; channels?: number; }[], onAllCompleted?: (success: string[], errors: string[]) => any, onProgress?: (percent: number) => any, version?: string) {\r\n        let totalCount = resources.length;\r\n        let endedCount = 0;\r\n        let errors: string[] = [];\r\n        let success: string[] = [];\r\n\r\n        let onCompleted = (name: string, loaded: boolean) => {\r\n            ++endedCount;\r\n\r\n            if (loaded) {\r\n                success.push(name);\r\n            }\r\n            else {\r\n                errors.push(name);\r\n            }\r\n\r\n            if (onProgress) {\r\n                onProgress(endedCount / totalCount);\r\n            }\r\n            if (endedCount === totalCount && onAllCompleted) {\r\n                onAllCompleted(success, errors);\r\n            }\r\n        }\r\n\r\n        resources.forEach(res => {\r\n            this.load(baseUri, res.name, (loaded) => {\r\n                onCompleted(res.name, loaded);\r\n            }, res.channels, version);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Get all audioes by name\r\n     */\r\n    getAllAudioes(name: string): Array<WebAudio | HTMLAudio> {\r\n        return this._audioCache[name] && this._audioCache[name].slice();\r\n    }\r\n\r\n    /**\r\n     * Play sound by name\r\n     */\r\n    play(name: string, loop: boolean = false): WebAudio | HTMLAudio {\r\n        var audio = this._enabled && this.getAudio(name);\r\n\r\n        if (audio) {\r\n            audio.loop = loop;\r\n            audio.play();\r\n        }\r\n        return audio;\r\n    }\r\n\r\n    /**\r\n     * Pause sound by name\r\n     */\r\n    pause(name: string): void {\r\n        let list = this.getAllAudioes(name);\r\n\r\n        if (list) {\r\n            for (let i = 0, audio: WebAudio | HTMLAudio; audio = list[i]; i++) {\r\n                audio.pause();\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Stop sound by name\r\n     */\r\n    stop(name: string): void {\r\n        let list = this._audioCache[name];\r\n\r\n        if (list) {\r\n            for (let i = 0, audio: WebAudio | HTMLAudio; audio = list[i]; i++) {\r\n                audio.stop();\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Resume audio by name\r\n     */\r\n    resume(name: string): void {\r\n        let list = this._audioCache[name];\r\n        if (list) {\r\n            for (let i = 0, audio: WebAudio | HTMLAudio; audio = list[i]; i++) {\r\n                if (!audio.playing && audio.currentTime > 0) {\r\n                    audio.resume();\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    private _setEnabled(value: boolean) {\r\n        if (value) {\r\n            WebAudio.enabled = true;\r\n            HTMLAudio.enabled = true;\r\n\r\n            if (this._pausedAudios) {\r\n                for (let id in this._pausedAudios) {\r\n                    this._pausedAudios[id].resume();\r\n                }\r\n                this._pausedAudios = null;\r\n            }\r\n        }\r\n        else {\r\n            WebAudio.enabled = false;\r\n            HTMLAudio.enabled = false;\r\n\r\n            this._pausedAudios = {};\r\n            for (let name in this._audioCache) {\r\n                let list = this._audioCache[name];\r\n                for (let i = 0, audio: HTMLAudio | WebAudio; audio = list[i]; i++) {\r\n                    if (audio.playing) {\r\n                        audio.pause();\r\n                        this._pausedAudios[uid(audio)] = audio;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        this._enabled = value;\r\n    }\r\n\r\n    private _detectSupportedType() {\r\n        var aud = new Audio();\r\n        var reg = /maybe|probably/i;\r\n        var mts = {\r\n            mp3: 'audio/mpeg',\r\n            mp4: 'audio/mp4; codecs=\"mp4a.40.5\"',\r\n            wav: 'audio/x-wav',\r\n            ogg: 'audio/ogg; codecs=\"vorbis\"'\r\n        };\r\n\r\n        for (var name in mts) {\r\n            this._supportedType[name] = reg.test(aud.canPlayType(mts[name]));\r\n        }\r\n\r\n        aud = null;\r\n    }\r\n}\r\n\r\nexport const Sound = new SoundManager();\r\n"],"names":["tslib_1.__extends","ActionType","ActionRepeatMode","AlignType","BlendMode","Orientation","ScaleMode","ctx","getCacheKey"],"mappings":"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"}